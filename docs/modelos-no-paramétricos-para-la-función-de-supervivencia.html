<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia | Modelos de Supervivencia</title>
<meta name="author" content="Sofía Villers Gómez">
<meta name="author" content="Carlos Fernando Vásquez Guerra">
<meta name="author" content="Luis Angel Ramirez Teodoro">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.4/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Modelos de Supervivencia</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Todo es cuestion de tiempo</li>
<li><a class="" href="motivaci%C3%B3n.html">Motivación</a></li>
<li><a class="" href="an%C3%A1lisis-de-supervivencia.html">Análisis de Supervivencia</a></li>
<li><a class="" href="datos-censurados.html"><span class="header-section-number">1</span> Datos Censurados</a></li>
<li><a class="" href="datos-truncados.html"><span class="header-section-number">2</span> Datos Truncados</a></li>
<li class="book-part">Estudio paramétrico</li>
<li><a class="" href="funciones-para-el-an%C3%A1lisis-de-supervivencia.html"><span class="header-section-number">3</span> Funciones para el Análisis de Supervivencia</a></li>
<li><a class="" href="par-poblacionales.html"><span class="header-section-number">4</span> Parámetros Poblacionales</a></li>
<li><a class="" href="modelos-param%C3%A9tricos.html"><span class="header-section-number">5</span> Modelos Paramétricos</a></li>
<li><a class="" href="la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento.html"><span class="header-section-number">6</span> La Función de Verosimilitud con Censura y Truncamiento</a></li>
<li class="book-part">Estudio no paramétrico</li>
<li><a class="active" href="modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia.html"><span class="header-section-number">7</span> Modelos No Paramétricos para la Función de Supervivencia</a></li>
<li><a class="" href="algunas-estimaciones-sobre-modelos-no-param%C3%A9tricos.html"><span class="header-section-number">8</span> Algunas Estimaciones sobre Modelos No Paramétricos</a></li>
<li><a class="" href="pruebas-de-hip%C3%B3tesis.html"><span class="header-section-number">9</span> Pruebas de Hipótesis</a></li>
<li class="book-part">Lleno de riesgos</li>
<li><a class="" href="modelo-de-riesgos-proporcionales.html"><span class="header-section-number">10</span> Modelo de Riesgos Proporcionales</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modelos-no-paramétricos-para-la-función-de-supervivencia" class="section level1" number="7">
<h1>
<span class="header-section-number">Capítulo 7</span> Modelos No Paramétricos para la Función de Supervivencia<a class="anchor" aria-label="anchor" href="#modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia"><i class="fas fa-link"></i></a>
</h1>
<p>Los métodos estadísticos más utilizados en el análisis de supervivencia son los <em>No Paramétricos</em>. Debido a que sólo cuando se conoce la distribución que siguen los tiempos de falla, las estimaciones con métodos paramétricos será adecuada. La eficiencia de los métodos no paramétricos radica en que los datos no sigan una distribución teórica.</p>
<p>Puesto que nuestro interés es estimar <span class="math inline">\(S(t)\)</span>, en los métodos no paramétricos las curvas de supervivencia, por lo general, se producen usando uno de dos métodos: el <strong>análisis actuarial</strong> o el <strong>método límite-producto de Kaplan-Meier</strong>.</p>
<p>Es importante mencionar que, cuando <strong>no</strong> hay datos censurados podemos estimar <span class="math inline">\(S(t)\)</span> de manera sencilla mediante la función empírica:</p>
<p><span class="math display">\[
\hat S(t) = \hat{\mathbb{P}}(T&gt;t) = \frac{ \# t_{i}&gt;t}{n}
\]</span></p>
<p>donde la muestra aleatoria es: <span class="math inline">\(t_{(1)}\leq t_{(2)}\leq...\leq t_{(n)}\)</span>.</p>
<p>En este caso, la función será escalonada con decrementos <span class="math inline">\(\frac{1}{n}\)</span> si todas las observaciones son distintas, o con decrementos <span class="math inline">\(\frac{d}{n}\)</span> si hay <span class="math inline">\(d\)</span> tiempos de falla iguales a <span class="math inline">\(t\)</span>.</p>
<p>Los métodos que se presentan a continuación incluyen la percepción del censuramiento en los datos; quizá el alumno está familiarizado con alguno de ellos, pues se estudian en cursos previos.</p>
<div id="método-actuarial-tabla-de-vida" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Método Actuarial (Tabla de Vida)<a class="anchor" aria-label="anchor" href="#m%C3%A9todo-actuarial-tabla-de-vida"><i class="fas fa-link"></i></a>
</h2>
<p>El análisis actuarial divide el tiempo en intervalos y calcula la supervivencia en cada intervalo. La longitud del intervalo depende de la frecuencia con que ocurre el suceso de interés.</p>
<p>Se asume que:</p>
<ul>
<li>Todos los abandonos durante un intervalo dado ocurren aleatoriamente durante dicho intervalo.</li>
<li>Las personas que se retiran del estudio tienen un destino parecido a las que se quedan.</li>
<li>El periodo de tiempo durante el cual una persona entra en el estudio no tiene efecto en la respuesta.</li>
</ul>
<p>Dividimos el eje del tiempo en <span class="math inline">\(k+1\)</span> intervalos <span class="math inline">\(l_{j}=(a_{j-1},a_{j}]\)</span>. Entonces para cada elemento de una muestra aleatoria de tamaño <span class="math inline">\(n\)</span>, se observa un tiempo de fallo <span class="math inline">\(T\)</span> o un valor censurado por la derecha <span class="math inline">\(C\)</span>.</p>
<p>Definimos:</p>
<ul>
<li>
<span class="math inline">\(n_{j}\)</span>: número de individuos en riesgo (vivos o no censurados) al tiempo <span class="math inline">\(a_{j-1}\)</span>.</li>
<li>
<span class="math inline">\(d_{j}\)</span>: número de fallas en el intervalo <span class="math inline">\(l_{j}\)</span>.</li>
<li>
<span class="math inline">\(c_{j}\)</span>: número de individuos que se censuran en el intervalo <span class="math inline">\(l_{j}\)</span>.</li>
</ul>
<p>El número de individuos sin falla al inicio de <span class="math inline">\(l_{j}\)</span> es <span class="math inline">\(n_{j}\)</span>.</p>
<p>Suponga que la función de supervivencia para los tiempos de falla es <span class="math inline">\(S(t) = \mathbb{P}(T&gt;t)\)</span>. Entonces:</p>
<p><span class="math display">\[
S(a_{j}) = \mathbb{P}(T&gt;a_{j}) = \mathbb{P}(T&gt;a_{0})\mathbb{P}(T&gt;a_{1}|T&gt;a_{0})...\mathbb{P}(T&gt;a_{j}|T&gt;a_{j-1})
\]</span></p>
<p>Sea:</p>
<ul>
<li><span class="math inline">\(S_{j} = S(a_{j})\)</span></li>
<li>
<span class="math inline">\(p_{j} = \mathbb{P}(T&gt;a_{j}|T&gt;a_{j-1}) =\frac{S_{j}}{S_{j-1}}\)</span> (Sobrevivencia hasta <span class="math inline">\(a_{j}\)</span> después de haber sobrevivido hasta <span class="math inline">\(a_{j-1}\)</span>)</li>
<li>
<span class="math inline">\(q_{j} = 1-p_{j} = \mathbb{P}(T\leq a_{j}|T&gt;a_{j-1}) = \frac{S_{j-1}-S_{j}}{S_{j-1}}\)</span> (No sobrevivir hasta <span class="math inline">\(a_{j}\)</span> después de haber sobrevivido hasta <span class="math inline">\(a_{j-1}\)</span>)</li>
</ul>
<p>Donde <span class="math inline">\(S_{0} = 1\)</span>, <span class="math inline">\(S_{k+1} = 0\)</span>, <span class="math inline">\(q_{k+1} = 1\)</span>. Por lo tanto:</p>
<p><span class="math display">\[
S_{j} = p_{1}p_{2}...p_{j}
\]</span></p>
<p>El objetivo es estimar <span class="math inline">\(S_j\)</span> con base en la estimación de <span class="math inline">\(p_j=1-q_j\)</span>.</p>
<p>Si en <span class="math inline">\(l_{j}\)</span> <strong>no</strong> hay observaciones censuradas, entonces estimamos <span class="math inline">\(S_j\)</span> por medio de:</p>
<p><span class="math display">\[
\hat{q_{j}} = \frac{d_{j}}{n_{j}}
\]</span></p>
<p>Por otro lado, si en <span class="math inline">\(l_{j}\)</span> <strong>hay</strong> observaciones censuradas, y suponiendo que las censuras se distribuyen uniformemente, entonces <span class="math inline">\(S_j\)</span> se puede obtener mediante:</p>
<p><span class="math display">\[
\hat{q_{j}} = \frac{d_{j}}{n_{j}-\frac{c_{j}}{2}}
\]</span></p>
<p>De modo que, para este caso, se tiene:</p>
<p><span class="math display">\[
\hat S_j=\prod_{i=1}^{j}\left(1-\frac{d_{i}}{n_{i}-\frac{c_{i}}{2}}\right)
\]</span></p>
<div id="ejemplo-9" class="section level4 unnumbered">
<h4>Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo-9"><i class="fas fa-link"></i></a>
</h4>
<p>El siguiente ejemplo es tomado del libro <span class="citation">(Collett <a href="modelo-de-riesgos-proporcionales.html#ref-collett2015modelling" role="doc-biblioref">2015</a>)</span>, ejemplo 1.3 :</p>
<p>Supervivencia de pacientes con myeloma múltiple.</p>
<p>Myeloma múltiple es una enfermedad caracterizada por la acumulación múltiple de células plasmáticas anormales, un tipo de células blancas de la sangre, en la médula ósea. La proliferación de las células plasmáticas anormales dentro de los huesos causa dolor y la destrucción del tejido óseo. El objetivo de un estudio realizado en el Centro Médico de la Universidad del Oeste de Virginia, USA, fue examinar la asociación entre los valores de ciertas variables explicativas(covariables) y el tiempo de supervivencia de los pacientes. En el estudio, el tiempo de supervivencia fue medido en meses, desde el diagnóstico hasta la muerte por myeloma múltiple.</p>
<p>La siguiente tabla muestra un <strong>fragmento</strong> de los resultados obtenidos en el estudio. En ésta se relaciona a un total de 48 pacientes, todos ellos estaban entre los 50 y 80 años. Algunos de estos pacientes no habían muerto durante el tiempo que el estudio fue completado, por lo que estos individuos contribuyeron con tiempos censurados por la derecha. La codificación del estatus de supervivencia de un individuo en la tabla es codificado con un <span class="math inline">\(0\)</span> si la observación es censurada y <span class="math inline">\(1\)</span> si fue muerte por myeloma.</p>
<div class="inline-table"><table class="table table-striped table-responsive table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
Patient
number
</th>
<th style="text-align:center;">
Survival
time
</th>
<th style="text-align:center;">
Status
</th>
<th style="text-align:center;">
Age
</th>
<th style="text-align:center;">
Sex
</th>
<th style="text-align:center;">
Bun
</th>
<th style="text-align:center;">
Ca
</th>
<th style="text-align:center;">
Hb
</th>
<th style="text-align:center;">
Pcells
</th>
<th style="text-align:center;">
Protein
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
14.6
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
12.0
</td>
<td style="text-align:center;">
100
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
53
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
11.4
</td>
<td style="text-align:center;">
33
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
40
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
69
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
10.2
</td>
<td style="text-align:center;">
30
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
65
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
13.2
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
57
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
9.9
</td>
<td style="text-align:center;">
45
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
52
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
21
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
12.8
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
41
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
14.0
</td>
<td style="text-align:center;">
70
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
70
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
37
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
7.5
</td>
<td style="text-align:center;">
47
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
70
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
40
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
10.6
</td>
<td style="text-align:center;">
27
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
68
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
39
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
11.2
</td>
<td style="text-align:center;">
41
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
50
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
172
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
10.1
</td>
<td style="text-align:center;">
46
</td>
<td style="text-align:center;">
1
</td>
</tr>
<tr>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
65
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
59
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
28
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
6.6
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
9.7
</td>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
25
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
8.8
</td>
<td style="text-align:center;">
23
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
51
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
9.6
</td>
<td style="text-align:center;">
80
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
17
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
55
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
13.0
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
67
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
26
</td>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
10.4
</td>
<td style="text-align:center;">
49
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
19
</td>
<td style="text-align:center;">
76
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
60
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
14.0
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
0
</td>
</tr>
<tr>
<td style="text-align:center;">
20
</td>
<td style="text-align:center;">
56
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
66
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
18
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
12.5
</td>
<td style="text-align:center;">
90
</td>
<td style="text-align:center;">
0
</td>
</tr>
</tbody>
</table></div>
<p>Ahora bien, se busca estimar <span class="math inline">\(S(t)\)</span> mediante la construcción de la tabla de vida. La información registrada en otras variables explicativas será ignorada.</p>
<p>Se consideran los intervalos de tiempo, para cada uno se calcula el número de pacientes que fallecieron <span class="math inline">\(d_{j}\)</span>,el número de datos censurados <span class="math inline">\(c_{j}\)</span>, el número en riesgo de muerte al inicio de cada uno de estos intervalos <span class="math inline">\(n_{j}\)</span>, y el número ajustado en riesgo <span class="math inline">\(n_{j}^{*}=n_{j}-\frac{c_{j}}{2}\)</span> (dado que hay datos censurados). Finalmente, la probabilidad de supervivencia en cada intervalo es estimada(multiplicando cada <span class="math inline">\(p_j\)</span>).</p>
<p>Los cálculos son presentados a continuación:</p>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
Interval
</th>
<th style="text-align:center;">
Time period
</th>
<th style="text-align:center;">
<span class="math inline">\(d_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(c_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(n_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(n_j^{*}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(p_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(S(t)\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0-
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
48
</td>
<td style="text-align:center;">
46.0
</td>
<td style="text-align:center;">
0.6521739
</td>
<td style="text-align:center;">
0.6521739
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
12-
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
28
</td>
<td style="text-align:center;">
26.0
</td>
<td style="text-align:center;">
0.6153846
</td>
<td style="text-align:center;">
0.4013378
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
24-
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
14.0
</td>
<td style="text-align:center;">
0.9285714
</td>
<td style="text-align:center;">
0.3726708
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
36-
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
12.5
</td>
<td style="text-align:center;">
0.7600000
</td>
<td style="text-align:center;">
0.2832298
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
48-
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
8.0
</td>
<td style="text-align:center;">
0.7500000
</td>
<td style="text-align:center;">
0.2124224
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
60-
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
4.5
</td>
<td style="text-align:center;">
0.1111111
</td>
<td style="text-align:center;">
0.0236025
</td>
</tr>
</tbody>
</table></div>
<p>Y la curva de supervivencia es la dada en la figura <a href="modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia.html#fig:survival-actuar-example">7.1</a>:</p>
<div class="figure" style="text-align: center">
<span id="fig:survival-actuar-example"></span>
<img src="_main_files/figure-html/survival-actuar-example-1.png" alt="Supervivencia estimada para los pacientes con myeloma múltiple con el método actuarial" width="672"><p class="caption">
Figura 7.1: Supervivencia estimada para los pacientes con myeloma múltiple con el método actuarial
</p>
</div>
</div>
</div>
<div id="estimador-producto-límite-kaplan-meier" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Estimador Producto-Límite (Kaplan-Meier)<a class="anchor" aria-label="anchor" href="#estimador-producto-l%C3%ADmite-kaplan-meier"><i class="fas fa-link"></i></a>
</h2>
<p>El estimador producto-límite fue propuesto por Kaplan y Meier en 1958 como el estimador máximo-verosímil de la función de supervivencia.</p>
<p>El método de Kaplan-Meier calcula la supervivencia cada vez que un paciente muere. Da proporciones exactas de supervivencia debido a que utiliza tiempos de supervivencia precisos.</p>
<p>La característica distintiva del análisis con este método, es que la proporción acumulada que sobrevive se calcula para el tiempo de supervivencia individual de cada paciente, en contraste con la agrupación de los tiempos de supervivencia en intervalos hechos en la tabla de vida. Por esta razón es especialmente útil para estudios que utilizan un número pequeño de pacientes.</p>
<p>Este método asume que:</p>
<ul>
<li>Las personas que se retiran del estudio tienen un destino parecido a las que se quedan.</li>
<li>El periodo de tiempo durante el cual una persona entra en el estudio no tiene efecto independiente en la respuesta.</li>
</ul>
<div id="construcción-del-estimador-k-m" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Construcción del Estimador K-M<a class="anchor" aria-label="anchor" href="#construcci%C3%B3n-del-estimador-k-m"><i class="fas fa-link"></i></a>
</h3>
<p>Es natural pensar a <span class="math inline">\(T\)</span> como una variable aleatoria continua, y por tanto, teóricamente no es posible tener observaciones iguales. No obstante, en la práctica los tiempos de supervivencia son medidos en escalas como: días, meses, años, etcétera; por lo que, hay posibilidad de tener observaciones repetidas. Por esta razón conviene modelar a <span class="math inline">\(T\)</span> como una variable aleatoria discreta. La idea del estimador <em>K-M</em> es la siguiente:</p>
<p>Sea <span class="math inline">\(T_{1}, T_{2},...,T_{n}\)</span> una m.a. de una población discreta con soporte en <span class="math inline">\(\{u_{1}, u_{2},...\}\)</span>.</p>
<p>La muestra observada de <span class="math inline">\(T\)</span> se puede representar como <span class="math inline">\((t_{i},\delta_{i})\)</span> para <span class="math inline">\(i=1,2,...,n\)</span> donde:</p>
<p><span class="math display">\[
\delta_{i} = \left\{
\begin{array}{ll}
0 &amp; \mbox{si }  t_i \ es \ censurado\\
1 &amp; \mbox{si }  t_{i} \ no \ es \ censurado
\end{array}
\right.
\]</span>
Entonces la función de verosimilitud será:</p>
<p><span class="math display">\[ 
\mathscr{L} = \prod^{n}_{i=1}f(t_{i})^{\delta_{i}}S(t_{i})^{1-\delta_{i}} 
\]</span></p>
<p>Desarrollando la expresión anterior tenemos</p>
<p><span class="math display">\[
\mathscr{L} =\prod^{n}_{i=1}(h(u_{k})S(u_{k-1})\mathbb{1}_{t_{i}=u_{k}})^{\delta_{i}} (S(u_{k})\mathbb{1}_{k=max\{j:u_{j}\leq t_i\}})^{1-\delta_{i}}
\]</span></p>
<p>Sea</p>
<p><span class="math display">\[
\begin{split}
 &amp; d_{k} = \sum_{i=1}^{n}\mathbb{1}_{(t_{i}=u_{k},\delta_{i}=1)} \mbox{  (numero de tiempos de fallo iguales a }u_{k}) \\
 &amp; n_{k} = \sum_{i=1}^{n}\mathbb{1}_{(t_{i}\geq{u_{k}})} \mbox{ (numero de individuos en riesgo al tiempo } u_{k})
\end{split}
\]</span></p>
<p><span class="math display">\[
\Longrightarrow \mathscr{L} = \prod_{k} (h(u_k))^{d_k}(1-h(u_k))^{n_k-d_k}
\]</span></p>
<p>Ahora maximizamos la función de verosimilitud para <span class="math inline">\(h(u_k)\)</span>:</p>
<p><span class="math display">\[
\ln (\mathscr{L}) = \sum_{k}\{d_{k} \ln(h(u_{k}))+(n_{k}-d_{k}) \ln(1-h(u_{k}))\} 
\]</span></p>
<p><span class="math display">\[
\Longrightarrow \frac{\partial \ln (\mathscr{L})}{\partial h(u_{k})} = \frac{d_{k}}{h(u_{k})}-\frac{(n_{k}-d_{k})}{(1-h(u_{k}))} = 0
\]</span></p>
<p>despejando <span class="math inline">\(h(u_k)\)</span> se tiene</p>
<p><span class="math display">\[
\therefore \hat{h}(u_{k}) = \frac{d_{k}}{n_{k}}
\]</span></p>
<p>Dado que los estimadores máximo-verosímiles cumplen con el principio de invarianza, y ocupando que <span class="math inline">\(S(t)=\prod_{k:u_{k}\leq t}(1-h(u_{k}))\)</span> (visto anteriormente) tenemos:</p>
<p><span class="math display">\[
\hat S(t)=\prod_{k:u_{k}\leq t}\left(1-\frac{d_k}{n_k}\right)
\]</span></p>
<p>Y es así es como se deriva el estimador <em>K-M</em>.</p>
<p><strong>Proposición:</strong> <span class="math inline">\(\mathbb{E}[\hat{h}(u_k)] =h(u_k)\)</span> (Insesgamiento).</p>
<div id="ejemplo-10" class="section level4 unnumbered">
<h4>Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo-10"><i class="fas fa-link"></i></a>
</h4>
<p>Se obtuvieron los tiempos de remisión de 20 pacientes con osteosarcoma, a los que se trataba con 3 meses de quimioterapia después de amputación.</p>
<ul>
<li>11 pacientes recayeron a los 6, 8, 10, 11, 12, 13, 13, 22, 32, 34 y 36 meses.</li>
<li>8 pacientes se retiraron vivos al final del estudio contribuyendo 3, 7, 7, 11, 14, 16, 20 y 20 meses de observación, sin haber sufrido recaídas.</li>
<li>Un paciente rehusó continuar la terapia a los 11 meses y se retiró del estudio libre de enfermedad.</li>
</ul>
<p>La siguiente tabla muestra la forma de estimar <span class="math inline">\(S(t)\)</span> por el método <em>K-M</em>:</p>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
time
</th>
<th style="text-align:center;">
<span class="math inline">\(d_j\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(n_k\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(c_k\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(1-\frac{d_k}{n_k}\)</span>
</th>
<th style="text-align:center;">
<span class="math inline">\(S(t)\)</span>
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
19
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0.9473684
</td>
<td style="text-align:center;">
0.9473684
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
16
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.9375000
</td>
<td style="text-align:center;">
0.8881579
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
15
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.9333333
</td>
<td style="text-align:center;">
0.8289474
</td>
</tr>
<tr>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
14
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0.9285714
</td>
<td style="text-align:center;">
0.7697368
</td>
</tr>
<tr>
<td style="text-align:center;">
12
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
11
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.9090909
</td>
<td style="text-align:center;">
0.6997608
</td>
</tr>
<tr>
<td style="text-align:center;">
13
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.8000000
</td>
<td style="text-align:center;">
0.5598086
</td>
</tr>
<tr>
<td style="text-align:center;">
22
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
0.7500000
</td>
<td style="text-align:center;">
0.4198565
</td>
</tr>
<tr>
<td style="text-align:center;">
32
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.6666667
</td>
<td style="text-align:center;">
0.2799043
</td>
</tr>
<tr>
<td style="text-align:center;">
34
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.5000000
</td>
<td style="text-align:center;">
0.1399522
</td>
</tr>
<tr>
<td style="text-align:center;">
36
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
0
</td>
<td style="text-align:center;">
0.0000000
</td>
<td style="text-align:center;">
0.0000000
</td>
</tr>
</tbody>
</table></div>
<p>Y la gráfica de <span class="math inline">\(\hat S(t)\)</span> es:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="ejercicio" class="section level4 unnumbered">
<h4>Ejercicio<a class="anchor" aria-label="anchor" href="#ejercicio"><i class="fas fa-link"></i></a>
</h4>
<p>Suponga que disponemos de los datos de supervivencia de 10 pacientes que han sido aleatoriamente asignados a los tratamientos A y B.</p>
<ul>
<li>A: 3, 5, 7, 9+, 18</li>
<li>B: 12, 19, 20, 20+, 33+</li>
</ul>
<p>Construya la función de supervivencia para cada tratamiento y grafíquelas. ¿Qué se puede decir de los tratamientos a partir de las gráficas?</p>

</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento.html"><span class="header-section-number">6</span> La Función de Verosimilitud con Censura y Truncamiento</a></div>
<div class="next"><a href="algunas-estimaciones-sobre-modelos-no-param%C3%A9tricos.html"><span class="header-section-number">8</span> Algunas Estimaciones sobre Modelos No Paramétricos</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia"><span class="header-section-number">7</span> Modelos No Paramétricos para la Función de Supervivencia</a></li>
<li><a class="nav-link" href="#m%C3%A9todo-actuarial-tabla-de-vida"><span class="header-section-number">7.1</span> Método Actuarial (Tabla de Vida)</a></li>
<li>
<a class="nav-link" href="#estimador-producto-l%C3%ADmite-kaplan-meier"><span class="header-section-number">7.2</span> Estimador Producto-Límite (Kaplan-Meier)</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#construcci%C3%B3n-del-estimador-k-m"><span class="header-section-number">7.2.1</span> Construcción del Estimador K-M</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/blob/master/07_NoParametric.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/edit/master/07_NoParametric.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Modelos de Supervivencia</strong>" was written by Sofía Villers Gómez, Carlos Fernando Vásquez Guerra, Luis Angel Ramirez Teodoro. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
