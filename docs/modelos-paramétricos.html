<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 5 Modelos Paramétricos | Modelos de Supervivencia</title>
<meta name="author" content="Sofía Villers Gómez">
<meta name="author" content="Carlos Fernando Vásquez Guerra">
<meta name="author" content="Luis Angel Ramirez Teodoro">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.4/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Modelos de Supervivencia</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Todo es cuestion de tiempo</li>
<li><a class="" href="motivaci%C3%B3n.html">Motivación</a></li>
<li><a class="" href="an%C3%A1lisis-de-supervivencia.html">Análisis de Supervivencia</a></li>
<li><a class="" href="datos-censurados.html"><span class="header-section-number">1</span> Datos Censurados</a></li>
<li><a class="" href="datos-truncados.html"><span class="header-section-number">2</span> Datos Truncados</a></li>
<li class="book-part">Estudio paramétrico</li>
<li><a class="" href="funciones-para-el-an%C3%A1lisis-de-supervivencia.html"><span class="header-section-number">3</span> Funciones para el Análisis de Supervivencia</a></li>
<li><a class="" href="par-poblacionales.html"><span class="header-section-number">4</span> Parámetros Poblacionales</a></li>
<li><a class="active" href="modelos-param%C3%A9tricos.html"><span class="header-section-number">5</span> Modelos Paramétricos</a></li>
<li><a class="" href="la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento.html"><span class="header-section-number">6</span> La Función de Verosimilitud con Censura y Truncamiento</a></li>
<li class="book-part">Estudio no paramétrico</li>
<li><a class="" href="modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia.html"><span class="header-section-number">7</span> Modelos No Paramétricos para la Función de Supervivencia</a></li>
<li><a class="" href="algunas-estimaciones-sobre-modelos-no-param%C3%A9tricos.html"><span class="header-section-number">8</span> Algunas Estimaciones sobre Modelos No Paramétricos</a></li>
<li><a class="" href="pruebas-de-hip%C3%B3tesis.html"><span class="header-section-number">9</span> Pruebas de Hipótesis</a></li>
<li class="book-part">Lleno de riesgos</li>
<li><a class="" href="modelo-de-riesgos-proporcionales.html"><span class="header-section-number">10</span> Modelo de Riesgos Proporcionales</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modelos-paramétricos" class="section level1" number="5">
<h1>
<span class="header-section-number">Capítulo 5</span> Modelos Paramétricos<a class="anchor" aria-label="anchor" href="#modelos-param%C3%A9tricos"><i class="fas fa-link"></i></a>
</h1>
<p>Existen varios modelos paramétricos que se emplean en el análisis de supervivencia, esto se debe a que pueden representar de manera adecuada el comportamiento de ciertos fenómenos. La motivación para usar un modelo en particular es, por lo general, empírica; o bien, con base en la información que proporcione algún modelo <strong>No paramétrico</strong>. Las familias paramétricas más importantes son: <em>Exponencial, Weibull, Log-Normal, Log-logística</em> y <em>Gamma</em>.</p>
<div id="modelo-exponencial" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Modelo Exponencial<a class="anchor" aria-label="anchor" href="#modelo-exponencial"><i class="fas fa-link"></i></a>
</h2>
<p>El modelo exponencial es el más importante debido a su amplia aplicación, por ejemplo, puede emplearse en estudios para determinar el tiempo de vida útil de algunos artículos manufacturados. Este modelo juega un papel fundamental análogo a la <em>distribución normal</em> en la inferencia estadística tradicional.</p>
<p><strong>Función de Densidad</strong></p>
<p><span class="math display">\[
f(t)=h(t)S(t)=\lambda exp(-\lambda t)=\lambda e^{-\lambda t}
\]</span>
Para esta distribución <span class="math inline">\(\lambda\)</span> es un parámetro que modifica la escala de la distribución. Este es comúnmente llamado <strong><em>tasa</em></strong> definido por <span class="math inline">\(1/s\)</span> donde <span class="math inline">\(s\)</span> es el verdadero parámetro de escala<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Un parámetro de escala modifica la escala o &lt;em&gt;dispersión&lt;/em&gt; de la distribución ya sea que entre mayor sea este parámetro mayor dispersión se tendrá o se tenga el caso contrario como en una &lt;em&gt;log-logistica&lt;/em&gt;. En el siguiente &lt;a href="https://en.wikipedia.org/wiki/Scale_parameter"&gt;enlace&lt;/a&gt; se puede encontrar mayor información sobre esto así como animaciones para un mejor entendimiento.&lt;/p&gt;'><sup>4</sup></a> de la distribución. Es muy común utilizar este parámetro en lugar del parámetro de escala ya que simplifica la expresión matemática.</p>
<p><strong>Función de Supervivencia</strong></p>
<p><span class="math display">\[
S(t)=exp\left(-\int_0^{t}h(u)du\right)=exp\left(-\int_0^{t}\lambda du\right)=exp(-\lambda t)=e^{-\lambda t}
\]</span></p>
<p>Si asumimos <strong>una tasa de riesgo invariante en el tiempo</strong>, <span class="math inline">\(h(t)=\lambda\)</span> con <span class="math inline">\(\lambda&gt;0\)</span>, generamos el modelo exponencial:</p>
<p><strong>Función de Riesgo</strong></p>
<p>Tomamos <span class="math inline">\(\lambda&gt;0\)</span> y hacemos:</p>
<p><span class="math display">\[
h(t)=\lambda
\]</span></p>
<p>Aunque el supuesto de una función de riesgo constante resulta ser una restricción considerable, el modelo exponencial no deja de ser útil e importante en variedad de aplicaciones. Cabe destacar, que este modelo cumple con la propiedad de <em>pérdida de memoria</em>; a saber, se cumple que:</p>
<p><span class="math display">\[
\mathbb{P}(T&gt;t+x|T&gt;t)=\mathbb{P}(T&gt;x)
\]</span></p>
<p><strong>Parámetros</strong></p>
<p>Si <span class="math inline">\(T\sim Exp(\lambda)\)</span> entonces:</p>
<p><span class="math display">\[
\mathbb{E}[T]=\int_{0}^{\infty}t\lambda e^{-\lambda t}dt=\frac{1}{\lambda}
\]</span></p>
<p>Y</p>
<p><span class="math display">\[
Var[T]=\mathbb{E}[T^2]-\mathbb{E}[T]^2=\frac{2}{\lambda^2}-\frac{1}{\lambda^2}=\frac{1}{\lambda^2}
\]</span></p>
<p><strong>Gráficas</strong></p>
<p>A continuación se muestran gráficas de una <span class="math inline">\(Exponencial\)</span> con <span class="math inline">\(\lambda=0.5\)</span></p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;"></div>
<p><strong>R</strong></p>
<p>En el lenguaje de programación <code>R</code> se pueden obtener resultados de esta distribución como una muestra pseudo aleatoria y aproximaciones numéricas para la distribución y densidad de esta así como la obtención de los cuantiles.</p>
<p>En general, el sufijo para esta distribución es <code>*exp</code>, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/Exponential.html">rexp(n, rate = 1)</a></code>: Muestra pseudo aleatoria de tamaño <span class="math inline">\(n\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Exponential.html">dexp(x, rate = 1, log = FALSE)</a></code>: Valores de <span class="math inline">\(f(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Exponential.html">pexp(q, rate = 1, lower.tail = TRUE, log.p = FALSE)</a></code>: Valores de <span class="math inline">\(F(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Exponential.html">qexp(p, rate = 1, lower.tail = TRUE, log.p = FALSE)</a></code>: Cuantil <span class="math inline">\(t_p\)</span>.</li>
</ul>
<p>Algo que hay que recordar es que al utilizar la función, por ejemplo, <code><a href="https://rdrr.io/r/stats/Exponential.html">rexp(n, r)</a></code> se respeta el orden de los parámetros por lo que <code>r</code> será el valor correspondiente a la tasa y no parámetro de escala es decir el valor <span class="math inline">\(r = \lambda\)</span>. Se menciona esta por que puede ser común que se confunda <code>r</code> con <span class="math inline">\(1/\lambda\)</span>, por lo que se recomienda tener precaución.</p>
</div>
<div id="modelo-weibull" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Modelo Weibull<a class="anchor" aria-label="anchor" href="#modelo-weibull"><i class="fas fa-link"></i></a>
</h2>
<p>El modelo Weibull es una generalización del modelo exponencial, se agrega un parámetro de forma<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Un parámetro de forma es aquel que no es de escala ni de localización o una función de estos, ya que su único propósito es modificar la forma de la distribución de manera distinta a estos anteriores, es decir que no sólo traslada o afecta la variabilidad de la misma.&lt;/p&gt;"><sup>5</sup></a> <span class="math inline">\(\gamma\)</span> y se mantiene el parámetro de escala <span class="math inline">\(\lambda\)</span>. Este modelo es uno de los más utilizados para tiempos de falla: tiene utilidad en la vida de algunos artículos manufacturados, así como en los tiempos de aparición de tumores en medicina.</p>
<p><strong>Función de Densidad</strong>
<span class="math display">\[
f(t)=\lambda \gamma(\lambda t)^{\gamma-1}e^{-(\lambda t)^\gamma}=h(t)S(t)
\]</span></p>
<p>Obsérvese que si <span class="math inline">\(\gamma =1\)</span> entonces el modelo Weibull se reduce al modelo exponencial.</p>
<p><strong>Función de Supervivencia</strong></p>
<p><span class="math display">\[
S(t)=exp\left(-\int_0^{t}h(u)du\right)=exp\left(-\int_0^{t}\lambda \gamma(\lambda u)^{\gamma-1} du\right)=exp(-(\lambda t)^\gamma)=e^{-(\lambda t)^\gamma}
\]</span></p>
<p>Si asumimos, en general, una <strong>función de riesgo monótona: creciente o decreciente</strong>, se puede obtener el modelo Weibull.</p>
<p><strong>Función de Riesgo</strong></p>
<p>Para este modelo <span class="math inline">\(h(t)\)</span> está dada por:</p>
<p><span class="math display">\[
h(t)=\lambda \gamma(\lambda t)^{\gamma-1}; \ \ \ \gamma&gt;0, \lambda&gt;0 \mbox{ y } t&gt;0
\]</span></p>
<p><strong>Parámetros</strong></p>
<p>Si <span class="math inline">\(T\sim Weibull(\gamma,\lambda)\)</span> entonces:</p>
<p><span class="math display">\[
\mathbb{E}[T]=\frac{1}{\lambda}\Gamma\left(\frac{1}{\gamma}+1\right)
\]</span></p>
<p>Y además</p>
<p><span class="math display">\[
Var[T]=\frac{1}{\lambda^2}\Gamma\left(\frac{2}{\gamma}+1\right)-\left(\frac{1}{\lambda}\Gamma\left(\frac{1}{\gamma}+1\right)\right)^2
\\=\frac{1}{\lambda^2}\left[\Gamma\left(\frac{2}{\gamma}+1\right)-\left(\Gamma\left(\frac{1}{\gamma}+1\right)\right)^2\right]
\]</span>
Debe resultar sencillo para el alumno demostrar las igualdades de la esperanza y varianza.</p>
<p><strong>Gráficas</strong></p>
<p>Las dos gráficas siguientes muestran curvas de <span class="math inline">\(f(t)\)</span> y <span class="math inline">\(h(t)\)</span> para el modelo Weibull con <span class="math inline">\(\lambda=1\)</span> y <span class="math inline">\(\gamma=2,4\)</span>:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Y para el modelo Weibull con <span class="math inline">\(\lambda=1\)</span> y <span class="math inline">\(\gamma=0.5,1\)</span> se tienen las siguientes gráficas:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Como bien hemos dicho, si suponemos una función de riesgo monótona creciente ó decreciente la distribución Weibull puede ser generada. Concretamente, si <span class="math inline">\(\gamma&gt;1\)</span> entonces <span class="math inline">\(h(t)\)</span> es estrictamente creciente, si <span class="math inline">\(\gamma&lt;1\)</span> entonces <span class="math inline">\(h(t)\)</span> es estrictamente decreciente. Cuando <span class="math inline">\(\gamma=1\)</span> se tiene la distribución exponencial.</p>
<p><strong>R</strong></p>
<p>Para este caso el sufijo referente a esta distribución es <code>*weibull</code>, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/Weibull.html">rweibull(n, shape, scale = 1)</a></code>: Muestra pseudo aleatoria de tamaño <span class="math inline">\(n\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Weibull.html">dweibull(x, shape, scale = 1, log = FALSE)</a></code>: Valores de <span class="math inline">\(f(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Weibull.html">pweibull(q, shape, scale = 1, lower.tail = TRUE, log.p = FALSE)</a></code>: Valores de <span class="math inline">\(F(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Weibull.html">qweibull(p, shape, scale = 1, lower.tail = TRUE, log.p = FALSE)</a></code>: Cuantil <span class="math inline">\(t_p\)</span>.</li>
</ul>
<p>Así como en el caso de la exponencial y en todos los casos posteriores, se respeta el orden de los parámetros por lo que para aplicar los parámetros tal como se vieron en esta sección se puede utilizar esta función de la siguiente manera: <code>dweibull</code>(<span class="math inline">\(\gamma\)</span>, <span class="math inline">\(1/\lambda\)</span>) o sin importar el orden indicando de manera explicita que <code>shape</code> = <span class="math inline">\(\gamma\)</span> y <code>scale</code> = <span class="math inline">\(1/\lambda\)</span>. Esto último debido a que la función de densidad para este modelo en R esta considerada como <span class="math inline">\(f(x) = \frac{\gamma}{\lambda}(\frac{x}{\lambda})^{\gamma-1}e^{-(\frac{x}{\lambda})^\gamma}\)</span>.</p>
</div>
<div id="modelo-log-normal" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Modelo Log-Normal<a class="anchor" aria-label="anchor" href="#modelo-log-normal"><i class="fas fa-link"></i></a>
</h2>
<p>El modelo Log-Normal tiene estrecha relación con la distribución <em>Normal</em>. De hecho, el tiempo de supervivencia <span class="math inline">\(T\)</span> se dice que sigue una distribución Log-Normal, si <span class="math inline">\(Y=ln(T)\)</span> se distribuye <span class="math inline">\(N(\mu,\sigma^2)\)</span>.</p>
<p>La distribución Log-Normal se ha utilizado como modelo en el tiempo de falla de aislantes eléctricos y en el tiempo de aparición de cáncer pulmonar. También se utiliza en poblaciones que son una mezcla de tiempos de vida cortos y largos. A pesar de esto, este modelo es criticado por ser decreciente para valores grandes de <span class="math inline">\(t\)</span>, lo cual parece inadecaudo en algunas situaciones.</p>
<p><strong>Función de Densidad</strong></p>
<p>Para este modelo, <span class="math inline">\(f(t)\)</span> está dada por:</p>
<p><span class="math display">\[
f(t)=\frac{1}{\sqrt {2\pi}\sigma t}exp\left(-\frac{1}{2}\left(\frac{ln(t)-\mu}{\sigma}\right)^2\right)
\]</span></p>
<p>En este caso, <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> pasan a ser los parámetros de escala y de forma de la distribución, los cuales hacen diferencia con los de la distribución normal, ya que en tal caso <span class="math inline">\(\mu\)</span> sería un parámetro de localización y <span class="math inline">\(\sigma\)</span> seguiría siendo el parámetro de escala. Para agregar un parámetro de localización a la distribución <span class="math inline">\(log-normal\)</span> bastaría camiar <span class="math inline">\(x\)</span> por <span class="math inline">\(x-\theta\)</span> donde <span class="math inline">\(\theta\)</span> sería tal parámetro.</p>
<p><strong>Función de Supervivencia</strong></p>
<p><span class="math display">\[
S(t)=\int_t^{\infty}f(u)du
\\=1-\int_0^{t}f(u)du
\\=1-\int_0^{t}\frac{1}{\sqrt {2\pi}\sigma u}exp\left(-\frac{1}{2}\left(\frac{ln(u)-\mu}{\sigma}\right)^2\right)du
\]</span></p>
<p>Tomando la notación de la función de distribución de una <em>Normal estándar</em>, <span class="math inline">\(\Phi()\)</span>, se tiene:</p>
<p><span class="math display">\[
S(t)=1-\Phi\left(\frac{ln(t)-\mu}{\sigma}\right)
\]</span></p>
<p><strong>Función de Riesgo</strong></p>
<p><span class="math display">\[
h(t)=\frac{f(t)}{S(t)}
\\=\frac{\frac{1}{\sqrt {2\pi}\sigma t}exp\left(-\frac{1}{2}\left(\frac{ln(t)-\mu}{\sigma}\right)^2\right)}{1-\Phi\left(\frac{ln(t)-\mu}{\sigma}\right)}
\]</span></p>
<p>Si bien la expresión de <span class="math inline">\(h(t)\)</span> parece ser complicada, su gráfica resulta ser más interesante. Ésta toma el valor de cero en <span class="math inline">\(t=0\)</span>, crece hasta un valor máximo y luego tiende a cero cuando <span class="math inline">\(t \rightarrow \infty\)</span>. Véase sección de gráficas.</p>
<p><strong>Parámetros</strong></p>
<p>Si <span class="math inline">\(T\sim LogNormal(\mu,\sigma^2)\)</span> entonces:</p>
<p><span class="math display">\[
\mathbb{E}[T]=exp\left(\mu+\frac{\sigma^2}{2}\right)
\]</span></p>
<p>Y además</p>
<p><span class="math display">\[
Var[T]=exp(2\mu+2\sigma^2)-exp(2\mu+\sigma^2)
\]</span></p>
<p>La demostración de las igualdades de media y varianza se dejan al alumno.</p>
<p><strong>Gráficas</strong></p>
<p>A continuación algunos ejemplos de las gráficas de <span class="math inline">\(f(t)\)</span> y <span class="math inline">\(h(t)\)</span> para la distribución Log-Normal:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;"></div>
<p><strong>R</strong></p>
<p>Para esta distribución el sufijo respectivo será <code>*lnorm</code>, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/Lognormal.html">rlnorm(n, meanlog = 0, sdlog = 1)</a></code>: Muestra pseudo aleatoria de tamaño <span class="math inline">\(n\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Lognormal.html">dlnorm(x, meanlog = 0, sdlog = 1, log = FALSE)</a></code>: Valores de <span class="math inline">\(f(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Lognormal.html">plnorm(q, meanlog = 0, sdlog = 1, lower.tail = TRUE, log.p = FALSE)</a></code>: Valores de <span class="math inline">\(F(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/Lognormal.html">qlnorm(p, meanlog = 0, sdlog = 1, lower.tail = TRUE, log.p = FALSE)</a></code>: Cuantil <span class="math inline">\(t_p\)</span>.</li>
</ul>
<p>En este caso, es evidente que <code>meanlog</code> correspondería al parámetro de escala <span class="math inline">\(\mu\)</span> y <code>sdlog</code> al parámetro de forma <span class="math inline">\(\sigma\)</span>. Finalmente se menciona que estos parámetros no se deben confundir explícitamente con los de una distribución normal.</p>
<div id="ejemplo-6" class="section level4 unnumbered">
<h4>Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo-6"><i class="fas fa-link"></i></a>
</h4>
<p>El tiempo de muerte en días después de un trasplante de médula sigue una distribución <span class="math inline">\(log-normal\)</span> con <span class="math inline">\(\mu = 3.177, \sigma = 2.084\)</span>. Calcular lo siguiente</p>
<ol style="list-style-type: decimal">
<li>La media y la mediano tiempo de muerte</li>
<li>La probabilidad de que un individuo sobreviva 200 días después de un trasplante.</li>
</ol>
<p>Soluciones</p>
<ol style="list-style-type: decimal">
<li>
</ol>
<ul>
<li>Mediana: <span class="math inline">\(t_{0.5} =e^{\mu}\)</span> cuando <span class="math inline">\(T\sim log-normal \implies\)</span> Mediana de tiempo de muerte: <span class="math inline">\(t_{0.5} = e^{3.177} = 23.97\)</span>.</li>
<li>Media: <span class="math inline">\(\mathbb{E}(T) = e^{\mu+\sigma^2/2}\)</span> cuando <span class="math inline">\(T\sim log- normal \implies\)</span> Media de tiempo de muerte: <span class="math inline">\(\mathbb{E}(T) = e^{3.177+\frac{(2.084)^2}{2}} = 210.29\)</span> días.</li>
</ul>
<p>Entonces si sobrevivieron 23.97, queda una gran cantidad de días donde, en promedio son 210.29.</p>
<ol start="2" style="list-style-type: decimal">
<li>
<span class="math inline">\(S(200) = 1-\Phi\left(\frac{\ln(200)-3.177}{2.084}\right) = 1-0.8438 = 0.15436\)</span>.</li>
</ol>
</div>
</div>
<div id="modelo-log-logístico" class="section level2" number="5.4">
<h2>
<span class="header-section-number">5.4</span> Modelo Log-Logístico<a class="anchor" aria-label="anchor" href="#modelo-log-log%C3%ADstico"><i class="fas fa-link"></i></a>
</h2>
<p>El modelo Log-Logístico es derivado de la distribución <em>Logística</em>. Se dice que <span class="math inline">\(T\)</span> tiene distribución Log-Logística si <span class="math inline">\(Y=ln(T)\)</span> sigue una distribución Logística con parámetros <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma ^2\)</span>.</p>
<p><strong>Función de Densidad</strong></p>
<p><span class="math display">\[
f(t)=\frac{\alpha \lambda (\lambda t)^{\alpha-1}}{(1+(\lambda t)^\alpha)^2}
\]</span></p>
<p>con <span class="math inline">\(\alpha=\frac{1}{\sigma}\)</span> y <span class="math inline">\(\lambda=exp(-\frac{\mu}{\sigma})&gt;0\)</span>. <span class="math inline">\(\alpha\)</span> es el parámetro de forma y <span class="math inline">\(\lambda\)</span> es el parámetro de escala.</p>
<p><strong>Función de Supervivencia</strong></p>
<p><span class="math display">\[
S(t)=\frac{1}{1+(\lambda t)^\alpha}
\]</span></p>
<p><strong>Función de Riesgo</strong></p>
<p><span class="math display">\[
h(t)=\frac{f(t)}{S(t)}=\frac{\alpha \lambda (\lambda t)^{\alpha-1}}{1+(\lambda t)^\alpha}
\]</span></p>
<p>La función de riesgo es monótona decreciente para <span class="math inline">\(\alpha \leq 1\)</span>, y para <span class="math inline">\(\alpha&gt; 1\)</span> la función de riesgo crece hasta alcanzar un máximo en <span class="math inline">\(t=(\frac{\alpha-1}{\lambda})^{\frac{1}{\alpha}}\)</span> y luego decrece a cero cuando <span class="math inline">\(t \rightarrow \infty\)</span>.</p>
<p><strong>Gráficas</strong></p>
<p>Algunos ejemplos de las gráficas de <span class="math inline">\(f(t)\)</span> y <span class="math inline">\(h(t)\)</span> para la distribución Log-Logística:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;"></div>
<p><strong>R</strong></p>
<p>Para esta distribución se recomienda descargar y utilizar el paquete <code>actuar</code>, en la cual vienen un conjunto de funciones similares a las anteriores, de hecho el sufijo respectivo será <code>*llogis</code> y, de manera análoga a las anteriores funciones, se tiene lo siguiente:</p>
<ul>
<li>
<code>rllogis(n, shape, rate = 1, scale = 1/rate)</code>: Muestra pseudo aleatoria de tamaño <span class="math inline">\(n\)</span>.</li>
<li>
<code>dllogis(x, shape, rate = 1, scale = 1/rate, log = FALSE)</code>: Valores de <span class="math inline">\(f(x)\)</span>.</li>
<li>
<code>pllogis(q, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE)</code>: Valores de <span class="math inline">\(F(x)\)</span>.</li>
<li>
<code>qllogis(p, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE)</code>: Cuantil <span class="math inline">\(t_p\)</span>.</li>
</ul>
<p>En este caso, como en la exponencial y la weibull, <code>rate</code> correspondería al parámetro <span class="math inline">\(\lambda\)</span> y <code>shape</code> al parámetro de forma <span class="math inline">\(\alpha\)</span>.</p>
</div>
<div id="modelo-gamma" class="section level2" number="5.5">
<h2>
<span class="header-section-number">5.5</span> Modelo Gamma<a class="anchor" aria-label="anchor" href="#modelo-gamma"><i class="fas fa-link"></i></a>
</h2>
<p>La distribución Gamma, que incluye a las distribuciones <em>exponencial</em> y <em>ji-cuadrada</em>, ha sido utilizada como un modelo para problemas de confiabilidad industrial, hepatogramas en adultos normales y en pacientes con cirrosis, en supervivencia de plaquetas, entre otros. Este modelo tiene dos parámetros: <span class="math inline">\(\beta\)</span> es el parámetro de forma y <span class="math inline">\(\lambda\)</span> es el parámetro que modifica de escala; estrictamente hablando <span class="math inline">\(\lambda\)</span> es la tasa: <span class="math inline">\(\lambda =\frac{1}{s}\)</span> donde <span class="math inline">\(s\)</span> sería el verdadero parámetro de escala.</p>
<p><strong>Función de Densidad</strong></p>
<p><span class="math inline">\(f(t)\)</span> está dada por:</p>
<p><span class="math display">\[
f(t)=\frac{\lambda^\beta}{\Gamma(\beta)}t^{\beta-1}exp(-\lambda t); \ \ \  \lambda,\beta&gt;0
\]</span></p>
<p><strong>Función de Supervivencia</strong></p>
<p><span class="math display">\[
S(t)=1-Ig(\lambda t, \beta)
\]</span></p>
<p>donde<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Esta función se llama &lt;em&gt;función gamma incompleta&lt;/em&gt; y en algunas fuentes se puede encontrar esta en particular como &lt;em&gt;&lt;strong&gt;lower incomplete gamma function&lt;/strong&gt;&lt;/em&gt;. Cuando se tiene &lt;span class="math inline"&gt;\(\int_x^{\infty}u^{\beta-1}e^{-u}du = \Gamma(x, \beta)\)&lt;/span&gt; se le conoce como &lt;em&gt;&lt;strong&gt;upper incomplete gamma function&lt;/strong&gt;&lt;/em&gt;, la cual es una &lt;a href="https://mathworld.wolfram.com/IncompleteGammaFunction.html"&gt;generalización&lt;/a&gt; de la función gamma: &lt;span class="math inline"&gt;\(\Gamma(x, 0) = \Gamma(x)\)&lt;/span&gt;. Originalmente esta función no tiene el cociente que se esta utilizando en este caso, esto es un efecto de normalizar la función como se puede ver en el siguiente &lt;a href="https://dlmf.nist.gov/8.2"&gt;enlace&lt;/a&gt;. Algunas veces esta función es conocida directamente como función gamma incompleta como en &lt;span class="citation"&gt;(Klein and Moeschberger &lt;a href="modelo-de-riesgos-proporcionales.html#ref-klein2006survival" role="doc-biblioref"&gt;2006&lt;/a&gt;)&lt;/span&gt;&lt;/p&gt;'><sup>6</sup></a>:</p>
<p><span class="math display">\[
Ig(t,\beta)=\frac{1}{\Gamma(\beta)}\int_0^{t}u^{\beta-1}e^{-u}du
\]</span>
Al igual que un modelo <span class="math inline">\(Weibull(\lambda, alpha = 1)\)</span>, la distribución exponencial es un caso particular del modelo <span class="math inline">\(Gamma(\lambda,\beta = 1)\)</span>. Cuando <span class="math inline">\(\beta \rightarrow\infty\)</span>, modelo gamma se aproxima a una distribución normal.</p>
<p><strong>Función de Riesgo</strong></p>
<p><span class="math display">\[
h(t)=\frac{f(t)}{S(t)}=\frac{\frac{\lambda^\beta}{\Gamma(\beta)}t^{\beta-1}exp(-\lambda t)}{1-Ig(\lambda t, \beta)}
\]</span></p>
<p>Esta función de riesgo tiene distintos comportamientos:</p>
<ul>
<li>Es <strong>monótona creciente</strong> para <span class="math inline">\(\beta&gt;1\)</span>. En este caso sucede que <span class="math inline">\(h(0)=0\)</span> y <span class="math inline">\(\underset{t\rightarrow\infty}{h(t)} \rightarrow \lambda\)</span>. Además, la moda de la distribución es <span class="math inline">\(t = \frac{\beta-1}{\lambda}\)</span>
</li>
<li>Es <strong>monótona decreciente</strong> con <span class="math inline">\(\beta &lt;1\)</span>. En tal caso <span class="math inline">\(h(0) = \infty\)</span> y <span class="math inline">\(\underset{t\rightarrow\infty}{h(t)} \rightarrow \lambda\)</span>.</li>
</ul>
<p><strong>Parámetros</strong></p>
<p>Si <span class="math inline">\(T\sim Gamma(\beta,\lambda)\)</span> entonces:</p>
<p><span class="math display">\[
\begin{array}{ccc}
\mathbb{E}[T]=\frac{\beta}{\lambda} &amp; \mbox{y} &amp;
Var[T]=\frac{\beta}{\lambda^2}
\end{array}
\]</span></p>
<p>Las demostraciones de las igualdades de la esperanza y varianza se quedan de ejercicio al alumno.</p>
<p><strong>Gráficas</strong></p>
<p>Se muestran ejemplos de las gráficas de <span class="math inline">\(f(t)\)</span> y <span class="math inline">\(h(t)\)</span> para el modelo Gamma:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;"></div>
<p><strong>R</strong></p>
<p>Para esta distribución el sufijo respectivo será <code>*gamma</code>, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma(n, shape, rate = 1, scale = 1/rate)</a></code>: Muestra pseudo aleatoria de tamaño <span class="math inline">\(n\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/GammaDist.html">dgamma(x, shape, rate = 1, scale = 1/rate, log = FALSE)</a></code>: Valores de <span class="math inline">\(f(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/GammaDist.html">pgamma(q, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE)</a></code>: Valores de <span class="math inline">\(F(x)\)</span>.</li>
<li>
<code><a href="https://rdrr.io/r/stats/GammaDist.html">qgamma(p, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE)</a></code>: Cuantil <span class="math inline">\(t_p\)</span>.</li>
</ul>
<p>Como en el caso de la exponencial, se recomienda tener precaución ya que el parámetro <code>rate</code> es el que corresponde al parámetro <span class="math inline">\(\lambda\)</span> en este trabajo.</p>
</div>
<div id="modelo-gamma-generalizada" class="section level2" number="5.6">
<h2>
<span class="header-section-number">5.6</span> Modelo Gamma Generalizada<a class="anchor" aria-label="anchor" href="#modelo-gamma-generalizada"><i class="fas fa-link"></i></a>
</h2>
<p>Finalmente, se presenta el modelo Gamma Generalizada con dos parámetros de forma y un parámetro de que modifica la escala <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> y <span class="math inline">\(\lambda\)</span> respectivamente.</p>
<p><strong>Función de Densidad</strong></p>
<p><span class="math inline">\(f(t)\)</span> está dada por:</p>
<p><span class="math display">\[
f(t)=\frac{\alpha\lambda^{\beta\alpha}}{\Gamma(\beta)}t^{\alpha\beta-1}\exp(-\lambda t)^\alpha; \ \ \  \lambda,\alpha, \beta&gt;0
\]</span></p>
<p><strong>Función de Supervivencia</strong></p>
<p><span class="math display">\[
S(t)=1-Ig((\lambda t)^\alpha, \beta)
\]</span></p>
<p>Esta distribución se reduce a las siguientes</p>
<ul>
<li>
<span class="math inline">\(Exponencial\)</span> cuando <span class="math inline">\(\beta = \alpha = 1\)</span>.</li>
<li>
<span class="math inline">\(Weibull\)</span> cuando <span class="math inline">\(\beta = 1\)</span>.</li>
<li>
<span class="math inline">\(Gamma\)</span> cuando <span class="math inline">\(\alpha = 1\)</span>.</li>
<li>Tiende a la log-normal cuando <span class="math inline">\(\beta\rightarrow\infty\)</span>.</li>
</ul>
<p><strong>R</strong></p>
<p>Para esta distribución se recomienda descargar y utilizar el paquete <code>ggamma</code>, en la cual vienen un conjunto de funciones similares a las anteriores. Aquí el respectivo sufijo será <code>*ggamma</code> y, de manera análoga a las anteriores funciones, se tiene lo siguiente:</p>
<ul>
<li>
<code>rggamma(n, a, b, k)</code>: Muestra pseudo aleatoria de tamaño <span class="math inline">\(n\)</span>.</li>
<li>
<code>dggamma(x, a, b, k, log = F)</code>: Valores de <span class="math inline">\(f(x)\)</span>.</li>
<li>
<code>pggamma(p, a, b, k, lower.tail = TRUE, log.p = FALSE)</code>: Valores de <span class="math inline">\(F(x)\)</span>.</li>
<li>
<code>qggamma(p, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE)</code>: Cuantil <span class="math inline">\(t_p\)</span>.</li>
</ul>
<p>Para este caso, se tiene una parametrización de uso común en distintas fuentes. <code>a</code> = <span class="math inline">\(\frac{1}{\lambda}\)</span>, <code>b</code> = <span class="math inline">\(\alpha\)</span> y <code>k</code> = <span class="math inline">\(\beta\)</span>.</p>
<div id="ejemplo-7" class="section level4 unnumbered">
<h4>Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo-7"><i class="fas fa-link"></i></a>
</h4>
<p>El tiempo de vida en meses de cierta especie de ratón sigue una distribución <span class="math inline">\(gamma(\beta = 3, \lambda = 0.2)\)</span>.</p>
<ol style="list-style-type: decimal">
<li>Calcular la probabilidad de que un ratón sobreviva más de 18 meses.</li>
<li>¿Cuál es la probabilidad de que un ratón muera en el primer año de vida?</li>
<li>¿Cuál es la esperanza de vida media de esta especia?</li>
</ol>
<p>Soluciones</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(S(18) = 1-F(18) = 1-\)</span> 0.6972532 = 0.3027468</li>
<li>
<span class="math inline">\(F(12) =\)</span> 0.4302913</li>
<li>
<span class="math inline">\(\mathbb{E}(T) = \frac{\beta}{\lambda} = \frac{3}{0.2} = 15\)</span> meses.</li>
</ol>
<p>Cabe señalar que hasta este punto <strong>no hemos introducido datos censurados a los modelos</strong>.</p>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="par-poblacionales.html"><span class="header-section-number">4</span> Parámetros Poblacionales</a></div>
<div class="next"><a href="la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento.html"><span class="header-section-number">6</span> La Función de Verosimilitud con Censura y Truncamiento</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelos-param%C3%A9tricos"><span class="header-section-number">5</span> Modelos Paramétricos</a></li>
<li><a class="nav-link" href="#modelo-exponencial"><span class="header-section-number">5.1</span> Modelo Exponencial</a></li>
<li><a class="nav-link" href="#modelo-weibull"><span class="header-section-number">5.2</span> Modelo Weibull</a></li>
<li><a class="nav-link" href="#modelo-log-normal"><span class="header-section-number">5.3</span> Modelo Log-Normal</a></li>
<li><a class="nav-link" href="#modelo-log-log%C3%ADstico"><span class="header-section-number">5.4</span> Modelo Log-Logístico</a></li>
<li><a class="nav-link" href="#modelo-gamma"><span class="header-section-number">5.5</span> Modelo Gamma</a></li>
<li><a class="nav-link" href="#modelo-gamma-generalizada"><span class="header-section-number">5.6</span> Modelo Gamma Generalizada</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/blob/master/05_ParametricModels.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/edit/master/05_ParametricModels.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Modelos de Supervivencia</strong>" was written by Sofía Villers Gómez, Carlos Fernando Vásquez Guerra, Luis Angel Ramirez Teodoro. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
