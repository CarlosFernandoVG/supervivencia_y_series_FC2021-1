<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 10 Modelo de Riesgos Proporcionales | Modelos de Supervivencia</title>
<meta name="author" content="Sofía Villers Gómez">
<meta name="author" content="Carlos Fernando Vásquez Guerra">
<meta name="author" content="Luis Angel Ramirez Teodoro">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.4/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Modelos de Supervivencia</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Todo es cuestion de tiempo</li>
<li><a class="" href="motivaci%C3%B3n.html">Motivación</a></li>
<li><a class="" href="an%C3%A1lisis-de-supervivencia.html">Análisis de Supervivencia</a></li>
<li><a class="" href="datos-censurados.html"><span class="header-section-number">1</span> Datos Censurados</a></li>
<li><a class="" href="datos-truncados.html"><span class="header-section-number">2</span> Datos Truncados</a></li>
<li class="book-part">Estudio paramétrico</li>
<li><a class="" href="funciones-para-el-an%C3%A1lisis-de-supervivencia.html"><span class="header-section-number">3</span> Funciones para el Análisis de Supervivencia</a></li>
<li><a class="" href="par-poblacionales.html"><span class="header-section-number">4</span> Parámetros Poblacionales</a></li>
<li><a class="" href="modelos-param%C3%A9tricos.html"><span class="header-section-number">5</span> Modelos Paramétricos</a></li>
<li><a class="" href="la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento.html"><span class="header-section-number">6</span> La Función de Verosimilitud con Censura y Truncamiento</a></li>
<li class="book-part">Estudio no paramétrico</li>
<li><a class="" href="modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia.html"><span class="header-section-number">7</span> Modelos No Paramétricos para la Función de Supervivencia</a></li>
<li><a class="" href="algunas-estimaciones-sobre-modelos-no-param%C3%A9tricos.html"><span class="header-section-number">8</span> Algunas Estimaciones sobre Modelos No Paramétricos</a></li>
<li><a class="" href="pruebas-de-hip%C3%B3tesis.html"><span class="header-section-number">9</span> Pruebas de Hipótesis</a></li>
<li class="book-part">Lleno de riesgos</li>
<li><a class="active" href="modelo-de-riesgos-proporcionales.html"><span class="header-section-number">10</span> Modelo de Riesgos Proporcionales</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modelo-de-riesgos-proporcionales" class="section level1" number="10">
<h1>
<span class="header-section-number">Capítulo 10</span> Modelo de Riesgos Proporcionales<a class="anchor" aria-label="anchor" href="#modelo-de-riesgos-proporcionales"><i class="fas fa-link"></i></a>
</h1>
<p>Cuando se desea comparar 2 o más grupos de tiempos-evento, si los grupos son “similares” entonces se les pueden aplicar los métodos no paramétricos vistos. Usualmente los individuos en los grupos tienen características adicionales que pueden afectar el resultado, por ejemplo, variables como: edad, género, nivel socioeconómico, consumo del alcohol, ritmo cardiaco, nivel de colesterol, etcétera.</p>
<p>Dichas variables pueden usarse como <strong>covariables</strong> (variables explicativas, factores de riesgo, variables independientes) en un modelo que explique la variable respuesta. Así, después de ajustar las covariables, la comparación de tiempos de supervivencia entre grupos deberá tener menos sesgo y ser más precisa que la simple comparación de tiempos de supervivencia.</p>
<p>Otro problema a resolver será predecir la distribución del tiempo de ocurrencia de cierto evento a partir de un conjunto de covariables.</p>
<p>Los datos estarán dados de la siguiente forma: <span class="math inline">\((t_i, \delta_i,x_i)\)</span> con <span class="math inline">\(i = 1,...n\)</span>, donde:</p>
<ul>
<li>
<span class="math inline">\(i\)</span>: individuos.</li>
<li>
<span class="math inline">\(t_i\)</span>: tiempo de falla o censura.</li>
<li>
<span class="math inline">\(\delta_i\)</span>: indicador de falla o censura.</li>
<li>
<span class="math inline">\(x_i\)</span>: conjunto de covariables.</li>
</ul>
<p>Nota:</p>
<ul>
<li>
<span class="math inline">\(X_i =(X_{i1}, X_{i2}, ..., X_{ip})\)</span>; donde <span class="math inline">\(p\)</span>= número de covariables.</li>
<li>
<span class="math inline">\(X_i\)</span> puede depender del tiempo, es decir, <span class="math inline">\(X_{ik}\)</span> es una v.a que cambia en el tiempo (peso, colesterol, etc.).</li>
</ul>
<p>Sea <span class="math inline">\(h_i(t|X_i)\)</span> la función de riesgo al tiempo <span class="math inline">\(t\)</span> del individuo <span class="math inline">\(i\)</span> dadas las covariables <span class="math inline">\(X_i\)</span> (vector de riesgo). El <strong>modelo</strong> propuesto por Cox (1972) es:</p>
<p><span class="math display">\[
h_i(t) = \varphi(X_i ;\theta)\cdot h_0(t)
\]</span>
Donde:</p>
<ul>
<li>
<span class="math inline">\(\theta=(\theta_1,..., \theta_p)\)</span> es el vector de <span class="math inline">\(p\)</span> parámetros asociados a las covariables (coeficientes de regresión).</li>
<li>
<span class="math inline">\(\varphi(\cdot,\cdot)\)</span> es la <em>función liga</em> de las covariables con el tiempo t.</li>
<li>
<span class="math inline">\(h_{0}(t)\)</span> es la función de riesgo <em>base</em>.</li>
</ul>
<p>La función <span class="math inline">\(\varphi(\cdot,\cdot)\)</span> debe satisfacer que <span class="math inline">\(\varphi(0,\theta) =1\)</span>, esto para que, en ausencia de covariables, se tenga que <span class="math inline">\(h_i(t) = h_0(t)\)</span>.</p>
<p>La forma más común de <span class="math inline">\(\varphi(X_i, \theta)\)</span> es <span class="math inline">\(\varphi(X_i, \theta) = e^{X_i^{'} \theta}\)</span> (Supone que <span class="math inline">\(X_i\)</span> no tiene intercepto), entonces:</p>
<p><span class="math display">\[
h_i(t) = e^{X_i^{'} \theta}\cdot h_0(t)
\]</span></p>
<p>Si aplicamos <em>logaritmo</em> tenemos que:</p>
<p><span class="math display">\[
\ln(h_i(t)) = X_i^{'}\theta + \ln(h_0(t))
\]</span></p>
<p><span class="math display" id="eq:cox-covariables-linear">\[\begin{equation}
\Longrightarrow X_i^{'}\cdot\theta = ln \left({\frac{h_i(t)}{h_0(t)}}\right)
\tag{10.1}
\end{equation}\]</span></p>
<p>Es decir, el cociente de la función de riesgo del individuo <span class="math inline">\(i\)</span> con respecto al riesgo base será igual a una forma lineal de las covariables.</p>
<p>El nombre de riesgos proporcionales se deriva del cociente de las funciones de riesgo de dos individuos:</p>
<p><span class="math display">\[
\frac{h_i(t)}{h_j(t)} = \frac{e^{X_i^{'} \theta}\cdot h_0(t)}{e^{X_j^{'} \theta} \cdot h_0(t)} = e^{(X_i-X_j)' \theta}
\]</span></p>
<p>A la expresión anterior se le conoce como <strong>riesgo relativo</strong> y es constante en el tiempo, cuyo valor depende simplemente de la diferencia entre valores de las covariables de los dos individuos<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;No hay dependencia con el tiempo.&lt;/p&gt;"><sup>14</sup></a>.</p>
<p>Si <span class="math inline">\(X_{1i} = 1\)</span> y <span class="math inline">\(X_{1j} = 0\)</span>, representan tratamiento y placebo respectivamente, y si todas las demás covariables se mantienen constantes, entonces <span class="math inline">\(e^{\theta_1}\)</span> es el riesgo de que se presente la falla con el tratamiento relativo a que se presente la falla con el placebo.</p>
<p><span class="math display">\[\frac{h_i(t)}{h_j(t)} = e^{\theta_1}\]</span>
Bajo el modelo de riesgos proporcionales, las funciones de supervivencia y densidad del individuo <span class="math inline">\(i\)</span> son:
<span class="math display">\[S_i(t)=\{S_0(t)\}^{exp(X_i'\theta)}\]</span>
<span class="math display">\[f_i(t)=e^{(X_i'\theta)}h_0(t)\{S_0(t)\}^{exp(X_i'\theta)}\]</span></p>
<p>donde <span class="math inline">\(S_0(t)=exp\{-H_0(t)\}\)</span> es la función de supervivencia base y <span class="math inline">\(H_0(t)\)</span> la función de riesgo acumulado base.
Una consecuencia del supuesto de proporcionalidad entre los riesgos de dos individuos <span class="math inline">\(i,j\)</span> con covariables <span class="math inline">\(X_i,X_j\)</span> es que las funciones de riesgo y supervivencia <strong>no se intersectan</strong>.</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;"></div>
<p><strong>NOTA</strong>: Si <span class="math inline">\(S_0(t)\)</span> es miembro de una familia paramétrica, por lo general, <span class="math inline">\(S_i(t)\)</span> no es miembro de la misma familia. Véase los siguientes ejemplos</p>
<ul>
<li><p>Riesgo base Weibull: <span class="math inline">\(h_0(t) = \lambda\alpha t^{\alpha-1}\)</span>
<span class="math display">\[
\begin{array}{cc}
\implies h_i(t) = \lambda \alpha t^{\alpha-1}e^{X_i^{'}\theta} = \lambda e^{X_i^{'}\theta}\alpha t^{\alpha-1}&amp;\therefore h_i\sim Weibull(\alpha, \lambda e^{X_i^{'}\theta})
\end{array}
\]</span></p></li>
<li><p>Riesgo base log-logistico: <span class="math inline">\(h_0(t) = \frac{\alpha \lambda t^{\alpha-1}}{(1+\lambda t^{\alpha})}\)</span>
<span class="math display">\[
\implies h_i(t) = \frac{e^{Xi^{'}\theta}\alpha t^{\alpha -1}}{(1+\lambda t^{\alpha})}
\]</span></p></li>
<li><p>Riesgo base Gamma: <span class="math inline">\(S_0(t) = 1-lg(\lambda t, \beta)\)</span>
<span class="math display">\[
S_i(t) = \{S_0(t)\}^{e^{X_i^{'}\theta}} = \left(1-lg(\lambda t, \beta)\right)^{e^{X_i^{'}\theta}}
\]</span></p></li>
</ul>
<div id="inferencia-sobre-theta" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Inferencia sobre <span class="math inline">\(\theta\)</span><a class="anchor" aria-label="anchor" href="#inferencia-sobre-theta"><i class="fas fa-link"></i></a>
</h2>
<p>La inferencia para los modelos de riesgos proporcionales paramétricos se hacen por máxima verosimiliutd.</p>
<p>Sea <span class="math inline">\((t_i, \delta_i, X_i)\)</span></p>
<ul>
<li>i : individuos.</li>
<li>
<span class="math inline">\(t_i\)</span>: tiempo de fallo o censura.</li>
<li>
<span class="math inline">\(\delta_i\)</span>: Indicador de fallo o censura.</li>
<li>
<span class="math inline">\(X_i\)</span>: Covariables.</li>
</ul>
<p>Sean <span class="math inline">\(h_0(t|\alpha, \lambda)\)</span> y <span class="math inline">\(S_0(t|\alpha, \lambda)\)</span> funciones de riesgo y supervivencia base.</p>
<p>Entonces la función de verosimilitud para <span class="math inline">\((\theta, \alpha, \lambda)\)</span> será:</p>
<p><span class="math display">\[
\begin{split}
\mathscr{L}(\theta, \alpha, \lambda) &amp; =\prod_{i = 1}^{n}\{f_i(t)\}^{\delta_{i}}\{S_i(t)\}^{1-\delta_{i}}\\
 &amp; =\prod_{i = 1}^{n}\left\{e^{X_i^{'}\theta}h_0(t)S_0(t)^{e^{X_i^{'}\theta}}\right\}^{\delta_{i}}\left\{S_0(t)^{e^{X_i^{'}\theta}}\right\}^{1-\delta_i}\\
 &amp; =\prod_{i = 1}^{n}\left\{e^{X_i^{'}\theta}h_0(t)\}^{\delta_{i}}\{S_0(t)^{e^{X_i^{'}\theta}}\right\}
\end{split}
\]</span></p>
<ul>
<li>Los estimadores máximo verosímil se obtienen numéricamente.</li>
<li>La forma explicita de <span class="math inline">\(\mathscr{L}(\theta, \alpha, \lambda)\)</span> dependerá de la elección de <span class="math inline">\(h_0\)</span>.</li>
<li>Inferencia para los parámetros más allá de la estimación puntual se basa en los resultados asintóticos.</li>
</ul>
</div>
<div id="estimación-semiparamétrica-verosimilitud-parcial." class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Estimación Semiparamétrica (Verosimilitud parcial).<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-semiparam%C3%A9trica-verosimilitud-parcial."><i class="fas fa-link"></i></a>
</h2>
<p>El modelo de riesgos proporcionales semiparamétrico surge cuando la función de riesgo base <span class="math inline">\(h_0(t)\)</span> se considera como una parámetro desconocido, y en este caso es necesario hacer inferencia para <span class="math inline">\(\theta\)</span> y <span class="math inline">\(h_0(t)\)</span>. El parámetro de interés más importante del modelo es <span class="math inline">\(\theta\)</span> y entonces <span class="math inline">\(h_0(t)\)</span> es considerado un parámetro de ruido.</p>
<p>Supongamos que los datos consisten en el vector de observaciones <span class="math inline">\(T = (T_1, ..., T_n)\)</span> de la densidad <span class="math inline">\(f(t|\theta,\eta)\)</span> donde <span class="math inline">\(\theta\)</span> es el vector de parámetros de interés y <span class="math inline">\(\eta\)</span> es parámetro de ruido.</p>
<p>Sean <span class="math inline">\(t_{(1)}&lt;t_{(2)}&lt;...&lt;t_{(D)}\)</span> los tiempos de fallo observados de manera exacta.</p>
<p>Sea <span class="math inline">\(X_{(j)}\)</span> la variable asociada al individuo con tiempo de fallo <span class="math inline">\(t_{(j)}\)</span>.</p>
<p>Definimos <span class="math inline">\(R(t_{(j)})\)</span> como el conjunto de todos los individuos en riesgo justo antes de <span class="math inline">\(t_{(j)}\)</span>.</p>
<p>Entonces la <strong>verosimilitud parcial</strong> para <span class="math inline">\(\theta\)</span> es</p>
<p><span class="math display">\[
_p\mathscr{L}(\theta) = \prod_{j = 1}^{D}\frac{h_{j}(t_{(j)})}{\sum\limits_{i\in R(t_{(j)})}h_{i}(t_{(j)})} = \prod_{j = 1}^{D}\frac{\exp\left(X_{(j)}^{'}\theta\right)}{\sum\limits_{i\in R(t_{(j)})}\exp\left(X_{i}^{'}\theta\right)}
\]</span></p>
<p>OBS :</p>
<ul>
<li>
<span class="math inline">\(_p\mathscr{L}(\theta)\)</span> no depende de <span class="math inline">\(h_0(t)\)</span>
</li>
<li>El numerador depende sólo de la información del individuo que falla.</li>
<li>El denominador usa información de todos los individuos que aún no han experimentado fallo incluyendo censurados.</li>
<li>La verosimilitud parcial se trata como cualquier función de verosimilitud (aplica logaritmo, derivada igual a cero,…)</li>
<li>
<span class="math inline">\(\theta\)</span> es un vector de dimensión <span class="math inline">\(p\implies\)</span> se obtendrán <span class="math inline">\(p\)</span> derivadas parciales. La mayoría de los paquetes usan algoritmos de Newton-Raphson para resolver el sistema de ecuaciones simultaneas.</li>
<li>Pruebas de hipótesis e intervalos de confianza para <span class="math inline">\(\theta\)</span> se pueden obtener con distribución asintótica normal con media <span class="math inline">\(\theta\)</span> y matriz de varianzas y covarianzas.</li>
</ul>
</div>
<div id="estimador-de-breslow-h_0t-y-s_0t" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Estimador de Breslow (<span class="math inline">\(H_{0}(t)\)</span> y <span class="math inline">\(S_{0}(t)\)</span>)<a class="anchor" aria-label="anchor" href="#estimador-de-breslow-h_0t-y-s_0t"><i class="fas fa-link"></i></a>
</h2>
<p>Si la funciones base son también de interés, se puede utilizar el estimador propuesto por Berslow (1974) que es una generalización del estimador de <em>Nelson-Aalen</em>.</p>
<p><span class="math display">\[\hat{H_{0}}(t) = \sum_{i:t_i\leq t}\left \{\frac{\delta_i}{\sum_{j = 1}^nY_j(t_i)e^{X_j^{'}\hat{\theta}}} \right \} = \frac{\mbox{Fallecidos}}{\mbox{Individuos en riesgo}}\]</span>
donde <span class="math inline">\(Y_i(t) = \mathbb{1}_{\{t_i\geq t\}}\)</span> indicadora si <span class="math inline">\(\hat{\theta} = 0\)</span> y <span class="math inline">\(\hat{H_0}(t)\)</span> es el estimador de Nelson-Aalen visto previamente.</p>
<p><span class="math display">\[\therefore \hat{S_0(t)}  = exp\{-\hat{H_0}(t)\} = e^{\sum_{i:t_i\leq t}\left \{\frac{\delta_i}{\sum_{j = 1}^nY_j(t_i)e^{X_j^{'}\hat{\theta}}} \right \}}\]</span></p>
<p><strong>Notas</strong></p>
<ol style="list-style-type: decimal">
<li>En el caso de que se presenten <strong>empates</strong> (múltiples individuos con el mismo tiempo de fallo) la <span class="math inline">\(_p\mathscr{L}(\theta)\)</span> debe ajustarse para que se considere la naturaleza discreta de las observaciones.</li>
<li>El modelo de riesgos proporcionales permite la incorporación de covariables dependientes en el tiempo.</li>
</ol>
<div id="ejemplo-1-2" class="section level4 unnumbered">
<h4>Ejemplo 1<a class="anchor" aria-label="anchor" href="#ejemplo-1-2"><i class="fas fa-link"></i></a>
</h4>
<p>Un estudio sobre la supervivencia clasifica según la raza en: blanco, negro e hispano. Entonces las variable <span class="math inline">\(X_1\)</span> toma los siguientes valores:</p>
<p><span class="math display">\[
\begin{array}{ll}
X_1 = \mbox{1 si es blanco } \\
X_1 = \mbox{2 si es negro } \\
X_1 = \mbox{3 si es hispano} \\
\end{array}
\]</span></p>
<p>Sin embrago, también podría plantearse como dos variables <span class="math inline">\(X_1\)</span> y <span class="math inline">\(X_2\)</span>
<span class="math display">\[
\begin{array}{ll}
X_1 = 1 \mbox{ si es blanco, 0 en otro caso.}\\
X_2 = 1 \mbox{ si es negro, 0 en otro caso}\\
\end{array}
\]</span></p>
<p>Entonces, el modelo de riesgos proporcionales será: <span class="math inline">\(h(t|X) = h_0e^{\beta_1X_1+\beta_2X_2}\)</span></p>
<ul>
<li>Si <span class="math inline">\(h(t|X_1=1, X_2 = 0) = h_0(t)e^{\beta_1}\longrightarrow\)</span> Riesgo de blanco</li>
<li>Si <span class="math inline">\(h(t|X_1=0, X_2 = 1) = h_0(t)e^{\beta_2}\longrightarrow\)</span> Riesgo de negro</li>
<li>Si <span class="math inline">\(h(t|X_1=0, X_2 = 0) = h_0(t)\longrightarrow\)</span> Riesgo de hispano (riesgo base)</li>
</ul>
<p>Riesgos relativos:</p>
<ul>
<li>Entre negro e hispano: <span class="math inline">\(\frac{h(t|X_1 = 0, X_2 = 1)}{h(t|X_1 = 0, X_2 = 0)} = \frac{h_0(t)e^{\beta_2}}{h_{0}(t)}=e^{\beta_2}\)</span>
</li>
</ul>
<p>Es decir, <span class="math inline">\(e^{\beta_2}\)</span> son las veces que el riesgo que tienen los negros en comparación con los hispanos.</p>
<ul>
<li>Se busca que el riesgo relativo sea <span class="math inline">\(\neq1\)</span> para poder decir que la categoría segmenta datos.</li>
</ul>
</div>
<div id="ejemplo-2-2" class="section level4 unnumbered">
<h4>Ejemplo 2<a class="anchor" aria-label="anchor" href="#ejemplo-2-2"><i class="fas fa-link"></i></a>
</h4>
<p>Un estudio con 863 pacientes con trasplante de hígado. Dos de las variable que se recabaron de los pacientes fueron, género y raza. Entonces los pacientes en el estudio se dividieron en las siguientes categorías</p>
<p><span class="math display">\[
\begin{array}{ll}
432 \mbox{ hombres blancos}\\
92 \mbox{ hombres negros}\\
286 \mbox{ mujeres blancas}\\
59 \mbox{ mujeres negras}\\
\end{array}
\]</span></p>
<p>Para ajustar un modelo de riesgos proporcionales a estos datos, una opción es definir 3 covariables:</p>
<p><span class="math display">\[
\begin{array}{ll}
Z_1 = 1 \mbox{ hombre negro, 0.e.o.c}\\
Z_2 = 1 \mbox{ hombre blanco, 0.e.o.c}\\
Z_3 = 1 \mbox{ mujer negra, 0.e.o.c}\\
\end{array}
\]</span>
Y el modelo para la función de riesgo será:
<span class="math display">\[h(t|Z) = h_0(t)exp \{ \theta_1Z_1 + \theta_2Z_2 + \theta_3Z_3\}\]</span></p>
<p>Los estimadores máximo verosímil son <span class="math inline">\(\hat{\theta_1} = 0.160\)</span>, <span class="math inline">\(\hat{\theta_2} = 0.298\)</span>, <span class="math inline">\(\hat{\theta_3} = 0.657\)</span>.</p>
<p>Riesgo relativo de hombre negro con mujer blanca :</p>
<p><span class="math display">\[h(t|Z) = \frac{h_0(t)exp\{0.160\}}{h_0(t)exp\{0\}} = e^{0.160} = 1.17\]</span>
<span class="math inline">\(\therefore\)</span> Los hombres negros son más propensos a morir por trasplante de hígado que las mujeres blancas; es decir, por cada mujer blanca, un hombre negro (1.17) muere en el trasplante.</p>
<p>En el caso de un hombre negro y un hombre blanco</p>
<p><span class="math display">\[h(t|Z) = \frac{h_0(t)exp\{0.160\}}{h_0(t)exp\{0.298\}} = e^{-0.088} = 0.9157609\]</span></p>
<p>Otra opción de plantear el modelo es con 2 covariables y una interacción, y quedaría de la siguiente forma:</p>
<p><span class="math display">\[
\begin{array}{ll}
Z_1 = 1 \mbox{ Si es mujer, 0  e.o.c}\\
Z_2 = 1 \mbox{ Si es negro(a), 0  e.o.c}\\
Z_3 = Z_1\cdot Z_2 \mbox{ Esta variable tomará el valor 1 si es mujer negra, y 0  e.o.c}
\end{array}
\]</span></p>
<p>Y el modelo para la función de riesgo será: <span class="math inline">\(h(t|Z) = h_0exp\{\theta_1Z_1+\theta_2Z_2+\theta_3Z_1Z_2\}\)</span>.</p>
<p>Los estimadores máximo verosímil son
<span class="math inline">\(\hat{\theta_1} = -.2484, \hat{\theta_2} =-.0888, \hat{\theta_3} = .7435\)</span>.
Hay que notar que la interpretación de las <span class="math inline">\(\theta's\)</span> será diferente y en este caso el parámetro de interés será el de la interacción (<span class="math inline">\(\theta_3\)</span>)</p>
<p>Riesgos relativos :</p>
<p><span class="math display">\[\frac{\mbox{Hombre negro}}{\mbox{Mujer blanca}} = \frac{h_0(t)exp\{-0.0888\}}{h_0exp\{-0.2484\}} = e^{-(0.0888+0.2484)} = e^{-.1596} = 1.17\]</span></p>
<p>Véase que es el mismo resultado que se obtuvo en el modelo anterior, por lo que se sigue conservando el mismo riesgo independiente del modelo.</p>
<p><strong>Ejercicios</strong></p>
<ol style="list-style-type: decimal">
<li><p>Calcular el riesgo mujer negra relativo a mujer blanca.</p></li>
<li><p>Calcular el riesgo mujer negra relativo a hombre negro</p></li>
<li><p>Calcular el riesgo hombre blanco relativo a mujer blanca.</p></li>
</ol>
<p><strong>RECORDATORIO: Codificación de variables categóricas</strong>.</p>
<p>Una variable categórica con k clases se transforma en <span class="math inline">\(k-1\)</span> variables binarias.</p>
</div>
<div id="ejemplo-1-3" class="section level4 unnumbered">
<h4>Ejemplo 1<a class="anchor" aria-label="anchor" href="#ejemplo-1-3"><i class="fas fa-link"></i></a>
</h4>
<p>X: Color de cabello {negro, cafe, rojo, blanco}. Tenemos una variable con 4 categorías. Por lo que la transformaremos en 3 variables binarias</p>
<p><span class="math display">\[
\begin{array}{l}
X_1 = \mbox{1 si es negro, 0 e.o.c } \\
X_2 = \mbox{1 si es café. 0 e.o.c } \\
X_3 = \mbox{1 si es rojo, 0.e.o.c} \\
\end{array}
\]</span></p>
<p>Con estas tres variables se cubren todas las opciones de color de cabello.</p>
</div>
</div>
<div id="significancia-de-los-parámetros-prueba-de-wald" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Significancia de los parámetros (Prueba de Wald)<a class="anchor" aria-label="anchor" href="#significancia-de-los-par%C3%A1metros-prueba-de-wald"><i class="fas fa-link"></i></a>
</h2>
<p>¿Son significativos <span class="math inline">\(\hat{\theta_1}, \hat{\theta_2}, \hat{\theta_3}\)</span> en ejemplo numero 2?</p>
<p>Similar al caso de regresión lineal, la significancia de los parámetros radica en la importancia del riesgo proporcionado por las covariables asociadas a parámetros. Y en caso de no ser significativos los parámetros, las covariables se podrían eliminar del modelo.</p>
<p><strong>Prueba de hipótesis:</strong> Nos interesa hacer pruebas sobre <span class="math inline">\(\theta\)</span>, de manera general:</p>
<p><span class="math display">\[H_0:\theta_1 = \theta_{H_0}\mbox{ vs }H_1:\theta_1\neq \theta_{H_0}\]</span>
donde <span class="math inline">\(\theta = (\theta_1^t, \theta_2^t) = (\theta_1, \theta_2, ..., \theta_p)\)</span></p>
<ul>
<li>
<span class="math inline">\(\theta_1:\)</span> Es el vector de <span class="math inline">\(q*1\)</span> (<span class="math inline">\(q\)</span> parámetros de interés)</li>
<li>
<span class="math inline">\(\theta_2:\)</span> Los parámetros restantes (<span class="math inline">\(p-q\)</span>)</li>
</ul>
<p>Partimos la matriz de información : <span class="math inline">\(I = \begin{pmatrix}I_{11} &amp; I_{12} \\ I_{21} &amp; I_{22}\end{pmatrix}\)</span></p>
<p>Donde <span class="math inline">\(I_{11}\)</span>, <span class="math inline">\(I_{22}\)</span> segundas derivadas de la función de verosimilitud.</p>
<p>La <strong>Prueba de Wald</strong> se define como:</p>
<p><span class="math display">\[
X_w^2 =(\hat{\theta_1}-\hat{\theta_{H_0}})^{'}[I^{*}(\theta)]^{-1}(\hat{\theta_1}-\hat{\theta_{H_0}})
\]</span></p>
<p>Donde <span class="math inline">\(I^{*}(\theta)\)</span> es la matriz <span class="math inline">\(q*q\)</span> superior de <span class="math inline">\(I\)</span>.</p>
<ul>
<li><p>Para muestras grandes, la estadística de prueba: <span class="math inline">\(X_w^2\sim\chi_{(q)}^2\)</span></p></li>
<li><p>Un criterio de información es el proporcionado por el criterio de Aikaike (<span class="math inline">\(ACI\)</span>):</p></li>
</ul>
<p><span class="math display">\[AIC  = -2log{\mathscr{L}}+kp\]</span></p>
<ul>
<li>
<span class="math inline">\(\mathscr{L}\)</span>: Función de verosimilitud.</li>
<li>
<span class="math inline">\(k\)</span>: Cte.(usualmente igual a 2).</li>
<li>
<span class="math inline">\(p\)</span>: # de parámetros en el modelo.</li>
</ul>
<p>Para la construcción del modelo usando el modelo de riesgos proporcionales de Cox, se puede usar el estadístico de Wald para seleccionar covariables significativas<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Recordar que por la ecuación &lt;a href="modelo-de-riesgos-proporcionales.html#eq:cox-covariables-linear"&gt;(10.1)&lt;/a&gt;, el modelo esta asumiendo una forma lineal de las covariables.&lt;/p&gt;'><sup>15</sup></a> y considerando el valor del AIC para evaluar la mejora en el modelo<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Para un mayor número de variables el &lt;span class="math inline"&gt;\(AIC\uparrow\)&lt;/span&gt; pero para variables más significativas &lt;span class="math inline"&gt;\(AIC\downarrow\)&lt;/span&gt;.&lt;/p&gt;'><sup>16</sup></a>.</p>
</div>
<div id="estimación-de-st-después-de-obtener-las-estimaciones-de-los-parámetros-del-modelo-de-cox" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Estimación de <span class="math inline">\(S(t)\)</span> después de obtener las estimaciones de los parámetros del modelo de Cox<a class="anchor" aria-label="anchor" href="#estimaci%C3%B3n-de-st-despu%C3%A9s-de-obtener-las-estimaciones-de-los-par%C3%A1metros-del-modelo-de-cox"><i class="fas fa-link"></i></a>
</h2>
<p>Hasta el momento se han dado estimadores para <span class="math inline">\(\theta\)</span> y pruebas sobre dicho parámetro; es decir, teniendo el modelo de riesgos proporcionales <span class="math inline">\(h(t|X) = h_0(t)e^{X^{'}\theta}\)</span> y ajustando dicho modelo a nuestros datos obtenemos <span class="math inline">\(\hat{\theta}\)</span>. Ahora lo que se desea es la función de supervivencia con el conjunto de covariables <span class="math inline">\(X_i\)</span>.Para ello sea <span class="math inline">\(t_1&lt;t_2, \dots&lt;t_D\)</span> todos los tiempos de falla y <span class="math inline">\(d_i\)</span> el número de fallas del tiempo <span class="math inline">\(t_i\)</span>. Entonces</p>
<p><span class="math display">\[
\omega(t_i, \hat{\theta}) = \sum_{j\in R(t_i)}\exp\left\{\sum_{h=1}^D\hat{\theta}_hX_{jh}\right\}
\]</span></p>
<p>Y el estimador de la función de riesgo acumulado base será la siguiente, la cual es una función escalonada a cada tiempo de falla.</p>
<p><span class="math display">\[
\hat{H_0}(t) = \sum_{t_i\leq t}\frac{d_i}{w(t_i, \hat{\theta})}
\]</span></p>
<p>Por lo que un estimador de la función de supervivencia base será el siguiente, el cual corresponde a los individuos cuyas covariables <span class="math inline">\(X\)</span> son ceros.</p>
<p><span class="math display">\[
\hat{S}_0(t) = \exp\{-\hat{H}_0(t)\}
\]</span></p>
<p>Para estimar la función de supervivencia para un individuo con covariables <span class="math inline">\(X^{*}\)</span> se utilizará el siguiente estimador</p>
<p><span class="math display">\[
\hat{S}(t|X^{*})=\hat{S}_0(t)\exp\left\{\hat{\theta^{'}}X^{*}\right\}
\]</span>
La siguiente gráfica es un ejemplo comparativo de dos estimaciones de funciones de supervivencia, una con el método de Kaplan-Meier y Cox.</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
<div id="verificación-de-ajuste-de-modelo" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Verificación de ajuste de Modelo<a class="anchor" aria-label="anchor" href="#verificaci%C3%B3n-de-ajuste-de-modelo"><i class="fas fa-link"></i></a>
</h2>
<p>Mediante gráficos de las funciones de supervivencia buscamos las funciones de supervivencia para los distintos valores de <span class="math inline">\(X\)</span>’s donde <strong>no</strong> se crucen<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Por el hecho de que se busca &lt;strong&gt;proporcionalidad&lt;/strong&gt; y, por lo tanto, que la segregación separe completamente a la población.&lt;/p&gt;"><sup>17</sup></a>.</p>
<p>En caso de que el modelo de Cox no cumpla con el supuesto de proporcionalidad se puede corregir el modelo mediante:</p>
<ol style="list-style-type: decimal">
<li><p>Agregar más covariables</p></li>
<li><p>Considerar interacciones entre las covariables</p></li>
<li><p>Introducir términos no lineales</p></li>
<li><p>Permitir que las covariables dependan del tiempo</p></li>
</ol>
</div>
<div id="extensión-del-modelo-de-cox-a-covariables-dependientes-del-tiempo" class="section level2" number="10.7">
<h2>
<span class="header-section-number">10.7</span> Extensión del modelo de Cox a covariables dependientes del tiempo<a class="anchor" aria-label="anchor" href="#extensi%C3%B3n-del-modelo-de-cox-a-covariables-dependientes-del-tiempo"><i class="fas fa-link"></i></a>
</h2>
<p>Sea <span class="math inline">\(X(t)=[X_1(t),...,X_p(t)]\)</span> es el conjunto de covariables o factores de riesgo al tiempo <span class="math inline">\(t\)</span> que podrían afectar la distribución de la variable de supervivencia.</p>
<p>Entonces <span class="math inline">\(X_k(t)\)</span>´s son covariables dependientes del tiempo cuyos valores cambian o permanecen constantes (como el caso anterior). Supondremos que los valores de estas covariables son predecibles (el valor es conocido).</p>
<p>Ejemplos de este tipo de variables son presión arterial, colesterol, tamaño del tumor, etc.</p>
<p>Sustituyendo en el modelo de Cox tenemos:</p>
<p><span class="math display">\[
\begin{split}
h(t|X(t))=&amp;h_0 (t)\cdot exp\{\beta^`\cdot Z(t )\}\\
=&amp;h_0(t) \cdot exp \left\{ \sum_{k=1}^{p} \beta_k \cdot Z(t)  \right\}
\end{split}
\]</span></p>
<p>Entonces para probar el supuesto de riesgos proporcionales se crea una variable artificial:</p>
<p><span class="math display">\[
X_2(t)= X_1 \cdot g(t) 
\]</span></p>
<p>donde <span class="math inline">\(X_1\)</span> es una variable fija en el tiempo <span class="math inline">\(g(t)\)</span> es una función que depende del tiempo usualmente</p>
<p><span class="math display">\[
g(t)= ln (t ) 
\]</span>
y se ajusta un modelo de Cox para las covariables <span class="math inline">\(X_1\)</span> y <span class="math inline">\(X_2(t)\)</span>, tenemos</p>
<p><span class="math display">\[  
\begin{split}
h(t|X(t)) &amp;= h_0 \cdot exp \{ \beta_1 X_1 +\beta_2X_2(t) \}\\
&amp;=h_0(t) \cdot exp \{ \beta_1 X_1+\beta_2 X_1\cdot g(t) \}
\end{split}
\]</span>
y se realiza la prueba de hipótesis para <span class="math inline">\(\beta_2=0\)</span>. Si se desea evaluar riesgos proporcionales para 2 individuos con diferentes valores de <span class="math inline">\(X_1\)</span></p>
<p><span class="math display">\[
\frac{h(t|X_1)}{h(t|X_1^*)}= exp \{ \beta_1 (X_1-X_1^*)+\beta_2\cdot g(t)(X_1-X_1^*) \}
\]</span></p>
<p>la cuál dependerá del tiempo si <span class="math inline">\(\beta_2 \ne 0\)</span>.</p>

<div id="refs" class="references hanging-indent">
<div id="ref-collett2015modelling">
<p>Collett, David. 2015. <em>Modelling Survival Data in Medical Research</em>. CRC press.</p>
</div>
<div id="ref-hall1980confidence">
<p>Hall, Wendy J, and Jon A Wellner. 1980. “Confidence Bands for a Survival Curve from Censored Data.” <em>Biometrika</em> 67 (1): 133–43.</p>
</div>
<div id="ref-klein2006survival">
<p>Klein, John P, and Melvin L Moeschberger. 2006. <em>Survival Analysis: Techniques for Censored and Truncated Data</em>. Second. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-nair1984confidence">
<p>Nair, Vijayan N. 1984. “Confidence Bands for Survival Functions with Censored Data: A Comparative Study.” <em>Technometrics</em> 26 (3): 265–75.</p>
</div>
</div>
</div>
</div>
























  <div class="chapter-nav">
<div class="prev"><a href="pruebas-de-hip%C3%B3tesis.html"><span class="header-section-number">9</span> Pruebas de Hipótesis</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelo-de-riesgos-proporcionales"><span class="header-section-number">10</span> Modelo de Riesgos Proporcionales</a></li>
<li><a class="nav-link" href="#inferencia-sobre-theta"><span class="header-section-number">10.1</span> Inferencia sobre \(\theta\)</a></li>
<li><a class="nav-link" href="#estimaci%C3%B3n-semiparam%C3%A9trica-verosimilitud-parcial."><span class="header-section-number">10.2</span> Estimación Semiparamétrica (Verosimilitud parcial).</a></li>
<li><a class="nav-link" href="#estimador-de-breslow-h_0t-y-s_0t"><span class="header-section-number">10.3</span> Estimador de Breslow (\(H_{0}(t)\) y \(S_{0}(t)\))</a></li>
<li><a class="nav-link" href="#significancia-de-los-par%C3%A1metros-prueba-de-wald"><span class="header-section-number">10.4</span> Significancia de los parámetros (Prueba de Wald)</a></li>
<li><a class="nav-link" href="#estimaci%C3%B3n-de-st-despu%C3%A9s-de-obtener-las-estimaciones-de-los-par%C3%A1metros-del-modelo-de-cox"><span class="header-section-number">10.5</span> Estimación de \(S(t)\) después de obtener las estimaciones de los parámetros del modelo de Cox</a></li>
<li><a class="nav-link" href="#verificaci%C3%B3n-de-ajuste-de-modelo"><span class="header-section-number">10.6</span> Verificación de ajuste de Modelo</a></li>
<li><a class="nav-link" href="#extensi%C3%B3n-del-modelo-de-cox-a-covariables-dependientes-del-tiempo"><span class="header-section-number">10.7</span> Extensión del modelo de Cox a covariables dependientes del tiempo</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/blob/master/10_Proportional_risks.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/edit/master/10_Proportional_risks.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Modelos de Supervivencia</strong>" was written by Sofía Villers Gómez, Carlos Fernando Vásquez Guerra, Luis Angel Ramirez Teodoro. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
