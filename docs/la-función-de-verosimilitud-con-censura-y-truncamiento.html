<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento | Modelos de Supervivencia</title>
<meta name="author" content="Sofía Villers Gómez">
<meta name="author" content="Carlos Fernando Vásquez Guerra">
<meta name="author" content="Luis Angel Ramirez Teodoro">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.4/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet">
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet">
<script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="styles.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Modelos de Supervivencia</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefacio</a></li>
<li class="book-part">Todo es cuestion de tiempo</li>
<li><a class="" href="motivaci%C3%B3n.html">Motivación</a></li>
<li><a class="" href="an%C3%A1lisis-de-supervivencia.html">Análisis de Supervivencia</a></li>
<li><a class="" href="datos-censurados.html"><span class="header-section-number">1</span> Datos Censurados</a></li>
<li><a class="" href="datos-truncados.html"><span class="header-section-number">2</span> Datos Truncados</a></li>
<li class="book-part">Estudio paramétrico</li>
<li><a class="" href="funciones-para-el-an%C3%A1lisis-de-supervivencia.html"><span class="header-section-number">3</span> Funciones para el Análisis de Supervivencia</a></li>
<li><a class="" href="par-poblacionales.html"><span class="header-section-number">4</span> Parámetros Poblacionales</a></li>
<li><a class="" href="modelos-param%C3%A9tricos.html"><span class="header-section-number">5</span> Modelos Paramétricos</a></li>
<li><a class="active" href="la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento.html"><span class="header-section-number">6</span> La Función de Verosimilitud con Censura y Truncamiento</a></li>
<li class="book-part">Estudio no paramétrico</li>
<li><a class="" href="modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia.html"><span class="header-section-number">7</span> Modelos No Paramétricos para la Función de Supervivencia</a></li>
<li><a class="" href="algunas-estimaciones-sobre-modelos-no-param%C3%A9tricos.html"><span class="header-section-number">8</span> Algunas Estimaciones sobre Modelos No Paramétricos</a></li>
<li><a class="" href="pruebas-de-hip%C3%B3tesis.html"><span class="header-section-number">9</span> Pruebas de Hipótesis</a></li>
<li class="book-part">Lleno de riesgos</li>
<li><a class="" href="modelo-de-riesgos-proporcionales.html"><span class="header-section-number">10</span> Modelo de Riesgos Proporcionales</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="la-función-de-verosimilitud-con-censura-y-truncamiento" class="section level1" number="6">
<h1>
<span class="header-section-number">Capítulo 6</span> La Función de Verosimilitud con Censura y Truncamiento<a class="anchor" aria-label="anchor" href="#la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento"><i class="fas fa-link"></i></a>
</h1>
<p>Cuando se conoce la distribución de <span class="math inline">\(T\)</span>, hacer estimaciones (usualmente por el método de máxima verosimilitud) sobre parámetros poblacionales resulta de suma importancia, pues a partir de ellos no sólo podemos conocer <em>estimadores</em> de la media, varianza o cuantiles; sino que también podemos conocer <span class="math inline">\(\hat S(t)\)</span>, <span class="math inline">\(\hat h(t)\)</span>, etc. En la sección anterior revisamos los modelos paramétricos más usados en análisis de supervivencia, sin embargo, no contemplamos datos censurados o truncados en dichos modelos. En este apartado veremos la función de verosimilitud considerando censura y truncamiento, y con base en esta función haremos estimaciones para algunas distribuciones.</p>
<div id="caso-general" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Caso General<a class="anchor" aria-label="anchor" href="#caso-general"><i class="fas fa-link"></i></a>
</h2>
<p>De acuerdo al tipo de observación, se tienen las siguientes contribuciones a la función de verosimilitud:</p>
<p><span class="math display">\[
\begin{array}{ll}
\mbox{Exactas } T_{i} &amp; f(t_{i})\\
\mbox{Censurada por la derecha } T_{i}&gt;C_{i} &amp; \mathbb{P}(T_{i}&gt;C_{i})=S(C_{i})\\
\mbox{Censurada por la izquierda } T_{i}&lt;C_{i} &amp; \mathbb{P}(T_{i}&lt;C_{i})=1-S(C_{i})\\
\mbox{Censurada por la intervalo } L_{i}&lt;T_{i}\leq R_{i} &amp; \mathbb{P}(L_{i}&lt;T_{i}\leq R_{i})=S(L_{i})-S(R_{i})\\
\mbox{Truncado por la izquierda } T_{i}|T_{i}&gt;u_{i} &amp; \mathbb{P}(T_{i}|T_{i}&gt;u_{i})=\frac{f(t_{i})}{S(u_{i})}\\
\mbox{Truncado por la derecha } T_{i}|T_{i} \leq v_{i} &amp; \mathbb{P}(T_{i}|T_{i} \leq v_{i})=\frac{f(t_{i})}{1-S(v_{i})}\\
\end{array}
\]</span></p>
<p>Entonces la función de verosimilitud es:</p>
<p><span class="math display">\[
\mathbf{\mathscr{L}} = \prod_{i\in D}f(t_{i})\prod_{i\in R}S(C_{i})\prod_{i\in L}(1-S(C_{i}))\prod_{i\in I}[S(L_{i})-S(R_{i})]
\]</span>
donde</p>
<ul>
<li>D: Conjunto de tiempos de fallo.</li>
<li>R: Conjunto de observaciones censuradas por la derecha.</li>
<li>L: Conjunto de observaciones censuradas por la izquierda.</li>
<li>I: Conjunto de observaciones censuradas por intervalo.</li>
</ul>
<p>Cuando hay datos truncados, se sustituye <span class="math inline">\(f(t_{i})\)</span> por <span class="math inline">\(\frac{f(t_{i})}{S(u_{i})}\)</span> y <span class="math inline">\(S(C_{i})\)</span> por <span class="math inline">\(\frac{S(C_{i})}{S(_{u_{i}})}\)</span>.</p>
</div>
<div id="censura-por-la-derecha-tipo-i-1" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Censura por la Derecha Tipo I<a class="anchor" aria-label="anchor" href="#censura-por-la-derecha-tipo-i-1"><i class="fas fa-link"></i></a>
</h2>
<p>Suponga que se tiene una muestra aleatoria de <span class="math inline">\(n\)</span> individuos con tiempos de vida <span class="math inline">\(T_1,T_2,..., T_n\)</span>(v.a.i.i.d) y que está asociado a cada individuo un tiempo fijo de censura <span class="math inline">\(C_i&gt;0\)</span>. Se observa a <span class="math inline">\(T_i\)</span> solamente si <span class="math inline">\(T_i\leq C_i\)</span>, por lo que los datos son parejas: <span class="math inline">\((t_i,\delta_i)\)</span>, <span class="math inline">\(i=1,2,...,n\)</span> donde <span class="math inline">\(t_i=min(T_i,C_i)\)</span> y:</p>
<p><span class="math display">\[
\delta_{i} = \left\{
\begin{array}{ll}
0 &amp; \mbox{si }  t_{i} \ = \ C_i\\
1 &amp; \mbox{si }  t_{i} \ =\ T_i
\end{array}
\right.
\]</span></p>
<p>Entonces la función de verosimilitud para datos con este tipo de censura es de la forma:</p>
<p><span class="math display">\[ 
\mathscr{L} = \prod^{n}_{i=1}f(t_{i})^{\delta_{i}}S(t_{i})^{1-\delta_{i}} 
\]</span></p>
<p>donde <span class="math inline">\(\sum_{i=1}^{n}\delta_i\)</span> representa el total de los tiempos de vida observados.</p>
<p>Considerando que <span class="math inline">\(f(t) = h(t) S(t)\)</span>, entonces:</p>
<p><span class="math display">\[
\begin{split}
\mathscr{L} &amp; =\prod_{i = 1}^{n}h(t_{i})^{\delta_{i}}S(t_{i})^{\delta_{i}}S(t_{i})^{1-\delta_{i}}\\
 &amp; =\prod_{i = 1}^{n}h(t_{i})^{\delta_{i}}S(t_{i})\\
 &amp; =\prod_{i = 1}^{n}h(t_{i})^{\delta_{i}}exp\{-H(t_{i})\}
\end{split}
\]</span></p>
</div>
<div id="censura-por-la-derecha-tipo-ii-1" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Censura por la Derecha Tipo II<a class="anchor" aria-label="anchor" href="#censura-por-la-derecha-tipo-ii-1"><i class="fas fa-link"></i></a>
</h2>
<p>Supongamos que se observan los <span class="math inline">\(r\)</span> tiempos de falla <span class="math inline">\(T_{(1)}&lt; T_{(2)}&lt; ...&lt;T_{(r)}\)</span> más pequeños, dejando a <span class="math inline">\(n-r\)</span> tiempos censurados por la derecha, de una muestra de tamaño <span class="math inline">\(n\)</span>. De modo que, los datos serán los <span class="math inline">\(r\)</span> tiempos de fallo más pequeños de <span class="math inline">\(T_{1}, T_{2},...,T_{n}\)</span>.</p>
<p><span class="math inline">\(T\)</span> tiene f.d.p <span class="math inline">\(f(t)\)</span> y función de supervivencia <span class="math inline">\(S(t)\)</span>. Entonces la f.d.p. conjunta de <span class="math inline">\(T_{(1)}, T_{(2)}, ...,T_{(r)}\)</span> es:</p>
<p><span class="math display">\[
\mathscr{L} = \frac{n!}{(n-r)!}\left\{\prod_{i=1}^{r}f(t_{i})\right\}\left[S\left(t_{(r)}\right)\right]^{n-r}
\]</span></p>
<p>donde <span class="math inline">\(\prod_{i=1}^{r}f(t_{i})\)</span> es la parte correspondiente a las <span class="math inline">\(r\)</span> fallas observadas y <span class="math inline">\([S(t_{(r)})]^{n-r}\)</span> constituye la aportación de las observaciones censuradas después de la <span class="math inline">\(r-esima\)</span> falla observada.</p>
<p>Observemos que si quitamos el término constante <span class="math inline">\(\frac{n!}{(n-r)!}\)</span> y definiendo a la función indicadora:</p>
<p><span class="math display">\[
\delta_{i} = \left\{
\begin{array}{ll}
0 &amp; \mbox{si  } T_{i} \ &gt; \ T_{(r)}\\
1 &amp; \mbox{si }  T_{i}  \leq\ T_{(r)}
\end{array}
\right.
\]</span></p>
<p>Entonces la función de verosimilitud para este tipo de censura se puede reesctibir:</p>
<p><span class="math display">\[ 
\mathscr{L} \propto \prod^{n}_{i=1}f(t_{i})^{\delta_{i}}S(t_{i})^{1-\delta_{i}} 
\]</span></p>
<p>que es la función de verosimilitud con datos censurados por la derecha tipo 1 revisada en la sección anterior.</p>
</div>
<div id="censura-aleatoria" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Censura Aleatoria<a class="anchor" aria-label="anchor" href="#censura-aleatoria"><i class="fas fa-link"></i></a>
</h2>
<p>Supongamos que para cada individuo se tienen <span class="math inline">\(T_i\)</span> y <span class="math inline">\(C_i\)</span> variables aleatorias independientes, con funciones de densidad <span class="math inline">\(f_{T}(t)\)</span> y <span class="math inline">\(f_{C}(t)\)</span>, y con funciones de superviviencia <span class="math inline">\(S_{T}(t)\)</span> y <span class="math inline">\(S_{C}(t)\)</span> respectivamente. Sean <span class="math inline">\((T_i,C_i)\)</span>, <span class="math inline">\(i=1,2,...,n\)</span> parejas de observaciones independientes, la variable que observamos es <span class="math inline">\(t_i=min(T_i,C_i)\)</span> y se define:</p>
<p><span class="math display">\[
\delta_{i} = \left\{
\begin{array}{ll}
0 &amp; \mbox{si  } T_{i} \ &gt; \ C_i\\
1 &amp; \mbox{si }  T_{i}  \leq\ C_i
\end{array}
\right.
\]</span></p>
<p>por lo que, las observaciones son las parejas <span class="math inline">\((t_i,\delta_i)\)</span> con <span class="math inline">\(i=1,2,...,n\)</span>.</p>
<p>La función de verosimilitud es entonces:</p>
<p><span class="math display">\[ 
\mathscr{L} = \prod^{n}_{i=1}[S_C(t_{i})]^{1-\delta_{i}}[f_C(t_i)]^{\delta_i}[f_T(t_i)]^{\delta_i}[S_T(t_{i})]^{1-\delta_{i}} 
\]</span></p>
<p>Similar al caso se censura por la derecha tipo 2, se puede demostrar que la expresión anterior es proporcional a <span class="math inline">\(\prod^{n}_{i=1}f_T(t_{i})^{\delta_{i}}S_T(t_{i})^{1-\delta_{i}}\)</span>.</p>
</div>
<div id="truncamiento-por-la-izquierda" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> Truncamiento por la Izquierda<a class="anchor" aria-label="anchor" href="#truncamiento-por-la-izquierda"><i class="fas fa-link"></i></a>
</h2>
<p>Consideremos los tiempos de fallo truncados por la izquierda, es decir, <span class="math inline">\(T_{i}\)</span> tal que <span class="math inline">\(T_{i}\geq u_{i}\)</span> para ser observado (<span class="math inline">\(u_{i}\)</span> es el valor de truncamiento).</p>
<p>En este caso, las observaciones serán <span class="math inline">\((u_{i}, t_{i},\delta_{i})\)</span> con <span class="math inline">\(t_{i}\geq u_{i}\)</span> tiempo de fallo y <span class="math inline">\(\delta_{i}\)</span> indicador de censura por la derecha. Por lo que:</p>
<p><span class="math display">\[
\mathbf{\mathscr{L}} = \prod_{i=1}^{n}\left\{\frac{f(t_{i})}{S(u_{i})}\right\}^{\delta_{i}}\left\{\frac{S(t_{i})}{S(u_{i})}\right\}^{1-\delta_{i}}=\prod_{i=1}^{n}\left\{h(t_{i})\right\}^{\delta_{i}}\left\{\frac{S(t_{i})}{S(u_{i})}\right\}
\]</span></p>
<p>Obsérvese que el hecho de dividir la función de verosimilitud entre <span class="math inline">\(S(u_{i})\)</span> se limita a que los datos sean truncados por la izquierda<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;De primera vista, pareciera que la segunda igualdad de la expresión anterior es incorrecta y que debería ser &lt;span class="math inline"&gt;\(\prod_{i=1}^{n}\left\{h(t_{i})\right\}^{\delta_{i}}\left\{\frac{S(t_{i})}{S(u_{i})}\right\}^{1-\delta_i}\)&lt;/span&gt; lo cual no es correcto. Se recomienda desarrollar la primera igualdad y relacionar lo necesario para obtener &lt;span class="math inline"&gt;\(h(t_i)\)&lt;/span&gt;.&lt;/p&gt;'><sup>7</sup></a>.</p>
</div>
<div id="truncamiento-por-la-derecha" class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> Truncamiento por la Derecha<a class="anchor" aria-label="anchor" href="#truncamiento-por-la-derecha"><i class="fas fa-link"></i></a>
</h2>
<p>Consideremos tiempos de fallo <span class="math inline">\(T_{i}\)</span> tal que <span class="math inline">\(T_{i} \leq v_{i}\)</span> para que sea observado. Entonces las observaciones serán <span class="math inline">\((t_{i}, v_{i})\)</span> para todo <span class="math inline">\(i = 1,...,n\)</span>.</p>
<p>Por lo que:</p>
<p><span class="math display">\[
\mathbf{\mathscr{L}} = \prod_{i=1}^{n}\left\{\frac{f(t_{i})}{1-S(v_{i})}\right\} =\prod_{i=1}^{n} \mathbb{P}(T_{i}|T_{i}&lt;v_{i})
\]</span></p>
</div>
<div id="estimaciones-para-algunos-modelos" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> Estimaciones para Algunos Modelos<a class="anchor" aria-label="anchor" href="#estimaciones-para-algunos-modelos"><i class="fas fa-link"></i></a>
</h2>
<div id="modelo-exponencial-1" class="section level3 unnumbered">
<h3>Modelo Exponencial<a class="anchor" aria-label="anchor" href="#modelo-exponencial-1"><i class="fas fa-link"></i></a>
</h3>
<p>Sean los tiempos de fallo <span class="math inline">\(T_{i}\)</span> independientes y provenientes de una distribución exponencial:</p>
<ul>
<li><span class="math inline">\(f(t) = \lambda e^{-\lambda t}\)</span></li>
<li><span class="math inline">\(S(t) = e^{-\lambda t}\)</span></li>
<li><span class="math inline">\(h(t) = \lambda\)</span></li>
<li><span class="math inline">\(H(t) = \lambda t\)</span></li>
</ul>
<p>Entonces, la función de verosimilitud con censura tipo I es:</p>
<p><span class="math display">\[
\mathscr{L} = \prod_{i}^{n}\lambda^{\delta_{i}}e^{-\lambda t_{i}}= \lambda^{\sum_{i= 1}^{n}\delta_{i}}e^{-\lambda \sum_{i = 1}^{n}t_{i}}
\]</span></p>
<p>Sea <span class="math inline">\(r=\sum_{i = 1}^{n}\delta_{i}\)</span> el número de observaciones exactas (no censuradas). Entonces:</p>
<p><span class="math display">\[
 \mathscr{L} = \lambda^{r}e^{-\lambda\sum_{i= 1}^{n}t_{i}}
\]</span></p>
<p>Si queremos un estimador para <span class="math inline">\(\lambda\)</span>, hacemos:</p>
<p><span class="math display">\[
\frac{\partial ln(\mathscr{L})}{\partial \lambda} = \frac{\partial[r ln(\lambda)-\lambda\sum_{i = 1}^{n}t_{i}]}{\partial\lambda} = \frac{r}{\lambda}-\sum_{i  =1}^{n}t_i = 0
\]</span></p>
<p><span class="math display">\[
\Longrightarrow \hat{\lambda} = \frac{r}{\sum_{i= 1}^{n}t_{i}}
\]</span></p>
<p>Observe que si <em>no hay datos censurados</em> entonces <span class="math inline">\(\sum_{i = 1}^{n}\delta_{i}=n\)</span>, por lo que <span class="math inline">\(\hat{\lambda}=\frac{1}{\bar t}\)</span>, y este es el estimador que conocemos desde el curso de inferencia.</p>
<div id="ejemplo-8" class="section level4 unnumbered">
<h4>Ejemplo<a class="anchor" aria-label="anchor" href="#ejemplo-8"><i class="fas fa-link"></i></a>
</h4>
<p>El siguiente ejercicio fue basado en el ejercicio 3.6 del libro <span class="citation">(Klein and Moeschberger <a href="modelo-de-riesgos-proporcionales.html#ref-klein2006survival" role="doc-biblioref">2006</a>)</span>. Los siguientes datos consisten en los tiempos de recaída y los tiempos de muerte después de la recaída de 10 pacientes con trasplante de médula ósea. Suponga que el tiempo hasta la recaída tiene una distribución exponencial con la tasa de riesgo <span class="math inline">\(\lambda\)</span>.</p>
<div class="inline-table"><table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:center;">
Paciente
</th>
<th style="text-align:center;">
Tiempo de recaida en meses
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;">
1
</td>
<td style="text-align:center;">
5
</td>
</tr>
<tr>
<td style="text-align:center;">
2
</td>
<td style="text-align:center;">
8
</td>
</tr>
<tr>
<td style="text-align:center;">
3
</td>
<td style="text-align:center;">
12
</td>
</tr>
<tr>
<td style="text-align:center;">
4
</td>
<td style="text-align:center;">
24
</td>
</tr>
<tr>
<td style="text-align:center;">
5
</td>
<td style="text-align:center;">
32
</td>
</tr>
<tr>
<td style="text-align:center;">
6
</td>
<td style="text-align:center;">
17
</td>
</tr>
<tr>
<td style="text-align:center;">
7
</td>
<td style="text-align:center;">
16+
</td>
</tr>
<tr>
<td style="text-align:center;">
8
</td>
<td style="text-align:center;">
17+
</td>
</tr>
<tr>
<td style="text-align:center;">
9
</td>
<td style="text-align:center;">
19+
</td>
</tr>
<tr>
<td style="text-align:center;">
10
</td>
<td style="text-align:center;">
30+
</td>
</tr>
</tbody>
<tfoot><tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> Los datos censurados están representados con un ‘+’
</td>
</tr></tfoot>
</table></div>
<ul>
<li><ol style="list-style-type: lower-alpha">
<li>Calcule la tasa de recaída.</li>
</ol></li>
<li><ol start="2" style="list-style-type: lower-alpha">
<li>Calcule la probabilidad de no recaer en 16 meses.</li>
</ol></li>
</ul>
<p>Sabemos que los estimadores máximo-verosímiles cumplen la propiedad de invarianza, de modo que:</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(\hat{\lambda} = \frac{r}{\sum_{i= 1}^{n}t_{i}} = \frac{6}{\sum_{i= 1}^{10}t_{i}} = \frac{6}{180} = 3.3333333\%\)</span></p></li>
<li><p><span class="math inline">\(\hat S(16) = e^{-\hat\lambda t} = e^{-0.033(16)} = 0.5866463\)</span></p></li>
</ol>
</div>
</div>
<div id="modelo-weibull-1" class="section level3 unnumbered">
<h3>Modelo Weibull<a class="anchor" aria-label="anchor" href="#modelo-weibull-1"><i class="fas fa-link"></i></a>
</h3>
<p>Supongamos que se tienen los tiempos de fallo <span class="math inline">\(T_{i}\)</span> con censura, provenientes de una distribución Weibull:</p>
<ul>
<li><span class="math inline">\(f(t) = \lambda \gamma(\lambda t)^{\gamma-1}e^{-(\lambda t)^\gamma}\)</span></li>
<li><span class="math inline">\(S(t) = e^{-(\lambda t)^\gamma}\)</span></li>
<li><span class="math inline">\(h(t) = \lambda \gamma(\lambda t)^{\gamma-1}\)</span></li>
</ul>
<p>Entonces, su respectiva función de verosimilitud es de la forma:</p>
<p><span class="math display">\[
\mathscr{L} = \prod_{i}^{n}\left[\lambda \gamma(\lambda t_i)^{\gamma-1}e^{-(\lambda t_i)^\gamma}\right]^{\delta_i}\left[e^{-(\lambda t_i)^\gamma}\right]^{1-\delta_i} = \prod_{i}^{n}\left[\lambda \gamma(\lambda t_i)^{\gamma-1}\right]^{\delta_i}\left[e^{-(\lambda t_i)^\gamma}\right]
\]</span></p>
<p>Por lo que:</p>
<p><span class="math display">\[
\ln(\mathscr{L}) = \sum_{i=1}^{n}\delta_i\ln(\lambda \gamma(\lambda t_i)^{\gamma -1})-(\lambda t_i)^\gamma
\]</span></p>
<p>Si suponemos que <span class="math inline">\(r=\sum_{i = 1}^{n}\delta_{i}\)</span> y desarrollamos la expresión anterior, obtenemos:</p>
<p><span class="math display">\[
\ln(\mathscr{L}) =r\ln(\lambda \gamma)+(\gamma -1)r\ln (\lambda)+(\gamma -1)\sum_{i=1}^{n}\delta_i\ln(t_i)-\lambda^{\gamma}\sum_{i=1}^{n}t_i^{\gamma}
\]</span></p>
<p>Los estimadores máximo-verosímiles de <span class="math inline">\(\lambda\)</span> y <span class="math inline">\(\gamma\)</span> se obtienen derivando <span class="math inline">\(\ln(\mathscr{L})\)</span> con respecto a <span class="math inline">\(\lambda\)</span> y <span class="math inline">\(\gamma\)</span>, igualando a cero y evaluando en <span class="math inline">\(\hat \lambda\)</span> y <span class="math inline">\(\hat \gamma\)</span>:</p>
<p><span class="math display">\[
\frac{\partial \ln(\mathscr{L})}{\partial \lambda}=r\frac{\gamma}{\lambda \gamma}+\frac{(\gamma-1)r}{\lambda}-\gamma \lambda^{\gamma -1}\sum_{i=1}^{n}t_i^{\gamma}=0
\]</span></p>
<p><span class="math display">\[
\frac{\partial \ln(\mathscr{L})}{\partial \gamma}=r\frac{\lambda}{\lambda \gamma}+r\ln(\lambda)+\sum_{i=1}^{n}\delta_i\ln(t_i)-\left[\lambda^{\gamma}\ln(\lambda)\sum_{i=1}^{n}t_i^{\gamma}+\lambda^\gamma \sum_{i=1}^{n}t_i^{\gamma}\ln(t_i)\right]=0
\]</span></p>
<p>Simplificando ambas ecuaciones tenemos:</p>
<p><span class="math display">\[
r\gamma-\gamma \lambda^\gamma\sum_{i=1}^{n}t_i^\gamma=0
\]</span></p>
<p><span class="math display">\[
\frac{r}{\gamma}+r\ln(\lambda)+\sum_{i=1}^{n}\delta_i\ln(t_i)-\lambda^\gamma\left[\ln(\lambda)\sum_{i=1}^{n}t_i^{\gamma}-\sum_{i=1}^{n}t_i^{\gamma}\ln(t_i)\right]=0
\]</span></p>
<p>Despejamos a <span class="math inline">\(\lambda\)</span> de la primera ecuación:</p>
<p><span class="math display">\[
\hat\lambda=\left(\frac{r}{\sum_{i=1}^{n}t_i^{\hat\gamma}}\right)^{\frac{1}{\hat\gamma}}
\]</span></p>
<p>Y sustituyendo en la segunda ecuación:</p>
<p><span class="math display">\[
\begin{array}{cc}
\frac{r}{\hat\gamma}+r\ln\left(\left(\frac{r}{\sum_{i=1}^{n}t_i^{\hat\gamma}}\right)^{\frac{1}{\hat \gamma}}\right)+\sum_{i=1}^{n}\delta_i\ln(t_i)&amp;\\
-\left(\frac{r}{\sum_{i=1}^{n}t_i^{\hat \gamma}}\right)\left[\ln\left(\left(\frac{r}{\sum_{i=1}^{n}t_i^{\hat \gamma}}\right)^{\frac{1}{\hat \gamma}}\right)\sum_{i=1}^{n}t_i^{\hat \gamma}-\sum_{i=1}^{n}t_i^{\hat \gamma}\ln(t_i)\right]&amp;=0
\end{array}
\]</span></p>
<p>La expresión anterior es una ecuación <em>no lineal</em> de <span class="math inline">\(\hat \gamma\)</span>, cuya solución es únicamente mediante un método numérico. Una vez que se ha obtenido el valor <span class="math inline">\(\hat \gamma\)</span>, éste se sustituye en <span class="math inline">\(\left(\frac{r}{\sum_{i=1}^{n}t_i^{\hat \gamma}}\right)^{\frac{1}{\hat \gamma}}\)</span> para así obtener, finalmente, el valor de <span class="math inline">\(\hat \lambda\)</span>.</p>
<p>Ecuaciones <em>no lineales</em>, como hemos visto en el modelo <em>Weibull</em>, aparecen en la estimación de parámetros de las distribuciones <em>Log-Normal</em>, <em>Log-Logística</em> y <em>Gamma</em>; resulta que, al considerar datos con censura y truncamiento, las estimaciones se complican en los modelos paramétricos. No obstante, tenemos ayuda de las computadoras y software que nos permitirán realizar estimaciones adecuadas.</p>

</div>
</div>
</div>




  <div class="chapter-nav">
<div class="prev"><a href="modelos-param%C3%A9tricos.html"><span class="header-section-number">5</span> Modelos Paramétricos</a></div>
<div class="next"><a href="modelos-no-param%C3%A9tricos-para-la-funci%C3%B3n-de-supervivencia.html"><span class="header-section-number">7</span> Modelos No Paramétricos para la Función de Supervivencia</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#la-funci%C3%B3n-de-verosimilitud-con-censura-y-truncamiento"><span class="header-section-number">6</span> La Función de Verosimilitud con Censura y Truncamiento</a></li>
<li><a class="nav-link" href="#caso-general"><span class="header-section-number">6.1</span> Caso General</a></li>
<li><a class="nav-link" href="#censura-por-la-derecha-tipo-i-1"><span class="header-section-number">6.2</span> Censura por la Derecha Tipo I</a></li>
<li><a class="nav-link" href="#censura-por-la-derecha-tipo-ii-1"><span class="header-section-number">6.3</span> Censura por la Derecha Tipo II</a></li>
<li><a class="nav-link" href="#censura-aleatoria"><span class="header-section-number">6.4</span> Censura Aleatoria</a></li>
<li><a class="nav-link" href="#truncamiento-por-la-izquierda"><span class="header-section-number">6.5</span> Truncamiento por la Izquierda</a></li>
<li><a class="nav-link" href="#truncamiento-por-la-derecha"><span class="header-section-number">6.6</span> Truncamiento por la Derecha</a></li>
<li>
<a class="nav-link" href="#estimaciones-para-algunos-modelos"><span class="header-section-number">6.7</span> Estimaciones para Algunos Modelos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelo-exponencial-1">Modelo Exponencial</a></li>
<li><a class="nav-link" href="#modelo-weibull-1">Modelo Weibull</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/blob/master/06_Likehood.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/CarlosFernandoVG/supervivencia_y_series_FC2021-1/edit/master/06_Likehood.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Modelos de Supervivencia</strong>" was written by Sofía Villers Gómez, Carlos Fernando Vásquez Guerra, Luis Angel Ramirez Teodoro. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
