[{"path":"index.html","id":"prefacio","chapter":"Prefacio","heading":"Prefacio","text":"Primera edición del bookdown Modelos de Supervivencia para su uso en la materia Análisis de Supervivencia y Series de tiempo y sus relacionadas impartidas por los autores, así como para aquellos estudiantes que deseen adquirir el conocimiento pertinente de tal tópico.","code":""},{"path":"index.html","id":"objetivos","chapter":"Prefacio","heading":"Objetivos","text":"Otorgar un material electrónico de calidad con el contenido referente al Análisis de Supervivencia como un esfuerzo de los autores para lograr un proceso de aprendizaje autodidacta por parte del alumno y así optimizar el tiempo, tanto de los profesores, como el de los alumnos.Otorgar un material electrónico de calidad con el contenido referente al Análisis de Supervivencia como un esfuerzo de los autores para lograr un proceso de aprendizaje autodidacta por parte del alumno y así optimizar el tiempo, tanto de los profesores, como el de los alumnos.Plasmar las bases teóricas de esta rama de la estadística con el uso de ejemplos y contenido visual para un mejor entendimiento de cada subtema que se trate.Plasmar las bases teóricas de esta rama de la estadística con el uso de ejemplos y contenido visual para un mejor entendimiento de cada subtema que se trate.","code":""},{"path":"index.html","id":"estructura","chapter":"Prefacio","heading":"Estructura","text":"Este libro se compone de diez diferentes capítulos comenzando con los tipos de datos con el que se puede encontrar el lector en un estudio de supervivencia, dado esto, en el capítulo 3 se comienza con el estudio de las distintas funciones de supervivencia, así como las funciones que se deriven de esta, para los casos discreto y continuo. En el capítulo 4 se desglosa la teoría correspondiente la obtención de parámetros poblacionales, como lo son la media y la varianza; para así en el capítulo 5 tratar modelos paramétricos comunes donde se asume una distribución para los datos tratar y se obtienen las funciones vistas en los capítulos previos. El capítulo 6 abarca lo correspondiente la obtención de la función de verosimilitud en datos censurados y truncados. Respecto los capítulos 7 y 8 se da la teoría, junto varios ejemplos, para el análisis paramétrico en un análisis de supervivencia para que en el capítulo 9 se establezcan las pruebas de hipótesis pertinentes. Finalmente en el capítulo 10 se considera el modelo de riesgos proporcionales y se estudian las implicaciones sobre algunos tópicos de los capítulos anteriores.Se recomienda que la consulta de los capítulos se realice de acuerdo al índice, ya que medida que se avanza en índice, se asume el conocimiento de los capítulos previos.","code":""},{"path":"index.html","id":"detalles-técnicos","chapter":"Prefacio","heading":"Detalles técnicos","text":"Para la creación de este material se hizo uso de varios sistemas de software como LaTeX y CSS para el diseño de ciertos elementos. Todos los cálculos y gráficas fue creado con el lenguaje de programación R ya sea con el uso del paquete base o algún otro de los paquetes que se mencionan continuación.Este libro fue escrito con bookdown usando RStudio.Esta versión fue escrita con:","code":"R version 3.6.2 (2019-12-12)\nPlatform: x86_64-apple-darwin15.6.0 (64-bit)\nRunning under: macOS  10.16\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib\nLAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] survival_3.1-8      kableExtra_1.2.1    knitr_1.30         \n [4] actuar_2.3-3        futurevisions_0.1.1 shape_1.4.4        \n [7] latex2exp_0.4.0     patchwork_1.0.0     devtools_2.2.2     \n[10] usethis_1.5.1       forcats_0.5.0       stringr_1.4.0      \n[13] dplyr_1.0.1         purrr_0.3.4         readr_1.3.1        \n[16] tidyr_1.1.0         tibble_3.0.4        ggplot2_3.3.2      \n[19] tidyverse_1.3.0    \n\nloaded via a namespace (and not attached):\n [1] fs_1.5.0             lubridate_1.7.9      webshot_0.5.2       \n [4] httr_1.4.2           rprojroot_1.3-2      tools_3.6.2         \n [7] backports_1.2.0      bslib_0.2.3.9000     R6_2.5.0            \n[10] DBI_1.1.0            colorspace_1.4-1     withr_2.3.0         \n[13] tidyselect_1.1.0     prettyunits_1.1.1    processx_3.4.4      \n[16] downlit_0.2.1        compiler_3.6.2       cli_2.1.0           \n[19] rvest_0.3.5          xml2_1.2.2           desc_1.2.0          \n[22] bookdown_0.21.6      sass_0.2.0.9005      scales_1.1.1        \n[25] callr_3.5.1          rappdirs_0.3.1       digest_0.6.27       \n[28] rmarkdown_2.6.4      pkgconfig_2.0.3      htmltools_0.5.0.9003\n[31] sessioninfo_1.1.1    dbplyr_1.4.2         rlang_0.4.10        \n[34] readxl_1.3.1         rstudioapi_0.12      jquerylib_0.1.3     \n[37] generics_0.0.2       jsonlite_1.7.2       magrittr_2.0.1      \n[40] Matrix_1.2-18        Rcpp_1.0.5           munsell_0.5.0       \n[43] fansi_0.4.1          lifecycle_0.2.0      stringi_1.5.3       \n[46] yaml_2.2.1           expint_0.1-6         pkgbuild_1.1.0      \n[49] grid_3.6.2           crayon_1.3.4         lattice_0.20-40     \n[52] haven_2.2.0          splines_3.6.2        hms_0.5.3           \n[55] ps_1.4.0             pillar_1.4.6         pkgload_1.1.0       \n[58] reprex_0.3.0         glue_1.4.2           evaluate_0.14       \n[61] remotes_2.1.1        modelr_0.1.6         vctrs_0.3.4         \n[64] testthat_3.0.0       cellranger_1.1.0     gtable_0.3.0        \n[67] assertthat_0.2.1     xfun_0.19            broom_0.7.0         \n[70] viridisLite_0.3.0    memoise_1.1.0        ellipsis_0.3.1      Finding R package dependencies ... Done! setting  value                       \n version  R version 3.6.2 (2019-12-12)\n os       macOS  10.16                \n system   x86_64, darwin15.6.0        \n ui       X11                         \n language (EN)                        \n collate  en_US.UTF-8                 \n ctype    en_US.UTF-8                 \n tz       America/Mexico_City         \n date     2021-01-04                  "},{"path":"index.html","id":"licencia","chapter":"Prefacio","heading":"Licencia","text":"work licensed Creative Commons Attribution-ShareAlike 4.0 International License.human-readable summary (substitute ) license.\nPlease see https://creativecommons.org/licenses/-sa/4.0/legalcode full legal text.free :Share—copy redistribute material medium \nformatShare—copy redistribute material medium \nformatRemix—remix, transform, build upon material \npurpose, even commercially.Remix—remix, transform, build upon material \npurpose, even commercially.licensor revoke freedoms long follow \nlicense terms.following terms:Attribution—must give appropriate credit, provide link\nlicense, indicate changes made. may \nreasonable manner, way suggests licensor\nendorses use.Attribution—must give appropriate credit, provide link\nlicense, indicate changes made. may \nreasonable manner, way suggests licensor\nendorses use.ShareAlike—remix, transform, build upon material, must distribute contributions license original.ShareAlike—remix, transform, build upon material, must distribute contributions license original.additional restrictions—may apply legal terms \ntechnological measures legally restrict others \nanything license permits.additional restrictions—may apply legal terms \ntechnological measures legally restrict others \nanything license permits.Notices:comply license elements \nmaterial public domain use permitted \napplicable exception limitation.warranties given. license may give \npermissions necessary intended use. example, rights\npublicity, privacy, moral rights may limit use \nmaterial.","code":""},{"path":"motivación.html","id":"motivación","chapter":"Motivación","heading":"Motivación","text":"En los dos cursos anteriores de estadística se ha trabajado con datos (muestras aleatorias) exactos, es decir, datos que se conocen en su totalidad y que, con base en ellos, hemos realizado estimaciones sobre los parámetros poblacionales. Sin embargo, puede suceder que los datos se conozcan parcialmente, o bien, se desconozcan; esto suele suceder en estudios que tienen limitados recursos y tiempo para llevarse cabo, por ejemplo: estudios sobre la efectividad de un tratamiento clínico, la reaparición de cierta enfermedad en pacientes, confiabilidad industrial, etcétera.Lo anterior sugiere plantearnos algunas preguntas interesantes: ¿Cómo realizamos estimaciones con datos parciales?, ¿Se puede ajustar algún modelo paramétrico con datos parciales?, ¿Podemos comparar poblaciones con datos parciales?. Éstas y otras cuestiones abordaremos lo largo del curso de Modelos de Supervivencia y Series de Tiempo. En general, en la primer parte del curso (Análisis de supervivencia) se establecerán las bases teóricas para el tratamiento de datos parciales en modelos conocidos (paramétricos), y además estudiaremos modelos paramétricos para este tipo de datos.Por otro lado, responder preguntas como: ¿Cuál será el precio de las acciones de Facebook para el último bimestre del 2020?, ¿Cuál será el nivel de partículas contaminantes en la CDMX para noviembre de 2020?, ¿Cuál será la capacidad de un procesador intel para el año 2021?, puede parecer, en primera instancia, una tarea complicada. Si bien tenemos una “bola mágica” con la que podamos adivinar el futuro, disponemos de ciertos procesos estocásticos llamados Series de Tiempo, cuyo objetivo principal es el pronóstico; estos se abordarán en la segunda parte del curso, y por ende en un próximo bookdown.","code":""},{"path":"análisis-de-supervivencia.html","id":"análisis-de-supervivencia","chapter":"Análisis de Supervivencia","heading":"Análisis de Supervivencia","text":"El análisis de supervivencia se basa en el estudio del tiempo, en la ocurrencia de un evento. El término supervivencia se debe que en las primeras aplicaciones de este método de análisis se utilizaba como evento la muerte de un paciente; tradicionalmente el análisis de supervivencia se ha asociado al análisis de datos en ensayos médicos.El tiempo de superviviencia o falla se define como el tiempo transcurrido desde el estado inicial hasta la ocurrencia de un evento dado. Por ejemplo, en un estudio que consiste en observar la remisión de cierta enfermedad en pacientes, se puede definir el tiempo de falla como el tiempo en el que tarda en reaparecer la enfermedad en los pacientes. Otros ejemplos de tiempo de falla son: los tiempos que toman los individuos para completar tareas específicas en experimentación psicológica, tiempos en los que tardan ciertas máquinas industriales en descomponerse, la longitud de trayectorias sobre una placa fotográfica en física de partículas.Para determinar el tiempo de falla de forma precisa, hay tres requerimientos: un tiempo de origen que debe ser definido, una escala para medir el paso del tiempo que debe ser congruente al problema y finalmente, el significado de falla que debe ser completamente claro. Frecuentemente la escala para medir el paso de tiempo es el tiempo reloj (tiempo real), sin embargo hay otras posibilidades, como el kilometraje en un auto o el uso operacional de un sistema. Evidentemente, se pide que los tiempos de falla sean negativos.Resulta de interés conocer (si es posible) la distribución de los tiempos de falla. En general los estudios que hemos ejemplificado anteriormente tienen limitaciones para llevarse cabo, en consecuencia se establece algún periodo fijo de observación; es en este punto en el que pueden surgir datos parcialmente conocidos.continuación se muestra con ejemplos algunas de las diferentes formas como se pueden presentar los datos de supervivencia. Todos los ejemplos tienen un tiempo de origen, una escala de medición y una definición de falla.Datos de supervivencia de pacientes psiquiatricos.En esta forma de presentar los datos \\(^+\\) significa que la observación es censurada, es decir se observo más allá de los 30 o 33 años. Las observaciones censuradas se verán en la siguiente sección.Tiempos de infección (en meses) de pacientes en diálisis con diferentes procedimientos de cateterización.Consumo de la marihuana en la preparatoriaLos ejemplos anteriores son extracciones de ejemplos en el libro (Klein Moeschberger 2006).","code":""},{"path":"datos-censurados.html","id":"datos-censurados","chapter":"Capítulo 1 Datos Censurados","heading":"Capítulo 1 Datos Censurados","text":"Ocurren cuando el tiempo de falla se conoce sólo en cierto periodo de tiempo. Por ejemplo, un estudio consiste en observar la muerte (tiempo de falla) de pacientes en un periodo establecido, algunos de ellos pueden estar vivos todavía al final del periodo de estudio. Los tiempos de supervivencia exactos de estos sujetos son desconocidos, pero tenemos información parcial. Estas son llamadas observaciones censuradas, y se denotan por \\(+\\).","code":""},{"path":"datos-censurados.html","id":"censura-por-la-derecha-tipo-i","chapter":"Capítulo 1 Datos Censurados","heading":"1.1 Censura por la Derecha Tipo I","text":"Nos referimos este tipo de censura cuando el estudio se termina un tiempo fijo predeterminado (tiempo de censura) independientemente del tamaño de la muestra (número total de individuos en el estudio).","code":""},{"path":"datos-censurados.html","id":"ejemplo","chapter":"Capítulo 1 Datos Censurados","heading":"Ejemplo","text":"Un investigador de la facultad de ciencias realiza un estudio en 5 ratas de laboratorio y ha determinado que la duración de este será de un año y medirá el tiempo (en meses) en que cada rata fallece . Al cabo del año se obtuvieron los siguientes resultados: \\(3,4,8,10,12^+\\), esto quiere decir que una rata murió los tres meses iniciado el estudio, otra lo hizo en 4 meses, etcétera; la quinta rata permaneció con vida hasta el final del estudio, es decir, presentó la falla en el tiempo predeterminado de observación por lo tanto es un dato censurado.","code":""},{"path":"datos-censurados.html","id":"censura-por-la-derecha-tipo-ii","chapter":"Capítulo 1 Datos Censurados","heading":"1.2 Censura por la Derecha Tipo II","text":"Ocurre cuando el estudio continua hasta que se presenta la falla de los primeros \\(r<n\\) individuos. Donde \\(r\\) es el número de individuos predeterminado observar y \\(n\\) es el número total de individuos en el estudio. En este tipo de censura hay dependencia del tamaño de muestra y de las fallas que se observen.","code":""},{"path":"datos-censurados.html","id":"ejemplo-1","chapter":"Capítulo 1 Datos Censurados","heading":"Ejemplo","text":"Las limitaciones económicas para la investigación científica han hecho que un especialista en cancerología tome la decisión de observar los tiempos (en días) de sólo 5 conejos hasta que desarrollen un tumor, de un total de 9. Al final se obtuvo lo siguiente: \\(30,34,43,45,60,60^+,60^+,60^+,60^+\\), ¿Cómo interpretaría usted los resultados obtenidos por el especialista?","code":""},{"path":"datos-censurados.html","id":"censura-por-la-derecha-tipo-iii","chapter":"Capítulo 1 Datos Censurados","heading":"1.3 Censura por la Derecha Tipo III","text":"Llamada también censura aleatoria. Se denomina así porque el tiempo de censura lo determina un fenómeno aleatorio, que tiene lugar durante la consecución del estudio e impide seguir con la observación del individuo hasta el tiempo final; es decir que \\(T_i\\) es una variable aleatoria. En general, la censura aleatoria surge cuando los individuos salen del estudio sin presentar la falla por razones controladas por el investigador. Cuando sucede tal censura, se dice que se tiene una análisis de riesgos competitivos.Finalmente, si el mecanismo de censura aleatoria es dependiente de los tiempos de falla, se dice que este es una censura informativa, ya que otorga información los tiempos de falla; en caso contrario es informativa.","code":""},{"path":"datos-censurados.html","id":"ejemplo-2","chapter":"Capítulo 1 Datos Censurados","heading":"Ejemplo","text":"Algunos ejemplos son la migración otra ciudad o los casos donde el paciente se retira del estudio o muere por alguna causa ajena al evento de interés. La siguiente gráfica muestra un ejemplo de datos con censura aleatoria.","code":""},{"path":"datos-censurados.html","id":"censura-por-la-izquierda","chapter":"Capítulo 1 Datos Censurados","heading":"1.4 Censura por la Izquierda","text":"Las observaciones censuradas por la izquierda serán aquellas en las que el evento de interés ha tenido lugar antes del punto de inicio del estudio. Así, el tiempo de censura en este caso será el tiempo de inicio del estudio.","code":""},{"path":"datos-censurados.html","id":"ejemplo-3","chapter":"Capítulo 1 Datos Censurados","heading":"Ejemplo","text":"Un ejemplo de este tipo de censura son los tiempos al primer uso de marihuana. Como se observa en el ejemplo en la introducción de este capítulo, el levantamiento de la información se hace sobre alumnos de preparatoria y hay casos en los que el inicio del consumo es una edad previa al levantamiento de los datos. Entonces aquellos jóvenes cuyo primer uso de marihuana es una edad previa la registrada en ese momento, serán consideradas como observaciones censuradas por la izquierda.Frecuentemente si un estudio tiene censura por la izquierda, entonces se tendrá doble censura, por lo que se denota como \\(C_i\\) al tiempo antes del cual algunos individuos presentan el evento de interés y \\(C_d\\) al tiempo después del cual algunos de los individuos presentan el evento de interés.","code":""},{"path":"datos-censurados.html","id":"censura-por-intervalos","chapter":"Capítulo 1 Datos Censurados","heading":"1.5 Censura por Intervalos","text":"Ocurre cuando los individuos en el estudio son monitoreados intermitentemente en momentos discretos de tiempo, de modo que, es posible que el suceso de estudio haya tenido lugar en un tiempo entre dos de las mediciones.Si el individuo \\(\\) ha presentado el evento de interés al fin del tiempo \\(I_i\\) pero la siguiente observación \\(D_i\\) sí presentó el evento, entonces es una falla censurada en el intervalo \\((I_i,D_i)\\).","code":""},{"path":"datos-censurados.html","id":"ejemplo-4","chapter":"Capítulo 1 Datos Censurados","heading":"Ejemplo","text":"Un investigador lleva cabo un estudio en ratas diseñado para evaluar los efectos de dietas ricas en vegetales en el riesgo de cáncer de mama. El tumor mamario es inducido con una única dosis de DMBA al inicio del estudio. 6 semanas después de la administración del DMBA, cada rata es examinada una vez la semana por 14 semanas y el tiempo en que el tumor es palpable es registrado. Si una rata presenta tumor en la quinta revisión, entonces lo que se sabe es que el tumor en la cuarta revisión era palpable y por lo tanto este debió presentarse entre la cuarta y quinta revisión dando como resultado que esa observación esta censurada en el intervalo (semana 10, semana 11).","code":""},{"path":"datos-truncados.html","id":"datos-truncados","chapter":"Capítulo 2 Datos Truncados","heading":"Capítulo 2 Datos Truncados","text":"El truncamiento tiene lugar cuando sólo aquellos sujetos que manifiestan el evento dentro de una ventana observacional \\((U,V)\\) son observados, del resto se realiza ningún seguimiento y, por tanto, se obtiene información sobre ellos (hay información parcial). Las observaciones \\(t_i\\) tales que \\(t_i<U\\), serán observaciones truncadas por la izquierda y aquellas que \\(t_i>V\\) serán observaciones truncadas por la derecha.","code":""},{"path":"datos-truncados.html","id":"ejemplos-de-datos-truncados","chapter":"Capítulo 2 Datos Truncados","heading":"Ejemplos de Datos Truncados","text":"Deseamos medir la supervivencia de adultos mayores de 60 años. Entonces necesitamos que los individuos tengan al menos 60 años para que sean considerados en el estudio, por lo que el estudio está truncado por la izquierda. Otro ejemplo es si deseáramos medir la distancia de la tierra las estrellas, este sería truncado por la derecha ya que se puede ver más allá de un límite.Es importante mencionar que la diferencia entre truncamiento y censura es la información parcial disponible. En datos censurados hay información parcial, mientras que en datos truncados .","code":""},{"path":"datos-truncados.html","id":"ejemplos-del-caso-continuo-y-caso-discreto","chapter":"Capítulo 2 Datos Truncados","heading":"Ejemplos del caso continuo y caso discreto","text":"Un número grande de individuos sanos fueron enrolados en un estudio que inicio el 1/01/1970. Los individuos fueron seguidos por 30 años para estudiar la edad la que desarrollaron cáncer de mama. Fueron sometidos exámenes clínicos cada 3 años. Menciona si hay censura o truncamiento en:Individuo sano, enrolado los 30 años, durante el periodo de estudio nunca desarrollo cáncer de mama.Individuo sano, enrolado en el estudio con 40 años de edad, se le diagnosticó cáncer de mama en el quinto examen clínico.Individuo sano, enrolado con 50 años de edad, murió los 63 años por paro cardíaco.Individuo con cáncer de piel en remisión.","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"funciones-para-el-análisis-de-supervivencia","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Capítulo 3 Funciones para el Análisis de Supervivencia","text":"Dado que el análisis de supervivencia se basa en tiempos de falla, definiremos continuación funciones importantes que se pueden asociar estos. Evidentemente, estamos pensando que los tiempos de falla provienen de una variable aleatoria negativa1 \\(T\\) la cual llamaremos variable aleatoria del tiempo de falla, equivalentemente longitud de tiempo de vida futura o tiempo de superviviencia. Por simplicidad la llamaremos tiempo de supervivencia.\\(T\\) es usualmente descrita o caracterizada por cuatro funciones:1.- Función de supervivencia2.- Función de densidad de probabilidad3.- Función de riesgo4.- Función de riesgo acumuladoEstas funciones son matemáticamente equivalentes; partir de una se derivan las otras tres. Cabe destacar que, dependiendo el caso, \\(T\\) puede ser una variable aleatoria continua o bien, discreta.","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"función-de-supervivencia","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"3.1 Función de Supervivencia","text":"","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"caso-continuo","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Caso continuo","text":"La función de supervivencia \\(S(t)\\), tanto en el caso continuo como en el discreto, se define como la probabilidad de que un individuo sobreviva más allá del tiempo \\(t\\). Para el caso continuo:\\[\nS(t)=\\mathbb{P}(T>t)=1-F_T(t)=\\int_{t}^{\\infty}f_T(u)du\n\\]Si tomamos la igualdad \\(S(t)=1-F_T(t)\\) y derivamos en ambos lados y multiplicamos por \\(-1\\), obtenemos:\\[\n-\\frac{d}{dt}S(t)=f_T(t)\n\\]Las propiedades de \\(S(t)\\) son:1.-Es monótona creciente.2.- \\(S(t)=1\\) para \\(t=0\\).3.- \\(S(t)=0\\) cuando \\(t\\rightarrow\\infty\\).La función \\(S(t)\\) es conocida también como la tasa de superviviencia acumulativa; en el contexto industrial se conoce como función de confiabilidad.Por otro lado, es de suma importancia representar \\(S(t)\\) gráficamente ya que de ella se puede obtener información interesante; por ejemplo el cálculo de diversos cuantiles (como el cuantil 50) nos permitirán hacer inferencias y comparar distribuciones de superviviencia de dos o más grupos de individuos. La gráfica de \\(S(t)\\) es llamada curva de supervivencia, los gráficos de la figura 3.1 son ejemplos de esta.\nFigura 3.1: Ejemplos de la curva de supervivencia.\nEn la primer gráfica se observa una tasa de supervivencia baja, mientras que en la segunda gráfica se tiene una tasa alta. En este contexto, ¿qué podríamos decir de los pacientes con el tratamiento 1 versus los pacientes con el tratamiento 2?","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"caso-discreto","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Caso discreto","text":"Si \\(T\\) es una variable aleatoria discreta que toma valores \\(0<t_1<t_2<...\\) Entonces la función de probabilidad de \\(T\\) es:\\[\nf(t) = \\left\\{\n\\begin{array}{ll}\n\\mathbb{P}(T=t_j) & \\mbox{ si  } t=t_j, j=1,2,...\\\\\n0 & \\mbox{en otro caso }\n\\end{array}\n\\right.\n\\]Por lo que su función de supervivencia es:\\[\nS(t)=\\mathbb{P}(T> t)=\\sum_{t< t_j}f(t_j)\n\\]\nLa siguiente es una representación gráfica de la función de supervivencia en el caso discretoAl igual que el caso continuo, se tienen las propiedades:1.-Es monótona creciente2.- \\(S(t)=1\\) para \\(t=0\\).3.- \\(S(t)=0\\) cuando \\(t\\rightarrow\\infty\\).","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"ejemplos-del-caso-continuo-y-caso-discreto-1","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Ejemplos del caso continuo y caso discreto","text":"Estos pueden verse al final de la sección 4","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"RiskFunction","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"3.2 Función de Riesgo","text":"","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"caso-continuo-1","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Caso continuo","text":"La función de riesgo \\(h(t)\\) (hazard function), también llamada tasa de falla condicional (en el análisis de confiabilidad) o tasa de mortalidad (en demografía), se define como la probabilidad de falla durante un intervalo de tiempo muy pequeño suponiendo que el individuo ha sobrevivido hasta el inicio del intervalo2; en expresiones matemáticas es:\\[\nh(t)=\\lim_{\\alpha\\rightarrow 0}\\frac{1}{\\alpha}\\mathbb{P}(t<T\\leq t+\\alpha|T\\geq t)\n\\\\\n=\\lim_{\\alpha\\rightarrow 0}\\frac{1}{\\alpha}\\frac{\\mathbb{P}(T\\leq t+\\alpha)-\\mathbb{P}(T<t)}{\\mathbb{P}(T\\geq t)}\\\\\n=\\lim_{\\alpha\\rightarrow 0}\\frac{1}{\\alpha}\\frac{F(t+\\alpha)-F(t)}{S(t)}\n=\\frac{f(t)}{S(t)}\n\\]Entonces\\[\nh(t)=\\frac{f(t)}{S(t)}=\\frac{f(t)}{1-F(t)}=-\\frac{d}{dt}log(S(t))\n\\]Si tomamos la igualdad\\[\nh(t)=-\\frac{d}{dt}log(S(t))\n\\]Y despejamos \\(S(t)\\) tenemos que:\\[\nS(t)=exp\\left[-\\int_{0}^{t}h(u)du\\right]=exp[-H(t)]\n\\]Donde \\(H(t)=\\int_{0}^{t}h(u)du\\) es conocida como la función acumulada de riesgo, la cual veremos más adelante.La función de riesgo juega un papel importante en el análisis de supervivencia. Describe la forma en que cambia la tasa instantánea de muerte de un individuo al paso del tiempo (constante, lineal, exponencial, etc.). El conocer \\(h(t)\\) puede darnos alguna idea sobre la selección del modelo para la distribución del tiempo de supervivencia, por ejemplo, puede ser útil al considerar restricciones para modelos con funciones de riesgo decrecientes o modelos con funciones de riesgo crecientes.hay un comportamiento “habitual” en la gráfica de \\(h(t)\\), es decir, \\(h(t)\\) puede crecer, decrecer, ser constante o mostrar algo más complicado. El esquema siguiente muestra algunos ejemplos de la gráfica de \\(h(t)\\):La curva \\(h(t)\\) en color azul (llamada curva de tina de baño) describe el proceso de la vida humana: al inicio existe mortalidad infantil y el riesgo de morir es alto, crece el individuo y el riesgo de morir se reduce y hasta cierto punto es constante, después viene el envejecimiento(hay deterioro) y entonces el riesgo de morir aumenta. Una función de riesgo creciente como la curva de color verde implica un envejecimiento natural. Una función decreciente como la curva color morado es menos común e indica rejuvenecimiento. Una función en forma de montaña como la curva color café, podría representar un comportamiento de muerte por enfermedad después de llevar un tratamiento para la misma enfermedad.","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"caso-discreto-1","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Caso discreto","text":"En este caso, la función de riesgo proporciona la probabilidad condicional de falla al tiempo \\(t=u_k\\), dado que el individuo estaba vivo antes de \\(u_k\\).Sea \\(T\\) una variable aleatoria discreta con soporte en \\(\\{u_1,u_2,u_3,...\\}\\). La función de riesgo al tiempo \\(u_k\\) se define como3\\[\nh(u_k)=\\mathbb{P}(T=u_k|T\\geq u_k)=\\frac{\\mathbb{P}(T=u_k)}{\\mathbb{P}(T\\geq u_k)} =\\frac{f_T(u_k)}{S_T(u_{k-1})}\n\\]Observemos que:\\[\nf_T(u_k)=\\mathbb{P}(T=u_k)=\\mathbb{P}(T\\geq u_k)-\\mathbb{P}(T> u_{k})= S(u_{k-1})-S(u_{k})\n\\]si dividimos entre \\(S(u_{k-1})\\), tenemos entonces:\\[\nh(u_k)=\\frac{S(u_{k-1})-S(u_{k})}{S(u_{k-1})}=1-\\frac{S(u_{k})}{S(u_{k-1})}\n\\]Por otro lado, para \\(S(t)\\) se cumple que:\\[\nS(t)=\\frac{S(t)}{1}=\\frac{S(t)}{S(0)}=\\frac{S(u_1)}{S(0)}.\\frac{S(u_2)}{S(u_1)}.\\frac{S(u_3)}{S(u_2)}...\\frac{S(u_k)}{S(u_{k-1})}.\\frac{S(t)}{S(u_k)}\n\\]Entonces, de la expresión anterior y ocupando que \\(h(u_k)=1-\\frac{S(u_{k})}{S(u_{k-1})}\\) tenemos finalmente:\\[\nS(t)=\\prod_{k: u_k \\leq t}\\frac{S(u_k)}{S(u_{k-1})} =\\prod_{k: u_k \\leq t}(1-h(u_k))\n\\]Si queremos obtener \\(f(u_k)\\), la podemos conocer partir de la función de riesgo:\\[\nf(u_k)=\\frac{f(u_k)}{S(u_{k-1})}S(u_{k-1})=h(u_k)S(u_{k-1})=h(u_k) \\prod_{j<k} \\frac{S(u_j)}{S(u_{j-1})}=h(u_k) \\prod_{j<k}(1-h(u_j))\n\\]La expresión\\[\nS(t)=\\prod_{k: u_k \\leq t}(1-h(u_k))\n\\]la ocuparemos más adelante.","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"ejemplo-5","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Ejemplo","text":"Suponga que se tiene la siguiente distribución para la variable aleatoria \\(T\\): \\(\\mathbb{P}(T = j) = \\frac{1}{3}; \\ \\ j = 1,2,3\\)Para este caso se tienen los siguientes resultados junto con las siguientes representaciones gráficas:\\[\nS(t) = \\left\\{\n\\begin{array}{ll}\n1 & -\\infty<t<1\\\\\n\\frac{2}{3} &  1\\leq t<2\\\\\n\\frac{1}{3} & 2\\leq t < 3\\\\\n0 & t\\geq 3\n\\end{array}\n\\right.\nh(t) = \\left\\{\n\\begin{array}{ll}\n\\frac{f(1)}{S(0)} = \\frac{1}{3} & t = 1\\\\\n\\frac{f(2)}{S(1)} = \\frac{1}{2} & t = 2\\\\\n\\frac{f(3)}{S(2)} = 1 & t = 3\n\\end{array}\n\\right.\n\\]","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"función-de-riesgo-acumulado","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"3.3 Función de Riesgo Acumulado","text":"","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"caso-continuo-2","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Caso continuo","text":"Esta función, denotada por \\(H(t)\\), es importante en la medición de la frecuencia con que ocurren los fallos en el tiempo y en el análisis de residuos para el ajuste de algunos modelos. \\(H(t)\\) se define como sigue:\\[\nH(t)=\\int_{0}^{t}h(u)du\n\\]\nHemos visto anteriormente que:\\[\nS(t)=exp(-H(t))\n\\]entonces\\[\nH(t)=-log(S(t))\n\\]Podemos calcular \\(f(t)\\) en términos de \\(h(t)\\) y \\(H(t)\\):\\[\nf(t)=h(t)S(t)=h(t)exp(-H(t))\n\\]","code":""},{"path":"funciones-para-el-análisis-de-supervivencia.html","id":"caso-discreto-2","chapter":"Capítulo 3 Funciones para el Análisis de Supervivencia","heading":"Caso discreto","text":"\\(H(t)\\) se define como:\\[\nH(t)=\\sum_{k: u_k\\leq t}h(u_k)\n\\]Una definición alternativa es:\\[\nH(t)=-\\sum_{k: u_k\\leq t}log(1-h(u_k))\n\\]","code":""},{"path":"par-poblacionales.html","id":"par-poblacionales","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Capítulo 4 Parámetros Poblacionales","text":"Si conocemos la distribución de \\(T\\) (cuando sea posible) es importante extraer cierta información que nos ayude sacar conclusiones sobre los tiempos de supervivencia; saber, información sobre su(s) parámetro(s). Aunque es habitual pensar \\(T\\) como una variable aleatoria continua, continuación presentaremos parámetros poblacionales en términos de la función de superviviencia para el caso continuo y discreto.","code":""},{"path":"par-poblacionales.html","id":"media","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"4.1 Media","text":"","code":""},{"path":"par-poblacionales.html","id":"caso-continuo-3","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso continuo","text":"Para el caso continuo se tiene:\\[\n\\mu=\\mathbb{E}[T]=\\int_{0}^{\\infty}\\mathbb{P}(T>t)=\\int_{0}^{\\infty}S(t)dt\n\\]La demostración se queda como ejercicio al alumno.","code":""},{"path":"par-poblacionales.html","id":"caso-discreto-3","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso discreto","text":"\\(\\mu\\) en este caso es de la forma:\\[\n\\mu=\\mathbb{E}[T]=\\sum_{k=1}^{\\infty}u_kf(u_k)=\\sum_{k=1}^{\\infty}S(u_k)\n\\]La demostración se queda como ejercicio al alumno.","code":""},{"path":"par-poblacionales.html","id":"varianza","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"4.2 Varianza","text":"","code":""},{"path":"par-poblacionales.html","id":"caso-continuo-4","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso continuo","text":"Para este caso la varianza se ve como:\\[\n  \\sigma^2=Var[T]=\\mathbb{E}[T^2]-(\\mathbb{E}[T])^2=2\\int_{0}^{\\infty}tS(t)dt-\\left(\\int_{0}^{\\infty}S(t)dt\\right)^2\n\\]La demostración de la igualdad anterior se obtiene si se observa que:\\[\n\\mathbb{E}[T^2]=\\int_{0}^{\\infty}t^2f(t)dt=-t^2S(t)|_0^{\\infty}+2\\int_{0}^{\\infty}tS(t)dt=2\\int_{0}^{\\infty}tS(t)dt\n\\]Y ocupando que:\\[\n\\mathbb{E}[T]=\\int_{0}^{\\infty}S(t)dt\n\\]","code":""},{"path":"par-poblacionales.html","id":"caso-discreto-4","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso discreto","text":"De manera similar:\\[\n  \\sigma^2=Var[T]=\\mathbb{E}[T^2]-(\\mathbb{E}[T])^2=2\\sum_{k=1}^{\\infty}u_kS(u_k)-\\left(\\sum_{k=1}^{\\infty}S(u_k)\\right)^2\n\\]La demostración se queda de ejercicio al alumno.","code":""},{"path":"par-poblacionales.html","id":"función-de-media-residual","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"4.3 Función de Media Residual","text":"Para individuos de edad \\(x\\) este parámetro, denotado por \\(mr(x)\\), mide la esperanza de vida residual; esto es, “la esperanza de vida que les queda partir de la edad \\(x\\)”.","code":""},{"path":"par-poblacionales.html","id":"caso-continuo-5","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso continuo","text":"Se define como:\\[\nmr(x)=\\mathbb{E}[T-x|T>x]=\\frac{\\mathbb{E}[T-x]}{\\mathbb{P}(T>x)}=\\frac{\\int_x^{\\infty}(t-x)f(t)dt}{S(x)}=\\frac{\\int_x^{\\infty}S(t)dt}{S(x)}\n\\]","code":""},{"path":"par-poblacionales.html","id":"caso-discreto-5","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso discreto","text":"Para este caso es:\\[\nmr(u_x)=\\frac{\\sum_{k=x}^{\\infty}S(u_k)}{S(u_x)}\n\\]","code":""},{"path":"par-poblacionales.html","id":"cuantiles-de-orden-p","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"4.4 Cuantiles de Orden \\(p\\)","text":"El cálculo de diversos cuantiles nos permitirá hacer comparaciones entre diversos grupos de sujetos, además de obtener información sobre los tiempos de falla, por ejemplo, el tiempo mediano de falla (veces es mejor el cálculo de la mediana que la media).","code":""},{"path":"par-poblacionales.html","id":"caso-continuo-6","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso continuo","text":"El cuantil o percentil, \\(t_p\\), de orden \\(p\\) de la variable aleatoria continua \\(T\\) será aquel que:\\[\nS(t_p)=1-p\n\\]Si queremos el tiempo mediano de los tiempos de supervivencia entonces debemos calcular \\(t_{0.5}\\) talque:\\[\nS(t_{0.5})=0.5\n\\]","code":""},{"path":"par-poblacionales.html","id":"caso-discreto-6","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Caso discreto","text":"En este caso \\(t_p\\) es:\n\\[\nt_p=inf\\{t: S(t) \\leq  1-p\\}\n\\]","code":""},{"path":"par-poblacionales.html","id":"ejemplo-1-1","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Ejemplo 1","text":"Siguiendo el ejemplo presentado en la sección 3.2, se tiene lo siguiente:Función de supervivencia de \\(T\\): \\(S(t) = \\mathbb{P}(T>t)=\\left\\{\\begin{array}{ll}1 & \\mbox{si }t=1\\\\\\frac{2}{3} & \\mbox{si } t=2\\\\\\frac{1}{3} & \\mbox{si } t = 3\\\\0 & \\mbox{si }t>3\\end{array}\\right.\\)Función de riesgo: \\(h(t) =\\left\\{\\begin{array}{ll}\\frac{1}{3} & \\mbox{si }t=1\\\\\\frac{1}{2} & \\mbox{si } t=2\\\\\\ 1 & \\mbox{si } t = 3\\end{array}\\right.\\)\\(\\mu = \\mathbb{E}(T) = \\sum\\limits_{t = 1}^3S(t) = \\sum\\limits_{t = 1}^3t\\cdot f(t) = 2\\).\\(mrl(2) = \\frac{\\sum\\limits_{k = 2}^\\infty S(u_k)}{S(2)} = \\frac{2/3+1/3+0}{2/3} = \\frac{3}{2} = 1.5\\).\\(t_{0.75} = inf\\{t: S(t) \\leq 0.15\\} = 3\\)Con la finalidad de aclarar la distribución de los cuantiles en una distribución discreta, se dejan las siguientes gráficas correspondientes este ejercicio.","code":""},{"path":"par-poblacionales.html","id":"ejemplo-2-1","chapter":"Capítulo 4 Parámetros Poblacionales","heading":"Ejemplo 2","text":"Sea \\(T\\) una v.con distribución uniforme continua en \\((0,100)\\) unidades días.Encontrar la función de supervivencia y evaluar la supervivencia para 30 y 35 años.Encontrar la función de riesgo y evaluar el riesgo para 60 días.Encontrar la esperanza de riesgo residual los 75 días.Soluciones:\\[\nf_T(t) = \\left\\{\n\\begin{array}{ll}\n\\frac{1}{100} & \\forall\\ \\ t\\[0,100]\\\\\n0 & e.o.c\n\\end{array}\n\\right.\n\\implies S(t) = 1-\\int_0^t\\frac{1}{100}dv = 1-\\frac{t}{100}\n\\]\n\\[\n\\implies S(30) = \\mathbb{P}(T>30) = 1-\\frac{30}{100};\\ \\  S(35) = 1- \\frac{35}{100}\n\\]\\[\nh(t) = \\frac{f(t)}{S(t)} = \\frac{\\frac{1}{100}}{1-\\frac{1}{100}} = \\frac{1}{100-t}\\\\\n\\implies h(60) = \\frac{1}{100-60} = \\frac{1}{40}\n\\]\\[\nmrl(x) = \\mathbb{E}(T-75 | T>75) = \\frac{\\mathbb{E}(T-75)}{\\mathbb{P}(T>75)} = \\frac{\\int_x^\\infty(t-75)f(t)dt}{S(75)} = \\frac{\\int_x^{100}(t-75)\\frac{1}{100}dt}{1-\\frac{75}{100}}\n\\]\n\\[\n\\implies mrl(75) = \\frac{1}{25}\\int_{75}^{100}(t-75)dt = \\frac{1}{25}\\left(\\frac{100^2}{2}-\\frac{75^2}{2}\\right)-\\frac{75(100-75)}{25} = \\frac{25}{2} = 12.5\n\\]\nOtra soluciónDemostrandose que \\(\\int_x^\\infty(t-x)f(t) dt = \\int_x^\\infty S(t)dt\\)\\[\n\\implies mrl(75) = \\frac{\\int_{75}^{100}(t-75)\\frac{1}{100}dt}{S(75)} = \\frac{\\int_{75}^{100}S(75)dt}{S(75)} = 12.5\n\\]","code":""},{"path":"modelos-paramétricos.html","id":"modelos-paramétricos","chapter":"Capítulo 5 Modelos Paramétricos","heading":"Capítulo 5 Modelos Paramétricos","text":"Existen varios modelos paramétricos que se emplean en el análisis de supervivencia, esto se debe que pueden representar de manera adecuada el comportamiento de ciertos fenómenos. La motivación para usar un modelo en particular es, por lo general, empírica; o bien, con base en la información que proporcione algún modelo paramétrico. Las familias paramétricas más importantes son: Exponencial, Weibull, Log-Normal, Log-logística y Gamma.","code":""},{"path":"modelos-paramétricos.html","id":"modelo-exponencial","chapter":"Capítulo 5 Modelos Paramétricos","heading":"5.1 Modelo Exponencial","text":"El modelo exponencial es el más importante debido su amplia aplicación, por ejemplo, puede emplearse en estudios para determinar el tiempo de vida útil de algunos artículos manufacturados. Este modelo juega un papel fundamental análogo la distribución normal en la inferencia estadística tradicional.Función de Densidad\\[\nf(t)=h(t)S(t)=\\lambda exp(-\\lambda t)=\\lambda e^{-\\lambda t}\n\\]\nPara esta distribución \\(\\lambda\\) es un parámetro que modifica la escala de la distribución. Este es comúnmente llamado tasa definido por \\(1/s\\) donde \\(s\\) es el verdadero parámetro de escala4 de la distribución. Es muy común utilizar este parámetro en lugar del parámetro de escala ya que simplifica la expresión matemática.Función de Supervivencia\\[\nS(t)=exp\\left(-\\int_0^{t}h(u)du\\right)=exp\\left(-\\int_0^{t}\\lambda du\\right)=exp(-\\lambda t)=e^{-\\lambda t}\n\\]Si asumimos una tasa de riesgo invariante en el tiempo, \\(h(t)=\\lambda\\) con \\(\\lambda>0\\), generamos el modelo exponencial:Función de RiesgoTomamos \\(\\lambda>0\\) y hacemos:\\[\nh(t)=\\lambda\n\\]Aunque el supuesto de una función de riesgo constante resulta ser una restricción considerable, el modelo exponencial deja de ser útil e importante en variedad de aplicaciones. Cabe destacar, que este modelo cumple con la propiedad de pérdida de memoria; saber, se cumple que:\\[\n\\mathbb{P}(T>t+x|T>t)=\\mathbb{P}(T>x)\n\\]ParámetrosSi \\(T\\sim Exp(\\lambda)\\) entonces:\\[\n\\mathbb{E}[T]=\\int_{0}^{\\infty}t\\lambda e^{-\\lambda t}dt=\\frac{1}{\\lambda}\n\\]Y\\[\nVar[T]=\\mathbb{E}[T^2]-\\mathbb{E}[T]^2=\\frac{2}{\\lambda^2}-\\frac{1}{\\lambda^2}=\\frac{1}{\\lambda^2}\n\\]GráficasA continuación se muestran gráficas de una \\(Exponencial\\) con \\(\\lambda=0.5\\)REn el lenguaje de programación R se pueden obtener resultados de esta distribución como una muestra pseudo aleatoria y aproximaciones numéricas para la distribución y densidad de esta así como la obtención de los cuantiles.En general, el sufijo para esta distribución es *exp, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:rexp(n, rate = 1): Muestra pseudo aleatoria de tamaño \\(n\\).dexp(x, rate = 1, log = FALSE): Valores de \\(f(x)\\).pexp(q, rate = 1, lower.tail = TRUE, log.p = FALSE): Valores de \\(F(x)\\).qexp(p, rate = 1, lower.tail = TRUE, log.p = FALSE): Cuantil \\(t_p\\).Algo que hay que recordar es que al utilizar la función, por ejemplo, rexp(n, r) se respeta el orden de los parámetros por lo que r será el valor correspondiente la tasa y parámetro de escala es decir el valor \\(r = \\lambda\\). Se menciona esta por que puede ser común que se confunda r con \\(1/\\lambda\\), por lo que se recomienda tener precaución.","code":""},{"path":"modelos-paramétricos.html","id":"modelo-weibull","chapter":"Capítulo 5 Modelos Paramétricos","heading":"5.2 Modelo Weibull","text":"El modelo Weibull es una generalización del modelo exponencial, se agrega un parámetro de forma5 \\(\\gamma\\) y se mantiene el parámetro de escala \\(\\lambda\\). Este modelo es uno de los más utilizados para tiempos de falla: tiene utilidad en la vida de algunos artículos manufacturados, así como en los tiempos de aparición de tumores en medicina.Función de Densidad\n\\[\nf(t)=\\lambda \\gamma(\\lambda t)^{\\gamma-1}e^{-(\\lambda t)^\\gamma}=h(t)S(t)\n\\]Obsérvese que si \\(\\gamma =1\\) entonces el modelo Weibull se reduce al modelo exponencial.Función de Supervivencia\\[\nS(t)=exp\\left(-\\int_0^{t}h(u)du\\right)=exp\\left(-\\int_0^{t}\\lambda \\gamma(\\lambda u)^{\\gamma-1} du\\right)=exp(-(\\lambda t)^\\gamma)=e^{-(\\lambda t)^\\gamma}\n\\]Si asumimos, en general, una función de riesgo monótona: creciente o decreciente, se puede obtener el modelo Weibull.Función de RiesgoPara este modelo \\(h(t)\\) está dada por:\\[\nh(t)=\\lambda \\gamma(\\lambda t)^{\\gamma-1}; \\ \\ \\ \\gamma>0, \\lambda>0 \\mbox{ y } t>0\n\\]ParámetrosSi \\(T\\sim Weibull(\\gamma,\\lambda)\\) entonces:\\[\n\\mathbb{E}[T]=\\frac{1}{\\lambda}\\Gamma\\left(\\frac{1}{\\gamma}+1\\right)\n\\]Y además\\[\nVar[T]=\\frac{1}{\\lambda^2}\\Gamma\\left(\\frac{2}{\\gamma}+1\\right)-\\left(\\frac{1}{\\lambda}\\Gamma\\left(\\frac{1}{\\gamma}+1\\right)\\right)^2\n\\\\=\\frac{1}{\\lambda^2}\\left[\\Gamma\\left(\\frac{2}{\\gamma}+1\\right)-\\left(\\Gamma\\left(\\frac{1}{\\gamma}+1\\right)\\right)^2\\right]\n\\]\nDebe resultar sencillo para el alumno demostrar las igualdades de la esperanza y varianza.GráficasLas dos gráficas siguientes muestran curvas de \\(f(t)\\) y \\(h(t)\\) para el modelo Weibull con \\(\\lambda=1\\) y \\(\\gamma=2,4\\):Y para el modelo Weibull con \\(\\lambda=1\\) y \\(\\gamma=0.5,1\\) se tienen las siguientes gráficas:Como bien hemos dicho, si suponemos una función de riesgo monótona creciente ó decreciente la distribución Weibull puede ser generada. Concretamente, si \\(\\gamma>1\\) entonces \\(h(t)\\) es estrictamente creciente, si \\(\\gamma<1\\) entonces \\(h(t)\\) es estrictamente decreciente. Cuando \\(\\gamma=1\\) se tiene la distribución exponencial.RPara este caso el sufijo referente esta distribución es *weibull, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:rweibull(n, shape, scale = 1): Muestra pseudo aleatoria de tamaño \\(n\\).dweibull(x, shape, scale = 1, log = FALSE): Valores de \\(f(x)\\).pweibull(q, shape, scale = 1, lower.tail = TRUE, log.p = FALSE): Valores de \\(F(x)\\).qweibull(p, shape, scale = 1, lower.tail = TRUE, log.p = FALSE): Cuantil \\(t_p\\).Así como en el caso de la exponencial y en todos los casos posteriores, se respeta el orden de los parámetros por lo que para aplicar los parámetros tal como se vieron en esta sección se puede utilizar esta función de la siguiente manera: dweibull(\\(\\gamma\\), \\(1/\\lambda\\)) o sin importar el orden indicando de manera explicita que shape = \\(\\gamma\\) y scale = \\(1/\\lambda\\). Esto último debido que la función de densidad para este modelo en R esta considerada como \\(f(x) = \\frac{\\gamma}{\\lambda}(\\frac{x}{\\lambda})^{\\gamma-1}e^{-(\\frac{x}{\\lambda})^\\gamma}\\).","code":""},{"path":"modelos-paramétricos.html","id":"modelo-log-normal","chapter":"Capítulo 5 Modelos Paramétricos","heading":"5.3 Modelo Log-Normal","text":"El modelo Log-Normal tiene estrecha relación con la distribución Normal. De hecho, el tiempo de supervivencia \\(T\\) se dice que sigue una distribución Log-Normal, si \\(Y=ln(T)\\) se distribuye \\(N(\\mu,\\sigma^2)\\).La distribución Log-Normal se ha utilizado como modelo en el tiempo de falla de aislantes eléctricos y en el tiempo de aparición de cáncer pulmonar. También se utiliza en poblaciones que son una mezcla de tiempos de vida cortos y largos. pesar de esto, este modelo es criticado por ser decreciente para valores grandes de \\(t\\), lo cual parece inadecaudo en algunas situaciones.Función de DensidadPara este modelo, \\(f(t)\\) está dada por:\\[\nf(t)=\\frac{1}{\\sqrt {2\\pi}\\sigma t}exp\\left(-\\frac{1}{2}\\left(\\frac{ln(t)-\\mu}{\\sigma}\\right)^2\\right)\n\\]En este caso, \\(\\mu\\) y \\(\\sigma\\) pasan ser los parámetros de escala y de forma de la distribución, los cuales hacen diferencia con los de la distribución normal, ya que en tal caso \\(\\mu\\) sería un parámetro de localización y \\(\\sigma\\) seguiría siendo el parámetro de escala. Para agregar un parámetro de localización la distribución \\(log-normal\\) bastaría camiar \\(x\\) por \\(x-\\theta\\) donde \\(\\theta\\) sería tal parámetro.Función de Supervivencia\\[\nS(t)=\\int_t^{\\infty}f(u)du\n\\\\=1-\\int_0^{t}f(u)du\n\\\\=1-\\int_0^{t}\\frac{1}{\\sqrt {2\\pi}\\sigma u}exp\\left(-\\frac{1}{2}\\left(\\frac{ln(u)-\\mu}{\\sigma}\\right)^2\\right)du\n\\]Tomando la notación de la función de distribución de una Normal estándar, \\(\\Phi()\\), se tiene:\\[\nS(t)=1-\\Phi\\left(\\frac{ln(t)-\\mu}{\\sigma}\\right)\n\\]Función de Riesgo\\[\nh(t)=\\frac{f(t)}{S(t)}\n\\\\=\\frac{\\frac{1}{\\sqrt {2\\pi}\\sigma t}exp\\left(-\\frac{1}{2}\\left(\\frac{ln(t)-\\mu}{\\sigma}\\right)^2\\right)}{1-\\Phi\\left(\\frac{ln(t)-\\mu}{\\sigma}\\right)}\n\\]Si bien la expresión de \\(h(t)\\) parece ser complicada, su gráfica resulta ser más interesante. Ésta toma el valor de cero en \\(t=0\\), crece hasta un valor máximo y luego tiende cero cuando \\(t \\rightarrow \\infty\\). Véase sección de gráficas.ParámetrosSi \\(T\\sim LogNormal(\\mu,\\sigma^2)\\) entonces:\\[\n\\mathbb{E}[T]=exp\\left(\\mu+\\frac{\\sigma^2}{2}\\right)\n\\]Y además\\[\nVar[T]=exp(2\\mu+2\\sigma^2)-exp(2\\mu+\\sigma^2)\n\\]La demostración de las igualdades de media y varianza se dejan al alumno.GráficasA continuación algunos ejemplos de las gráficas de \\(f(t)\\) y \\(h(t)\\) para la distribución Log-Normal:RPara esta distribución el sufijo respectivo será *lnorm, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:rlnorm(n, meanlog = 0, sdlog = 1): Muestra pseudo aleatoria de tamaño \\(n\\).dlnorm(x, meanlog = 0, sdlog = 1, log = FALSE): Valores de \\(f(x)\\).plnorm(q, meanlog = 0, sdlog = 1, lower.tail = TRUE, log.p = FALSE): Valores de \\(F(x)\\).qlnorm(p, meanlog = 0, sdlog = 1, lower.tail = TRUE, log.p = FALSE): Cuantil \\(t_p\\).En este caso, es evidente que meanlog correspondería al parámetro de escala \\(\\mu\\) y sdlog al parámetro de forma \\(\\sigma\\). Finalmente se menciona que estos parámetros se deben confundir explícitamente con los de una distribución normal.","code":""},{"path":"modelos-paramétricos.html","id":"ejemplo-6","chapter":"Capítulo 5 Modelos Paramétricos","heading":"Ejemplo","text":"El tiempo de muerte en días después de un trasplante de médula sigue una distribución \\(log-normal\\) con \\(\\mu = 3.177, \\sigma = 2.084\\). Calcular lo siguienteLa media y la mediano tiempo de muerteLa probabilidad de que un individuo sobreviva 200 días después de un trasplante.SolucionesMediana: \\(t_{0.5} =e^{\\mu}\\) cuando \\(T\\sim log-normal \\implies\\) Mediana de tiempo de muerte: \\(t_{0.5} = e^{3.177} = 23.97\\).Media: \\(\\mathbb{E}(T) = e^{\\mu+\\sigma^2/2}\\) cuando \\(T\\sim log- normal \\implies\\) Media de tiempo de muerte: \\(\\mathbb{E}(T) = e^{3.177+\\frac{(2.084)^2}{2}} = 210.29\\) días.Entonces si sobrevivieron 23.97, queda una gran cantidad de días donde, en promedio son 210.29.\\(S(200) = 1-\\Phi\\left(\\frac{\\ln(200)-3.177}{2.084}\\right) = 1-0.8438 = 0.15436\\).","code":""},{"path":"modelos-paramétricos.html","id":"modelo-log-logístico","chapter":"Capítulo 5 Modelos Paramétricos","heading":"5.4 Modelo Log-Logístico","text":"El modelo Log-Logístico es derivado de la distribución Logística. Se dice que \\(T\\) tiene distribución Log-Logística si \\(Y=ln(T)\\) sigue una distribución Logística con parámetros \\(\\mu\\) y \\(\\sigma ^2\\).Función de Densidad\\[\nf(t)=\\frac{\\alpha \\lambda (\\lambda t)^{\\alpha-1}}{(1+(\\lambda t)^\\alpha)^2}\n\\]con \\(\\alpha=\\frac{1}{\\sigma}\\) y \\(\\lambda=exp(-\\frac{\\mu}{\\sigma})>0\\). \\(\\alpha\\) es el parámetro de forma y \\(\\lambda\\) es el parámetro de escala.Función de Supervivencia\\[\nS(t)=\\frac{1}{1+(\\lambda t)^\\alpha}\n\\]Función de Riesgo\\[\nh(t)=\\frac{f(t)}{S(t)}=\\frac{\\alpha \\lambda (\\lambda t)^{\\alpha-1}}{1+(\\lambda t)^\\alpha}\n\\]La función de riesgo es monótona decreciente para \\(\\alpha \\leq 1\\), y para \\(\\alpha> 1\\) la función de riesgo crece hasta alcanzar un máximo en \\(t=(\\frac{\\alpha-1}{\\lambda})^{\\frac{1}{\\alpha}}\\) y luego decrece cero cuando \\(t \\rightarrow \\infty\\).GráficasAlgunos ejemplos de las gráficas de \\(f(t)\\) y \\(h(t)\\) para la distribución Log-Logística:RPara esta distribución se recomienda descargar y utilizar el paquete actuar, en la cual vienen un conjunto de funciones similares las anteriores, de hecho el sufijo respectivo será *llogis y, de manera análoga las anteriores funciones, se tiene lo siguiente:rllogis(n, shape, rate = 1, scale = 1/rate): Muestra pseudo aleatoria de tamaño \\(n\\).dllogis(x, shape, rate = 1, scale = 1/rate, log = FALSE): Valores de \\(f(x)\\).pllogis(q, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE): Valores de \\(F(x)\\).qllogis(p, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE): Cuantil \\(t_p\\).En este caso, como en la exponencial y la weibull, rate correspondería al parámetro \\(\\lambda\\) y shape al parámetro de forma \\(\\alpha\\).","code":""},{"path":"modelos-paramétricos.html","id":"modelo-gamma","chapter":"Capítulo 5 Modelos Paramétricos","heading":"5.5 Modelo Gamma","text":"La distribución Gamma, que incluye las distribuciones exponencial y ji-cuadrada, ha sido utilizada como un modelo para problemas de confiabilidad industrial, hepatogramas en adultos normales y en pacientes con cirrosis, en supervivencia de plaquetas, entre otros. Este modelo tiene dos parámetros: \\(\\beta\\) es el parámetro de forma y \\(\\lambda\\) es el parámetro que modifica de escala; estrictamente hablando \\(\\lambda\\) es la tasa: \\(\\lambda =\\frac{1}{s}\\) donde \\(s\\) sería el verdadero parámetro de escala.Función de Densidad\\(f(t)\\) está dada por:\\[\nf(t)=\\frac{\\lambda^\\beta}{\\Gamma(\\beta)}t^{\\beta-1}exp(-\\lambda t); \\ \\ \\  \\lambda,\\beta>0\n\\]Función de Supervivencia\\[\nS(t)=1-Ig(\\lambda t, \\beta)\n\\]donde6:\\[\nIg(t,\\beta)=\\frac{1}{\\Gamma(\\beta)}\\int_0^{t}u^{\\beta-1}e^{-u}du\n\\]\nAl igual que un modelo \\(Weibull(\\lambda, alpha = 1)\\), la distribución exponencial es un caso particular del modelo \\(Gamma(\\lambda,\\beta = 1)\\). Cuando \\(\\beta \\rightarrow\\infty\\), modelo gamma se aproxima una distribución normal.Función de Riesgo\\[\nh(t)=\\frac{f(t)}{S(t)}=\\frac{\\frac{\\lambda^\\beta}{\\Gamma(\\beta)}t^{\\beta-1}exp(-\\lambda t)}{1-Ig(\\lambda t, \\beta)}\n\\]Esta función de riesgo tiene distintos comportamientos:Es monótona creciente para \\(\\beta>1\\). En este caso sucede que \\(h(0)=0\\) y \\(\\underset{t\\rightarrow\\infty}{h(t)} \\rightarrow \\lambda\\). Además, la moda de la distribución es \\(t = \\frac{\\beta-1}{\\lambda}\\)Es monótona decreciente con \\(\\beta <1\\). En tal caso \\(h(0) = \\infty\\) y \\(\\underset{t\\rightarrow\\infty}{h(t)} \\rightarrow \\lambda\\).ParámetrosSi \\(T\\sim Gamma(\\beta,\\lambda)\\) entonces:\\[\n\\begin{array}{ccc}\n\\mathbb{E}[T]=\\frac{\\beta}{\\lambda} & \\mbox{y} &\nVar[T]=\\frac{\\beta}{\\lambda^2}\n\\end{array}\n\\]Las demostraciones de las igualdades de la esperanza y varianza se quedan de ejercicio al alumno.GráficasSe muestran ejemplos de las gráficas de \\(f(t)\\) y \\(h(t)\\) para el modelo Gamma:RPara esta distribución el sufijo respectivo será *gamma, de tal manera que se tienen las siguientes funciones mencionando la interpretación de sus resultados:rgamma(n, shape, rate = 1, scale = 1/rate): Muestra pseudo aleatoria de tamaño \\(n\\).dgamma(x, shape, rate = 1, scale = 1/rate, log = FALSE): Valores de \\(f(x)\\).pgamma(q, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE): Valores de \\(F(x)\\).qgamma(p, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE): Cuantil \\(t_p\\).Como en el caso de la exponencial, se recomienda tener precaución ya que el parámetro rate es el que corresponde al parámetro \\(\\lambda\\) en este trabajo.","code":""},{"path":"modelos-paramétricos.html","id":"modelo-gamma-generalizada","chapter":"Capítulo 5 Modelos Paramétricos","heading":"5.6 Modelo Gamma Generalizada","text":"Finalmente, se presenta el modelo Gamma Generalizada con dos parámetros de forma y un parámetro de que modifica la escala \\(\\alpha\\), \\(\\beta\\) y \\(\\lambda\\) respectivamente.Función de Densidad\\(f(t)\\) está dada por:\\[\nf(t)=\\frac{\\alpha\\lambda^{\\beta\\alpha}}{\\Gamma(\\beta)}t^{\\alpha\\beta-1}\\exp(-\\lambda t)^\\alpha; \\ \\ \\  \\lambda,\\alpha, \\beta>0\n\\]Función de Supervivencia\\[\nS(t)=1-Ig((\\lambda t)^\\alpha, \\beta)\n\\]Esta distribución se reduce las siguientes\\(Exponencial\\) cuando \\(\\beta = \\alpha = 1\\).\\(Weibull\\) cuando \\(\\beta = 1\\).\\(Gamma\\) cuando \\(\\alpha = 1\\).Tiende la log-normal cuando \\(\\beta\\rightarrow\\infty\\).RPara esta distribución se recomienda descargar y utilizar el paquete ggamma, en la cual vienen un conjunto de funciones similares las anteriores. Aquí el respectivo sufijo será *ggamma y, de manera análoga las anteriores funciones, se tiene lo siguiente:rggamma(n, , b, k): Muestra pseudo aleatoria de tamaño \\(n\\).dggamma(x, , b, k, log = F): Valores de \\(f(x)\\).pggamma(p, , b, k, lower.tail = TRUE, log.p = FALSE): Valores de \\(F(x)\\).qggamma(p, shape, rate = 1, scale = 1/rate, lower.tail = TRUE, log.p = FALSE): Cuantil \\(t_p\\).Para este caso, se tiene una parametrización de uso común en distintas fuentes. = \\(\\frac{1}{\\lambda}\\), b = \\(\\alpha\\) y k = \\(\\beta\\).","code":""},{"path":"modelos-paramétricos.html","id":"ejemplo-7","chapter":"Capítulo 5 Modelos Paramétricos","heading":"Ejemplo","text":"El tiempo de vida en meses de cierta especie de ratón sigue una distribución \\(gamma(\\beta = 3, \\lambda = 0.2)\\).Calcular la probabilidad de que un ratón sobreviva más de 18 meses.¿Cuál es la probabilidad de que un ratón muera en el primer año de vida?¿Cuál es la esperanza de vida media de esta especia?Soluciones\\(S(18) = 1-F(18) = 1-\\) 0.6972532 = 0.3027468\\(F(12) =\\) 0.4302913\\(\\mathbb{E}(T) = \\frac{\\beta}{\\lambda} = \\frac{3}{0.2} = 15\\) meses.Cabe señalar que hasta este punto hemos introducido datos censurados los modelos.","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"la-función-de-verosimilitud-con-censura-y-truncamiento","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","text":"Cuando se conoce la distribución de \\(T\\), hacer estimaciones (usualmente por el método de máxima verosimilitud) sobre parámetros poblacionales resulta de suma importancia, pues partir de ellos sólo podemos conocer estimadores de la media, varianza o cuantiles; sino que también podemos conocer \\(\\hat S(t)\\), \\(\\hat h(t)\\), etc. En la sección anterior revisamos los modelos paramétricos más usados en análisis de supervivencia, sin embargo, contemplamos datos censurados o truncados en dichos modelos. En este apartado veremos la función de verosimilitud considerando censura y truncamiento, y con base en esta función haremos estimaciones para algunas distribuciones.","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"caso-general","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"6.1 Caso General","text":"De acuerdo al tipo de observación, se tienen las siguientes contribuciones la función de verosimilitud:\\[\n\\begin{array}{ll}\n\\mbox{Exactas } T_{} & f(t_{})\\\\\n\\mbox{Censurada por la derecha } T_{}>C_{} & \\mathbb{P}(T_{}>C_{})=S(C_{})\\\\\n\\mbox{Censurada por la izquierda } T_{}<C_{} & \\mathbb{P}(T_{}<C_{})=1-S(C_{})\\\\\n\\mbox{Censurada por la intervalo } L_{}<T_{}\\leq R_{} & \\mathbb{P}(L_{}<T_{}\\leq R_{})=S(L_{})-S(R_{})\\\\\n\\mbox{Truncado por la izquierda } T_{}|T_{}>u_{} & \\mathbb{P}(T_{}|T_{}>u_{})=\\frac{f(t_{})}{S(u_{})}\\\\\n\\mbox{Truncado por la derecha } T_{}|T_{} \\leq v_{} & \\mathbb{P}(T_{}|T_{} \\leq v_{})=\\frac{f(t_{})}{1-S(v_{})}\\\\\n\\end{array}\n\\]Entonces la función de verosimilitud es:\\[\n\\mathbf{\\mathscr{L}} = \\prod_{\\D}f(t_{})\\prod_{\\R}S(C_{})\\prod_{\\L}(1-S(C_{}))\\prod_{\\}[S(L_{})-S(R_{})]\n\\]\ndondeD: Conjunto de tiempos de fallo.R: Conjunto de observaciones censuradas por la derecha.L: Conjunto de observaciones censuradas por la izquierda.: Conjunto de observaciones censuradas por intervalo.Cuando hay datos truncados, se sustituye \\(f(t_{})\\) por \\(\\frac{f(t_{})}{S(u_{})}\\) y \\(S(C_{})\\) por \\(\\frac{S(C_{})}{S(_{u_{}})}\\).","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"censura-por-la-derecha-tipo-i-1","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"6.2 Censura por la Derecha Tipo I","text":"Suponga que se tiene una muestra aleatoria de \\(n\\) individuos con tiempos de vida \\(T_1,T_2,..., T_n\\)(v....d) y que está asociado cada individuo un tiempo fijo de censura \\(C_i>0\\). Se observa \\(T_i\\) solamente si \\(T_i\\leq C_i\\), por lo que los datos son parejas: \\((t_i,\\delta_i)\\), \\(=1,2,...,n\\) donde \\(t_i=min(T_i,C_i)\\) y:\\[\n\\delta_{} = \\left\\{\n\\begin{array}{ll}\n0 & \\mbox{si }  t_{} \\ = \\ C_i\\\\\n1 & \\mbox{si }  t_{} \\ =\\ T_i\n\\end{array}\n\\right.\n\\]Entonces la función de verosimilitud para datos con este tipo de censura es de la forma:\\[ \n\\mathscr{L} = \\prod^{n}_{=1}f(t_{})^{\\delta_{}}S(t_{})^{1-\\delta_{}} \n\\]donde \\(\\sum_{=1}^{n}\\delta_i\\) representa el total de los tiempos de vida observados.Considerando que \\(f(t) = h(t) S(t)\\), entonces:\\[\n\\begin{split}\n\\mathscr{L} & =\\prod_{= 1}^{n}h(t_{})^{\\delta_{}}S(t_{})^{\\delta_{}}S(t_{})^{1-\\delta_{}}\\\\\n & =\\prod_{= 1}^{n}h(t_{})^{\\delta_{}}S(t_{})\\\\\n & =\\prod_{= 1}^{n}h(t_{})^{\\delta_{}}exp\\{-H(t_{})\\}\n\\end{split}\n\\]","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"censura-por-la-derecha-tipo-ii-1","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"6.3 Censura por la Derecha Tipo II","text":"Supongamos que se observan los \\(r\\) tiempos de falla \\(T_{(1)}< T_{(2)}< ...<T_{(r)}\\) más pequeños, dejando \\(n-r\\) tiempos censurados por la derecha, de una muestra de tamaño \\(n\\). De modo que, los datos serán los \\(r\\) tiempos de fallo más pequeños de \\(T_{1}, T_{2},...,T_{n}\\).\\(T\\) tiene f.d.p \\(f(t)\\) y función de supervivencia \\(S(t)\\). Entonces la f.d.p. conjunta de \\(T_{(1)}, T_{(2)}, ...,T_{(r)}\\) es:\\[\n\\mathscr{L} = \\frac{n!}{(n-r)!}\\left\\{\\prod_{=1}^{r}f(t_{})\\right\\}\\left[S\\left(t_{(r)}\\right)\\right]^{n-r}\n\\]donde \\(\\prod_{=1}^{r}f(t_{})\\) es la parte correspondiente las \\(r\\) fallas observadas y \\([S(t_{(r)})]^{n-r}\\) constituye la aportación de las observaciones censuradas después de la \\(r-esima\\) falla observada.Observemos que si quitamos el término constante \\(\\frac{n!}{(n-r)!}\\) y definiendo la función indicadora:\\[\n\\delta_{} = \\left\\{\n\\begin{array}{ll}\n0 & \\mbox{si  } T_{} \\ > \\ T_{(r)}\\\\\n1 & \\mbox{si }  T_{}  \\leq\\ T_{(r)}\n\\end{array}\n\\right.\n\\]Entonces la función de verosimilitud para este tipo de censura se puede reesctibir:\\[ \n\\mathscr{L} \\propto \\prod^{n}_{=1}f(t_{})^{\\delta_{}}S(t_{})^{1-\\delta_{}} \n\\]que es la función de verosimilitud con datos censurados por la derecha tipo 1 revisada en la sección anterior.","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"censura-aleatoria","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"6.4 Censura Aleatoria","text":"Supongamos que para cada individuo se tienen \\(T_i\\) y \\(C_i\\) variables aleatorias independientes, con funciones de densidad \\(f_{T}(t)\\) y \\(f_{C}(t)\\), y con funciones de superviviencia \\(S_{T}(t)\\) y \\(S_{C}(t)\\) respectivamente. Sean \\((T_i,C_i)\\), \\(=1,2,...,n\\) parejas de observaciones independientes, la variable que observamos es \\(t_i=min(T_i,C_i)\\) y se define:\\[\n\\delta_{} = \\left\\{\n\\begin{array}{ll}\n0 & \\mbox{si  } T_{} \\ > \\ C_i\\\\\n1 & \\mbox{si }  T_{}  \\leq\\ C_i\n\\end{array}\n\\right.\n\\]por lo que, las observaciones son las parejas \\((t_i,\\delta_i)\\) con \\(=1,2,...,n\\).La función de verosimilitud es entonces:\\[ \n\\mathscr{L} = \\prod^{n}_{=1}[S_C(t_{})]^{1-\\delta_{}}[f_C(t_i)]^{\\delta_i}[f_T(t_i)]^{\\delta_i}[S_T(t_{})]^{1-\\delta_{}} \n\\]Similar al caso se censura por la derecha tipo 2, se puede demostrar que la expresión anterior es proporcional \\(\\prod^{n}_{=1}f_T(t_{})^{\\delta_{}}S_T(t_{})^{1-\\delta_{}}\\).","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"truncamiento-por-la-izquierda","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"6.5 Truncamiento por la Izquierda","text":"Consideremos los tiempos de fallo truncados por la izquierda, es decir, \\(T_{}\\) tal que \\(T_{}\\geq u_{}\\) para ser observado (\\(u_{}\\) es el valor de truncamiento).En este caso, las observaciones serán \\((u_{}, t_{},\\delta_{})\\) con \\(t_{}\\geq u_{}\\) tiempo de fallo y \\(\\delta_{}\\) indicador de censura por la derecha. Por lo que:\\[\n\\mathbf{\\mathscr{L}} = \\prod_{=1}^{n}\\left\\{\\frac{f(t_{})}{S(u_{})}\\right\\}^{\\delta_{}}\\left\\{\\frac{S(t_{})}{S(u_{})}\\right\\}^{1-\\delta_{}}=\\prod_{=1}^{n}\\left\\{h(t_{})\\right\\}^{\\delta_{}}\\left\\{\\frac{S(t_{})}{S(u_{})}\\right\\}\n\\]Obsérvese que el hecho de dividir la función de verosimilitud entre \\(S(u_{})\\) se limita que los datos sean truncados por la izquierda7.","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"truncamiento-por-la-derecha","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"6.6 Truncamiento por la Derecha","text":"Consideremos tiempos de fallo \\(T_{}\\) tal que \\(T_{} \\leq v_{}\\) para que sea observado. Entonces las observaciones serán \\((t_{}, v_{})\\) para todo \\(= 1,...,n\\).Por lo que:\\[\n\\mathbf{\\mathscr{L}} = \\prod_{=1}^{n}\\left\\{\\frac{f(t_{})}{1-S(v_{})}\\right\\} =\\prod_{=1}^{n} \\mathbb{P}(T_{}|T_{}<v_{})\n\\]","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"estimaciones-para-algunos-modelos","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"6.7 Estimaciones para Algunos Modelos","text":"","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"modelo-exponencial-1","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"Modelo Exponencial","text":"Sean los tiempos de fallo \\(T_{}\\) independientes y provenientes de una distribución exponencial:\\(f(t) = \\lambda e^{-\\lambda t}\\)\\(S(t) = e^{-\\lambda t}\\)\\(h(t) = \\lambda\\)\\(H(t) = \\lambda t\\)Entonces, la función de verosimilitud con censura tipo es:\\[\n\\mathscr{L} = \\prod_{}^{n}\\lambda^{\\delta_{}}e^{-\\lambda t_{}}= \\lambda^{\\sum_{= 1}^{n}\\delta_{}}e^{-\\lambda \\sum_{= 1}^{n}t_{}}\n\\]Sea \\(r=\\sum_{= 1}^{n}\\delta_{}\\) el número de observaciones exactas (censuradas). Entonces:\\[\n \\mathscr{L} = \\lambda^{r}e^{-\\lambda\\sum_{= 1}^{n}t_{}}\n\\]Si queremos un estimador para \\(\\lambda\\), hacemos:\\[\n\\frac{\\partial ln(\\mathscr{L})}{\\partial \\lambda} = \\frac{\\partial[r ln(\\lambda)-\\lambda\\sum_{= 1}^{n}t_{}]}{\\partial\\lambda} = \\frac{r}{\\lambda}-\\sum_{ =1}^{n}t_i = 0\n\\]\\[\n\\Longrightarrow \\hat{\\lambda} = \\frac{r}{\\sum_{= 1}^{n}t_{}}\n\\]Observe que si hay datos censurados entonces \\(\\sum_{= 1}^{n}\\delta_{}=n\\), por lo que \\(\\hat{\\lambda}=\\frac{1}{\\bar t}\\), y este es el estimador que conocemos desde el curso de inferencia.","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"ejemplo-8","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"Ejemplo","text":"El siguiente ejercicio fue basado en el ejercicio 3.6 del libro (Klein Moeschberger 2006). Los siguientes datos consisten en los tiempos de recaída y los tiempos de muerte después de la recaída de 10 pacientes con trasplante de médula ósea. Suponga que el tiempo hasta la recaída tiene una distribución exponencial con la tasa de riesgo \\(\\lambda\\).Calcule la tasa de recaída.\nCalcule la tasa de recaída.Calcule la probabilidad de recaer en 16 meses.\nCalcule la probabilidad de recaer en 16 meses.Sabemos que los estimadores máximo-verosímiles cumplen la propiedad de invarianza, de modo que:\\(\\hat{\\lambda} = \\frac{r}{\\sum_{= 1}^{n}t_{}} = \\frac{6}{\\sum_{= 1}^{10}t_{}} = \\frac{6}{180} = 3.3333333\\%\\)\\(\\hat{\\lambda} = \\frac{r}{\\sum_{= 1}^{n}t_{}} = \\frac{6}{\\sum_{= 1}^{10}t_{}} = \\frac{6}{180} = 3.3333333\\%\\)\\(\\hat S(16) = e^{-\\hat\\lambda t} = e^{-0.033(16)} = 0.5866463\\)\\(\\hat S(16) = e^{-\\hat\\lambda t} = e^{-0.033(16)} = 0.5866463\\)","code":""},{"path":"la-función-de-verosimilitud-con-censura-y-truncamiento.html","id":"modelo-weibull-1","chapter":"Capítulo 6 La Función de Verosimilitud con Censura y Truncamiento","heading":"Modelo Weibull","text":"Supongamos que se tienen los tiempos de fallo \\(T_{}\\) con censura, provenientes de una distribución Weibull:\\(f(t) = \\lambda \\gamma(\\lambda t)^{\\gamma-1}e^{-(\\lambda t)^\\gamma}\\)\\(S(t) = e^{-(\\lambda t)^\\gamma}\\)\\(h(t) = \\lambda \\gamma(\\lambda t)^{\\gamma-1}\\)Entonces, su respectiva función de verosimilitud es de la forma:\\[\n\\mathscr{L} = \\prod_{}^{n}\\left[\\lambda \\gamma(\\lambda t_i)^{\\gamma-1}e^{-(\\lambda t_i)^\\gamma}\\right]^{\\delta_i}\\left[e^{-(\\lambda t_i)^\\gamma}\\right]^{1-\\delta_i} = \\prod_{}^{n}\\left[\\lambda \\gamma(\\lambda t_i)^{\\gamma-1}\\right]^{\\delta_i}\\left[e^{-(\\lambda t_i)^\\gamma}\\right]\n\\]Por lo que:\\[\n\\ln(\\mathscr{L}) = \\sum_{=1}^{n}\\delta_i\\ln(\\lambda \\gamma(\\lambda t_i)^{\\gamma -1})-(\\lambda t_i)^\\gamma\n\\]Si suponemos que \\(r=\\sum_{= 1}^{n}\\delta_{}\\) y desarrollamos la expresión anterior, obtenemos:\\[\n\\ln(\\mathscr{L}) =r\\ln(\\lambda \\gamma)+(\\gamma -1)r\\ln (\\lambda)+(\\gamma -1)\\sum_{=1}^{n}\\delta_i\\ln(t_i)-\\lambda^{\\gamma}\\sum_{=1}^{n}t_i^{\\gamma}\n\\]Los estimadores máximo-verosímiles de \\(\\lambda\\) y \\(\\gamma\\) se obtienen derivando \\(\\ln(\\mathscr{L})\\) con respecto \\(\\lambda\\) y \\(\\gamma\\), igualando cero y evaluando en \\(\\hat \\lambda\\) y \\(\\hat \\gamma\\):\\[\n\\frac{\\partial \\ln(\\mathscr{L})}{\\partial \\lambda}=r\\frac{\\gamma}{\\lambda \\gamma}+\\frac{(\\gamma-1)r}{\\lambda}-\\gamma \\lambda^{\\gamma -1}\\sum_{=1}^{n}t_i^{\\gamma}=0\n\\]\\[\n\\frac{\\partial \\ln(\\mathscr{L})}{\\partial \\gamma}=r\\frac{\\lambda}{\\lambda \\gamma}+r\\ln(\\lambda)+\\sum_{=1}^{n}\\delta_i\\ln(t_i)-\\left[\\lambda^{\\gamma}\\ln(\\lambda)\\sum_{=1}^{n}t_i^{\\gamma}+\\lambda^\\gamma \\sum_{=1}^{n}t_i^{\\gamma}\\ln(t_i)\\right]=0\n\\]Simplificando ambas ecuaciones tenemos:\\[\nr\\gamma-\\gamma \\lambda^\\gamma\\sum_{=1}^{n}t_i^\\gamma=0\n\\]\\[\n\\frac{r}{\\gamma}+r\\ln(\\lambda)+\\sum_{=1}^{n}\\delta_i\\ln(t_i)-\\lambda^\\gamma\\left[\\ln(\\lambda)\\sum_{=1}^{n}t_i^{\\gamma}-\\sum_{=1}^{n}t_i^{\\gamma}\\ln(t_i)\\right]=0\n\\]Despejamos \\(\\lambda\\) de la primera ecuación:\\[\n\\hat\\lambda=\\left(\\frac{r}{\\sum_{=1}^{n}t_i^{\\hat\\gamma}}\\right)^{\\frac{1}{\\hat\\gamma}}\n\\]Y sustituyendo en la segunda ecuación:\\[\n\\begin{array}{cc}\n\\frac{r}{\\hat\\gamma}+r\\ln\\left(\\left(\\frac{r}{\\sum_{=1}^{n}t_i^{\\hat\\gamma}}\\right)^{\\frac{1}{\\hat \\gamma}}\\right)+\\sum_{=1}^{n}\\delta_i\\ln(t_i)&\\\\\n-\\left(\\frac{r}{\\sum_{=1}^{n}t_i^{\\hat \\gamma}}\\right)\\left[\\ln\\left(\\left(\\frac{r}{\\sum_{=1}^{n}t_i^{\\hat \\gamma}}\\right)^{\\frac{1}{\\hat \\gamma}}\\right)\\sum_{=1}^{n}t_i^{\\hat \\gamma}-\\sum_{=1}^{n}t_i^{\\hat \\gamma}\\ln(t_i)\\right]&=0\n\\end{array}\n\\]La expresión anterior es una ecuación lineal de \\(\\hat \\gamma\\), cuya solución es únicamente mediante un método numérico. Una vez que se ha obtenido el valor \\(\\hat \\gamma\\), éste se sustituye en \\(\\left(\\frac{r}{\\sum_{=1}^{n}t_i^{\\hat \\gamma}}\\right)^{\\frac{1}{\\hat \\gamma}}\\) para así obtener, finalmente, el valor de \\(\\hat \\lambda\\).Ecuaciones lineales, como hemos visto en el modelo Weibull, aparecen en la estimación de parámetros de las distribuciones Log-Normal, Log-Logística y Gamma; resulta que, al considerar datos con censura y truncamiento, las estimaciones se complican en los modelos paramétricos. obstante, tenemos ayuda de las computadoras y software que nos permitirán realizar estimaciones adecuadas.","code":""},{"path":"modelos-no-paramétricos-para-la-función-de-supervivencia.html","id":"modelos-no-paramétricos-para-la-función-de-supervivencia","chapter":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","heading":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","text":"Los métodos estadísticos más utilizados en el análisis de supervivencia son los Paramétricos. Debido que sólo cuando se conoce la distribución que siguen los tiempos de falla, las estimaciones con métodos paramétricos será adecuada. La eficiencia de los métodos paramétricos radica en que los datos sigan una distribución teórica.Puesto que nuestro interés es estimar \\(S(t)\\), en los métodos paramétricos las curvas de supervivencia, por lo general, se producen usando uno de dos métodos: el análisis actuarial o el método límite-producto de Kaplan-Meier.Es importante mencionar que, cuando hay datos censurados podemos estimar \\(S(t)\\) de manera sencilla mediante la función empírica:\\[\n\\hat S(t) = \\hat{\\mathbb{P}}(T>t) = \\frac{ \\# t_{}>t}{n}\n\\]donde la muestra aleatoria es: \\(t_{(1)}\\leq t_{(2)}\\leq...\\leq t_{(n)}\\).En este caso, la función será escalonada con decrementos \\(\\frac{1}{n}\\) si todas las observaciones son distintas, o con decrementos \\(\\frac{d}{n}\\) si hay \\(d\\) tiempos de falla iguales \\(t\\).Los métodos que se presentan continuación incluyen la percepción del censuramiento en los datos; quizá el alumno está familiarizado con alguno de ellos, pues se estudian en cursos previos.","code":""},{"path":"modelos-no-paramétricos-para-la-función-de-supervivencia.html","id":"método-actuarial-tabla-de-vida","chapter":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","heading":"7.1 Método Actuarial (Tabla de Vida)","text":"El análisis actuarial divide el tiempo en intervalos y calcula la supervivencia en cada intervalo. La longitud del intervalo depende de la frecuencia con que ocurre el suceso de interés.Se asume que:Todos los abandonos durante un intervalo dado ocurren aleatoriamente durante dicho intervalo.Las personas que se retiran del estudio tienen un destino parecido las que se quedan.El periodo de tiempo durante el cual una persona entra en el estudio tiene efecto en la respuesta.Dividimos el eje del tiempo en \\(k+1\\) intervalos \\(l_{j}=(a_{j-1},a_{j}]\\). Entonces para cada elemento de una muestra aleatoria de tamaño \\(n\\), se observa un tiempo de fallo \\(T\\) o un valor censurado por la derecha \\(C\\).Definimos:\\(n_{j}\\): número de individuos en riesgo (vivos o censurados) al tiempo \\(a_{j-1}\\).\\(d_{j}\\): número de fallas en el intervalo \\(l_{j}\\).\\(c_{j}\\): número de individuos que se censuran en el intervalo \\(l_{j}\\).El número de individuos sin falla al inicio de \\(l_{j}\\) es \\(n_{j}\\).Suponga que la función de supervivencia para los tiempos de falla es \\(S(t) = \\mathbb{P}(T>t)\\). Entonces:\\[\nS(a_{j}) = \\mathbb{P}(T>a_{j}) = \\mathbb{P}(T>a_{0})\\mathbb{P}(T>a_{1}|T>a_{0})...\\mathbb{P}(T>a_{j}|T>a_{j-1})\n\\]Sea:\\(S_{j} = S(a_{j})\\)\\(p_{j} = \\mathbb{P}(T>a_{j}|T>a_{j-1}) =\\frac{S_{j}}{S_{j-1}}\\) (Sobrevivencia hasta \\(a_{j}\\) después de haber sobrevivido hasta \\(a_{j-1}\\))\\(q_{j} = 1-p_{j} = \\mathbb{P}(T\\leq a_{j}|T>a_{j-1}) = \\frac{S_{j-1}-S_{j}}{S_{j-1}}\\) (sobrevivir hasta \\(a_{j}\\) después de haber sobrevivido hasta \\(a_{j-1}\\))Donde \\(S_{0} = 1\\), \\(S_{k+1} = 0\\), \\(q_{k+1} = 1\\). Por lo tanto:\\[\nS_{j} = p_{1}p_{2}...p_{j}\n\\]El objetivo es estimar \\(S_j\\) con base en la estimación de \\(p_j=1-q_j\\).Si en \\(l_{j}\\) hay observaciones censuradas, entonces estimamos \\(S_j\\) por medio de:\\[\n\\hat{q_{j}} = \\frac{d_{j}}{n_{j}}\n\\]Por otro lado, si en \\(l_{j}\\) hay observaciones censuradas, y suponiendo que las censuras se distribuyen uniformemente, entonces \\(S_j\\) se puede obtener mediante:\\[\n\\hat{q_{j}} = \\frac{d_{j}}{n_{j}-\\frac{c_{j}}{2}}\n\\]De modo que, para este caso, se tiene:\\[\n\\hat S_j=\\prod_{=1}^{j}\\left(1-\\frac{d_{}}{n_{}-\\frac{c_{}}{2}}\\right)\n\\]","code":""},{"path":"modelos-no-paramétricos-para-la-función-de-supervivencia.html","id":"ejemplo-9","chapter":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","heading":"Ejemplo","text":"El siguiente ejemplo es tomado del libro (Collett 2015), ejemplo 1.3 :Supervivencia de pacientes con myeloma múltiple.Myeloma múltiple es una enfermedad caracterizada por la acumulación múltiple de células plasmáticas anormales, un tipo de células blancas de la sangre, en la médula ósea. La proliferación de las células plasmáticas anormales dentro de los huesos causa dolor y la destrucción del tejido óseo. El objetivo de un estudio realizado en el Centro Médico de la Universidad del Oeste de Virginia, USA, fue examinar la asociación entre los valores de ciertas variables explicativas(covariables) y el tiempo de supervivencia de los pacientes. En el estudio, el tiempo de supervivencia fue medido en meses, desde el diagnóstico hasta la muerte por myeloma múltiple.La siguiente tabla muestra un fragmento de los resultados obtenidos en el estudio. En ésta se relaciona un total de 48 pacientes, todos ellos estaban entre los 50 y 80 años. Algunos de estos pacientes habían muerto durante el tiempo que el estudio fue completado, por lo que estos individuos contribuyeron con tiempos censurados por la derecha. La codificación del estatus de supervivencia de un individuo en la tabla es codificado con un \\(0\\) si la observación es censurada y \\(1\\) si fue muerte por myeloma.Ahora bien, se busca estimar \\(S(t)\\) mediante la construcción de la tabla de vida. La información registrada en otras variables explicativas será ignorada.Se consideran los intervalos de tiempo, para cada uno se calcula el número de pacientes que fallecieron \\(d_{j}\\),el número de datos censurados \\(c_{j}\\), el número en riesgo de muerte al inicio de cada uno de estos intervalos \\(n_{j}\\), y el número ajustado en riesgo \\(n_{j}^{*}=n_{j}-\\frac{c_{j}}{2}\\) (dado que hay datos censurados). Finalmente, la probabilidad de supervivencia en cada intervalo es estimada(multiplicando cada \\(p_j\\)).Los cálculos son presentados continuación:Y la curva de supervivencia es la dada en la figura 7.1:\nFigura 7.1: Supervivencia estimada para los pacientes con myeloma múltiple con el método actuarial\n","code":""},{"path":"modelos-no-paramétricos-para-la-función-de-supervivencia.html","id":"estimador-producto-límite-kaplan-meier","chapter":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","heading":"7.2 Estimador Producto-Límite (Kaplan-Meier)","text":"El estimador producto-límite fue propuesto por Kaplan y Meier en 1958 como el estimador máximo-verosímil de la función de supervivencia.El método de Kaplan-Meier calcula la supervivencia cada vez que un paciente muere. Da proporciones exactas de supervivencia debido que utiliza tiempos de supervivencia precisos.La característica distintiva del análisis con este método, es que la proporción acumulada que sobrevive se calcula para el tiempo de supervivencia individual de cada paciente, en contraste con la agrupación de los tiempos de supervivencia en intervalos hechos en la tabla de vida. Por esta razón es especialmente útil para estudios que utilizan un número pequeño de pacientes.Este método asume que:Las personas que se retiran del estudio tienen un destino parecido las que se quedan.El periodo de tiempo durante el cual una persona entra en el estudio tiene efecto independiente en la respuesta.","code":""},{"path":"modelos-no-paramétricos-para-la-función-de-supervivencia.html","id":"construcción-del-estimador-k-m","chapter":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","heading":"7.2.1 Construcción del Estimador K-M","text":"Es natural pensar \\(T\\) como una variable aleatoria continua, y por tanto, teóricamente es posible tener observaciones iguales. obstante, en la práctica los tiempos de supervivencia son medidos en escalas como: días, meses, años, etcétera; por lo que, hay posibilidad de tener observaciones repetidas. Por esta razón conviene modelar \\(T\\) como una variable aleatoria discreta. La idea del estimador K-M es la siguiente:Sea \\(T_{1}, T_{2},...,T_{n}\\) una m.. de una población discreta con soporte en \\(\\{u_{1}, u_{2},...\\}\\).La muestra observada de \\(T\\) se puede representar como \\((t_{},\\delta_{})\\) para \\(=1,2,...,n\\) donde:\\[\n\\delta_{} = \\left\\{\n\\begin{array}{ll}\n0 & \\mbox{si }  t_i \\ es \\ censurado\\\\\n1 & \\mbox{si }  t_{} \\ \\ es \\ censurado\n\\end{array}\n\\right.\n\\]\nEntonces la función de verosimilitud será:\\[ \n\\mathscr{L} = \\prod^{n}_{=1}f(t_{})^{\\delta_{}}S(t_{})^{1-\\delta_{}} \n\\]Desarrollando la expresión anterior tenemos\\[\n\\mathscr{L} =\\prod^{n}_{=1}(h(u_{k})S(u_{k-1})\\mathbb{1}_{t_{}=u_{k}})^{\\delta_{}} (S(u_{k})\\mathbb{1}_{k=max\\{j:u_{j}\\leq t_i\\}})^{1-\\delta_{}}\n\\]Sea\\[\n\\begin{split}\n & d_{k} = \\sum_{=1}^{n}\\mathbb{1}_{(t_{}=u_{k},\\delta_{}=1)} \\mbox{  (numero de tiempos de fallo iguales }u_{k}) \\\\\n & n_{k} = \\sum_{=1}^{n}\\mathbb{1}_{(t_{}\\geq{u_{k}})} \\mbox{ (numero de individuos en riesgo al tiempo } u_{k})\n\\end{split}\n\\]\\[\n\\Longrightarrow \\mathscr{L} = \\prod_{k} (h(u_k))^{d_k}(1-h(u_k))^{n_k-d_k}\n\\]Ahora maximizamos la función de verosimilitud para \\(h(u_k)\\):\\[\n\\ln (\\mathscr{L}) = \\sum_{k}\\{d_{k} \\ln(h(u_{k}))+(n_{k}-d_{k}) \\ln(1-h(u_{k}))\\} \n\\]\\[\n\\Longrightarrow \\frac{\\partial \\ln (\\mathscr{L})}{\\partial h(u_{k})} = \\frac{d_{k}}{h(u_{k})}-\\frac{(n_{k}-d_{k})}{(1-h(u_{k}))} = 0\n\\]despejando \\(h(u_k)\\) se tiene\\[\n\\therefore \\hat{h}(u_{k}) = \\frac{d_{k}}{n_{k}}\n\\]Dado que los estimadores máximo-verosímiles cumplen con el principio de invarianza, y ocupando que \\(S(t)=\\prod_{k:u_{k}\\leq t}(1-h(u_{k}))\\) (visto anteriormente) tenemos:\\[\n\\hat S(t)=\\prod_{k:u_{k}\\leq t}\\left(1-\\frac{d_k}{n_k}\\right)\n\\]Y es así es como se deriva el estimador K-M.Proposición: \\(\\mathbb{E}[\\hat{h}(u_k)] =h(u_k)\\) (Insesgamiento).","code":""},{"path":"modelos-no-paramétricos-para-la-función-de-supervivencia.html","id":"ejemplo-10","chapter":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","heading":"Ejemplo","text":"Se obtuvieron los tiempos de remisión de 20 pacientes con osteosarcoma, los que se trataba con 3 meses de quimioterapia después de amputación.11 pacientes recayeron los 6, 8, 10, 11, 12, 13, 13, 22, 32, 34 y 36 meses.8 pacientes se retiraron vivos al final del estudio contribuyendo 3, 7, 7, 11, 14, 16, 20 y 20 meses de observación, sin haber sufrido recaídas.Un paciente rehusó continuar la terapia los 11 meses y se retiró del estudio libre de enfermedad.La siguiente tabla muestra la forma de estimar \\(S(t)\\) por el método K-M:Y la gráfica de \\(\\hat S(t)\\) es:","code":""},{"path":"modelos-no-paramétricos-para-la-función-de-supervivencia.html","id":"ejercicio","chapter":"Capítulo 7 Modelos No Paramétricos para la Función de Supervivencia","heading":"Ejercicio","text":"Suponga que disponemos de los datos de supervivencia de 10 pacientes que han sido aleatoriamente asignados los tratamientos y B.: 3, 5, 7, 9+, 18B: 12, 19, 20, 20+, 33+Construya la función de supervivencia para cada tratamiento y grafíquelas. ¿Qué se puede decir de los tratamientos partir de las gráficas?","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"algunas-estimaciones-sobre-modelos-no-paramétricos","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","text":"Cuando se emplean los modelos paramétricos, es necesario hacer inferencia más allá de la estimación puntual. Para tal propósito, conocer la varianza de algunos estimadores de interés, resulta de gran ayuda.","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"estimación-de-la-varianza-para-el-estimador-de-st","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.1 Estimación de la Varianza para el Estimador de \\(S(t)\\)","text":"","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"tabla-de-vida","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.1.1 Tabla de Vida","text":"Para la tabla de vida se tienen los siguientes resultados:\\[\n\\begin{array}{ll}\n\\hat{q_j} = \\frac{d_{j}}{n_{j}-\\frac{c_{j}}{2}} &  \\hat{S_{j}}=\\prod_{=1}^{j}\\left(1-\\frac{d_{}}{n_{}-\\frac{c_{}}{2}}\\right)\\\\\n\\end{array}\n\\]Entonces un estimador de la varianza para \\(\\hat{S_j}\\) es:\\[\n \\hat{Var}(\\hat{S}_{j}) = \\hat{S}_{j}^2\\sum_{= 1}^{j}\\frac{\\hat{q_i}}{\\hat{p_i}(n_{}-\\frac{c_{}}{2})}\n\\]Si deseamos obtener intervalos de confianza puntuales para \\(S(t)\\), podemos partir de la distribución asintótica de \\(\\hat{S_j}\\):\\[\n\\hat{S}_j \\sim N(S_{j}, \\hat{Var}(\\hat{S_{j}}))\n\\]De donde, un intervalo de confianza para \\(S(t_j)\\) al \\((1-\\alpha)*100\\%\\) es:\\[\n\\hat S_j \\pm Z_{1-\\frac{\\alpha}{2}} \\sqrt{\\hat{Var}(\\hat S_j)}\n\\]","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"kaplan-meier","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.1.2 Kaplan-Meier","text":"Partiendo de que\\[\n\\hat{S}(t) = \\prod_{k:u_k \\leq t}(1-h_{k})\n\\]Si aplicamos \\(\\ln\\) tenemos:\\[\n\\ln(\\hat{S(t)}) = \\sum_{k:u_k \\leq t} \\ln(1-h_k)\n\\]\\[\n\\Longrightarrow Var(\\ln(\\hat{S}(t))) = \\sum_{k:u_k \\leq t} Var(\\ln(1-h_k))\n\\]Desarrollando con series de Taylor (método Delta) se obtiene:\\[\nVar(\\hat{S}(t)) = \\hat{S}^2(t)\\sum_{k:u_k \\leq t}\\frac{Var(\\hat{h}_k)}{(1-\\hat{h}_{k})^2}\n\\]Uno de los estimadores más comunes para \\(Var(\\hat{S}(t))\\) es el estimador de Greenwood; éste supone que el número de individuos que sobreviven lo largo del intervalo que empieza en \\(t_j\\) tiene una distribución Binomial con parámetros \\(n_j\\) y \\(p_j\\) (\\(p_j\\) es la verdadera probabilidad de supervivencia lo largo del intervalo). De manera que, el estimador Greenwood es:\\[\n\\hat{Var}(\\hat{S}(t)) \\approx \\hat{S}^2(t) \\sum_{j:t_{j}\\leq t}\\frac{d_{j}}{n_{j}(n_{j}-d_{j})}\n\\]El estimador del error estándar será: \\(\\sqrt{\\hat{Var}(\\hat{S}(t))}\\).El estimador del error estándar será: \\(\\sqrt{\\hat{Var}(\\hat{S}(t))}\\).Cuando \\(n\\rightarrow\\infty\\), \\(\\hat{S}(t)\\) tiene una distribución normal: \\(\\hat{S}(t)\\sim N(S(t), Var(\\hat{S}(t)))\\).Cuando \\(n\\rightarrow\\infty\\), \\(\\hat{S}(t)\\) tiene una distribución normal: \\(\\hat{S}(t)\\sim N(S(t), Var(\\hat{S}(t)))\\).El intervalo puntual al \\((1-\\alpha)*100\\%\\) de confianza para \\(S(t_{0})\\) será: \\(\\hat{S}(t_{0}) \\pm Z_{1-\\alpha/2} \\sqrt{\\hat{Var}(\\hat{S}(t_0))}\\)8.El intervalo puntual al \\((1-\\alpha)*100\\%\\) de confianza para \\(S(t_{0})\\) será: \\(\\hat{S}(t_{0}) \\pm Z_{1-\\alpha/2} \\sqrt{\\hat{Var}(\\hat{S}(t_0))}\\)8.Para este último punto, pueden existir ocasiones en las que el intervalo de confianza se encuentre fuera del rango \\([0,1]\\), por lo que existen diferentes aproximaciones para resolver dicho problema. Una de ellas es mejorando la aproximación la distribución normal (ya que se menciono previamente que : \\(\\hat{S}(t)\\sim N(S(t), Var(\\hat{S}(t)))\\)) utilizando la transformación \\(log-log\\), obteniendo así la siguiente expresión:\\[\n\\hat{S}(t_{0}) \\pm e^{Z_{1-\\alpha/2} \\frac{\\sqrt{\\hat{Var}(\\hat{S}(t_0))}}{\\hat{S}(t_{0})\\ln(\\hat{S}(t_{0}))}}\n\\]Otra alternativa es utilizando una transformación logarítmica para obtener lo siguiente\\[\n\\exp\\left(\\ln(\\hat{S}(t_{0})) \\pm Z_{1-\\alpha/2} \\frac{\\sqrt{\\hat{Var}(\\hat{S}(t_0))}}{\\hat{S}(t_{0})}\\right)\n\\]","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"ejercicio-1","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Ejercicio","text":"Un estudio consistió en medir el tiempo(en meses) en que los pacientes desarrollaron un cierto tipo de tumor. Los resultados que se obtuvieron fueron:\\[\n10,13^+,18^+,19,23^+,30,36,38^+,54^+,56^+,59,75,93,97,104^+,107,107^+,107^+\n\\]La siguiente tabla muestra \\(\\hat S(t)\\) por el método de K-M, además de los intervalos de confianza puntuales utilizando el estimador de Greenwood:La gráfica correspondiente es:","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"estimadores-de-la-función-de-riesgo-acumulada","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.2 Estimadores de la Función de Riesgo Acumulada","text":"Recordemos que:\\[\nH(t)=-log(S(t)) \n\\]Entonces podemos estimar \\(H(t)\\) de una manera sencilla (\\(\\hat{S}(t)\\) es obtenido por K-M):\\[\n\\hat{H_1}(t) = -log(\\hat{S}(t))\n\\]obstante, una alternativa para conocer \\(H(t)\\) es utilizar el estimador Nelson-Aalen. Este estimador resulta útil primordialmente en el análisis de datos para la selección entre modelos paramétricos para el tiempo de fallo \\(T\\), además proporciona un estimador para \\(h(t)\\). El estimador Nelson-Aalen asume que \\(H(t)\\) es la suma de riesgos, esto es:\\[\nH(t)=\\sum_{j:u_{j}\\leq t} h_j\n\\]Entonces el estimador de \\(H(t)\\) será:\\[\n\\hat{H_2}(t)=\\sum_{j:u_{j}\\leq t} \\hat h_j=\\sum_{j:u_{j}\\leq t}\\frac{d_j}{n_j}\n\\]Observe que si tomamos \\(\\hat H_2(t)\\), podemos estimar de otra manera \\(S(t)\\). Es decir, \\(S(t)\\), usando Nelson-Aalen, se obtiene el estimador Fleming-Harrington, el cual es:\\[\n\\hat{S_2}(t) = exp\\{-\\hat{H_2}(t)\\} = exp\\left\\{-\\sum_{j:u_{j}\\leq t}\\frac{d_j}{n_j}\\right\\}\n\\]Un estimador de la varianza de \\(\\hat{H_2}(t)\\) es:\\[\n\\hat{Var}(\\hat{H_2}(t)) = \\sum_{j:t_{j}\\leq t}\\frac{d_j}{n_{j}^{2}}\n\\]Y el intervalo de confianza puntual al \\((1-\\alpha)*100\\%\\) para \\({H_2}(t_0)\\) es:\\[\n\\hat{H_2}(t_{0}) \\pm Z_{1-\\alpha/2} \\frac{\\sqrt{\\hat{Var}\\{\\hat{H_2}(t)\\}}}{\\hat{H_2}(t_{0})}\n\\]","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"ejemplo-11","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Ejemplo","text":"Siguiendo con el ejemplo anterior, que mide el tiempo (en meses) en que los pacientes desarrollaron un cierto tipo de tumor.La tabla muestra \\(\\hat S(t)\\) por el método de K-M, entonces podemos calcular \\(\\hat {H}_1(t)=-log(\\hat S(t))\\). Y por otro lado usar el estimador Nelson-Aalen para obtener \\(\\hat{H}_2(t)\\).","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"estimación-puntual-de-la-media","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.3 Estimación Puntual de la Media","text":"Puede ser de interés estudiar algunos parámetros poblacionales que dependen de la función de supervivencia. Por ejemplo: la media, la mediana y cualquier cuantil o percentil.Hemos visto en la sección 4.1 que:\\[\n\\mu = \\int_{0}^{\\infty}S(t)dt\n\\]Entonces podemos reemplazar \\(S(t)\\) con el estimador de \\(\\hat{S}(t)\\)(obtenido por K-M), por lo que:\\[\n\\hat{\\mu}=\\int_{0}^{\\infty}\\hat{S}(t)dt\n\\]Observación: El estimador será apropiado si la observación más grande del conjunto de datos es un tiempo de falla y una observación censurada.Si la última observación(la más grande) es una observación censurada, entonces \\(\\hat{\\mu}\\) se calcula como:\\[\n\\hat{\\mu}_{\\tau} =\\int_{0}^{\\tau}\\hat{S}(t)dt\n\\]Donde \\(\\tau\\) es el valor que determina el tiempo más grande al que una persona puede sobrevivir.Un estimador de la varianza de \\(\\hat{\\mu}_{\\tau}\\) con \\(t_{1}, t_{2},...,t_{k}\\) tiempos de fallo observados, es:\\[\n\\hat{Var}(\\hat{\\mu_\\tau}) = \\sum_{= 1}^{k}\\left\\{\\int_{t_i}^{\\tau}\\hat{S}(t)dt\\right\\}^2 \\cdot \\frac{d_{}}{n_{}(n_{}-d_{})}\n\\]El intervalo al \\((1-\\alpha)100\\%\\) de confianza para \\(\\mu_\\tau\\) es:\\[\n\\hat\\mu_{\\tau} \\pm Z_{1-\\alpha/2}\\sqrt{\\hat{Var}(\\hat\\mu_\\tau)}\n\\]NOTA: Es importante que, cuando se esté calculando la media de supervivencia \\(\\hat\\mu_{\\tau}\\), se verifique que el último valor sea censurado y se observe en qué intervalo se está calculando la media.","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"estimación-de-cuantiles","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.4 Estimación de Cuantiles","text":"Recordemos que los cuantiles de orden \\(p\\), \\(t_p\\), es el mínimo valor \\(t\\) tal que \\(S(t)\\leq 1-p\\). Usando el estimador \\(\\hat{S}(t)\\) obtenido por K-M, tenemos:\\[\n\\hat{t}_p = inf\\{t:\\hat{S}(t)\\leq 1-p\\}\n\\]Por lo que, si deseamos calcular la mediana estimada:\\[\n\\hat{t}_{0.5} = inf\\{t:\\hat{S}(t)\\leq 0.5\\}\n\\]","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"bandas-de-confianza-para-la-función-de-supervivencia","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.5 Bandas de Confianza para la Función de Supervivencia","text":"Deseamos encontrar dos v.. \\(L(t)\\) y \\(U(t)\\) tales que:\\[\n\\begin{array}{ll}\n\\mathbb{P}(L(t)\\leq S(t)\\leq U(t)) = 1-\\alpha & \\forall t_{L}\\leq t\\leq t_{U}\\\\\n\\end{array}\n\\]Entonces \\([L(t), U(t)]\\) serán las bandas al \\((1-\\alpha)*100\\%\\) de confianza de \\(S(t)\\). Puede usted decir ¿cuál es la diferencia entre bandas de confianza e intervalos de confianza puntuales?Hay dos métodos de aproximación para las bandas de confianza. La primera aproximación fue propuesta por Nair (Nair 1984) y esencialmente proporciona límites de confianza que son proporcionales los intervalos de confianza puntuales, estas bandas son llamadas bandas de probabilidad iguales o bandas EP9. Caso contrario, la segunda aproximación, propuesta por Hall y Wellner10 (Hall Wellner 1980), establece bandas proporcionales los intervalos de confianza puntuales.Nuestro interés es obtener las bandas de confianza para \\(S(t)\\); afortunadamente hoy en día se cuenta con software que nos ayuda en dicha tarea, específicamente en R es sencillo obtenerlo.","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"diagnóstico-para-el-uso-de-modelos-paramétricos","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.6 Diagnóstico para el Uso de Modelos Paramétricos","text":"Si existe la necesidad de encontrar un modelo paramétrico que ajuste “bien” los datos, se pueden emplear algunos métodos gráficos que nos den algunos indicios sobre la posible distribución de los datos. Tales indicios pueden ser proporcionados por los métodos paramétricos.","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"gráficas-de-las-funciones-de-supervivencia","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.6.1 Gráficas de las Funciones de Supervivencia","text":"Se conoce la función de supervivencia paramétrica \\(S(t ;\\theta)\\) y se tiene un estimador \\(\\hat \\theta\\). Si el modelo paramétrico es adecuado entonces \\(S(t ;\\hat {\\theta})\\) y \\(\\hat S(t)\\)(estimada por K-M) deben ser similares.","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"ejemplo-12","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Ejemplo","text":"Se tienen los siguientes tiempos de supervivencia:\\[\n8,5,10^+,1,3,18,22,15,25^+,19\n\\]Se desea saber si estos datos ajustan un modelo exponencial con \\(\\lambda =0.06\\). Realizamos las gráficas de supervivencia:De acuerdo la gráfica anterior, ¿Existe algún indicio de que los datos siguen una distribución exponencial con \\(\\lambda =0.06\\)?","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"gráfica-p-p","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.6.2 Gráfica \\(P-P\\)","text":"Si el modelo paramétrico es adecuado entonces los puntos:\\[\n\\left(S(t_j ;\\hat{\\theta}),\\hat S(t_j)\\right)\n\\]Deberán caer en la recta identidad (\\(\\hat S(t_j)\\) es estimada por K-M). Es llamada gráfica \\(P-P\\) pues se gráfica Probabilidad vs Probabilidad.","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"ejemplo-13","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Ejemplo","text":"Tomando los datos del ejemplo anterior, queremos ver si los datos se distribuyen posiblemente exponencial con \\(\\lambda =0.06\\). Si hacemos la gráfica P-P se tiene:De acuerdo la gráfica \\(P-P\\), ¿Es el modelo exponencial con \\(\\lambda=0.06\\) adecuado los datos?","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"gráfica-q-q","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.6.3 Gráfica \\(Q-Q\\)","text":"La gráfica \\(Q-Q\\) consiste en graficar diversos cuantiles de los datos vs diversos cuantiles del modelo paramétrico propuesto. Si el modelo teórico propuesto es “adecuado” los datos entonces la gráfica será cercana la función identidad.continuación se muestra un ejemplo de la gráfica \\(Q-Q\\):","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"linearización-de-la-función-de-supervivencia","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"8.6.4 Linearización de la Función de Supervivencia","text":"Cuando tenemos un modelo paramétrico \\(S(t;\\theta)\\) pero conocemos \\(\\hat{\\theta}\\) podemos hacer linearización de la función de supervivencia. Es decir, si existen \\(g_1\\) y \\(g_2\\) tales que \\(g_1\\{S(t;\\theta)\\}\\) es una función lineal de \\(g_2(t)\\) entonces podemos graficar \\(g_1(\\hat{S}(t))\\) vs \\(g_2(t)\\). Y si la familia paramétrica es adecuada, la gráfica se aproxima una linea recta. Para este método gráfico se utiliza el estimador Nelson-Aalen para \\(\\hat S(t)\\).","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"modelo-exponencial-2","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Modelo Exponencial","text":"Tenemos que:\\[\nS(t)=e^{-\\lambda t}\n\\]\\[\n\\Longrightarrow log\\{S(t)\\}=-\\lambda t  \n\\]De manera que \\(g_1=log\\{S(t)\\}\\) y \\(g_2=t\\). Entonces debemos graficar \\(log(\\hat S(t))\\) vs \\(t\\), y si los datos se ajustan un modelo exponencial, dicha gráfica debe ser aproximadamente una linea recta con pendiente \\(-\\lambda\\).","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"ejemplo-14","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Ejemplo","text":"Consideremos los datos: \\(8,5,10^+,1,3,18,22,15,25^+,19\\), veamos si se pueden ajustar posiblemente un modelo exponencial través de la gráfica de linearización. Entonces tenemos:¿Qué puede decir partir de la gráfica anterior?, ¿Puede asumirse que los datos se ajustan un modelo exponencial?","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"modelo-weibull-2","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Modelo Weibull","text":"Para el modelo Weibull tenemos que:\\[\nS(t)=e^{-(\\lambda t)^{\\gamma}}\n\\]\\[\n\\Longrightarrow -log\\{S(t)\\}=(\\lambda t)^{\\gamma}\n\\]\\[\n\\Longrightarrow log\\{-log\\{S(t)\\}\\}=\\gamma (log(\\lambda)+log(t))\n\\]Entonces \\(g_1=log\\{-log\\{S(t)\\}\\}\\) y \\(g_2=log(t)\\). Por lo que debemos graficar \\(log\\{-log\\{\\hat S(t)\\}\\}\\) vs \\(log(t)\\), y si los datos se ajustan un modelo Weibull, la gráfica debe ser aproximadamente una linea recta con intercepto \\(\\gamma log(\\lambda)\\) y pendiente \\(\\gamma\\).","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"modelo-log-logístico-1","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Modelo Log-Logístico","text":"La función de supervivencia es:\\[\nS(t)=(1+\\lambda t^{\\alpha})^{-1}\n\\]\\[\n\\Longrightarrow -log\\{S(t)\\}=log(1+\\lambda t^{\\alpha})\n\\]\\[\n\\Longrightarrow log\\{exp\\{-log\\{S(t)\\}\\}-1\\}=log(\\lambda)+\\alpha log(t)\n\\]La gráfica de diagnóstico es: \\(log\\{exp\\{-log\\{\\hat S(t)\\}\\}-1\\}\\) vs \\(log(t)\\). Si el modelo Log-Logístico es adecuado los datos, entonces la gráfica es aproximadamente una linea recta con intercepto \\(log(\\lambda)\\) y pendiente \\(\\alpha\\).","code":""},{"path":"algunas-estimaciones-sobre-modelos-no-paramétricos.html","id":"modelo-log-normal-1","chapter":"Capítulo 8 Algunas Estimaciones sobre Modelos No Paramétricos","heading":"Modelo Log-Normal","text":"Para este modelo, la gráfica que debemos emplear para el diagnóstico es \\(\\Phi^{-1}[1-exp(-log(\\hat S(t)))]\\) vs \\(log(t)\\), donde \\(\\Phi^{-1}\\) son los cuantiles de una Normal estándar. Una linea recta(aproximadamente) indica una posible distribución Log-Normal en los datos.Los métodos gráficos que hemos visto son una herramienta que proporcionan indicios sobre la posible distribución de los datos(si nuestro interés es encontrar un modelo paramétrico). Evidentemente una gráfica demuestra nada por lo que tendríamos que realizar pruebas formales de bondad de ajuste (pruebas que consideren la censura y/o truncamiento).","code":""},{"path":"pruebas-de-hipótesis.html","id":"pruebas-de-hipótesis","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"Capítulo 9 Pruebas de Hipótesis","text":"Las pruebas de hipótesis juegan un papel importante en la inferencia estadística. En el contexto del análisis de supervivencia, resulta primordial comparar poblaciones en cuanto sus funciones de supervivencia, pues de ello podemos saber, por ejemplo, la eficacia de un tratamiento respecto otro, los tiempos de aparición de un tumor en dos grupos, entre otras cosas.El objetivo de la comparación de poblaciones en el análisis de supervivencia es similar aquellos procedimientos diseñados para comparar estadísticos provenientes de muestras independientes, como la prueba t, la prueba de los signos, la prueba U de Mann-Whitney(1947), la prueba de Kruskal-Wallis(1952), etcétera. Todas estas pruebas de comparación se utilizan para evaluar diferencias entre estadísticos que han sido estimados basados en la información que se obtiene de subgrupos poblacionales independientes entre si. obstante, dichas pruebas consideran la censura en los datos, y por esta razón se imposibilita su aplicación “directa” en datos de supervivencia.Las pruebas más utilizadas para comparar funciones de supervivencia, las cuales consideran la censura en los datos, son: la prueba Log-Rank propuesta por Mantel-Haenszel(1959), la prueba generalizada de Wilcoxon propuesta por Gehan(1965), la prueba de Peto-Peto(1972), la prueba de Tarone-Ware(1977), la prueba de Harrington-Fleming(1982) que generaliza parte de las pruebas anteriores y una versión más general propuesta por Fleming et al. (1987). En esta sección veremos la prueba de Log-Rank y la prueba generalizada de Wilcoxon, que esencialmente son la misma salvo una ponderación.","code":""},{"path":"pruebas-de-hipótesis.html","id":"comparación-de-1-población","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"9.1 Comparación de 1 población","text":"Suponiendo que la tasa de riesgo real en la población estudiada es \\(h(t)\\), el objetivo en esta prueba es determinar, estadisticamente, si la tasa de riesgo \\(h_0(t)\\), la cual está completamente especificado en el intervalo \\((0,\\tau)\\), es adecuada para las observaciones tratar para un tiempo fijo \\(\\tau\\), es decir:\\[\n\\begin{array}{ccc}\nH_0:h(t) = h_0(t)\\ \\forall \\ t\\leq \\tau&vs& H_a:h(t) \\neq h_0(t);\\ \\mbox{ p.} \\ t\\leq \\tau\n\\end{array}\n\\]Recordando que el estimador de la función de riesgo acumulado es \\(\\hat{H}_2(t) = \\sum_{t_{}\\leq t}\\frac{d_i}{n_i}\\), entonces \\(\\frac{d_i}{n_i}\\) es un estimador de la tasa de riesgo en \\(t_i\\).Cuando la hipótesis nula es cierta, el valor esperado de la tasa de riesgo en \\(t_i\\) es \\(h_0(t_i)\\). Ahora, sea \\(\\omega(t)\\) la función de pesos tal que \\(\\omega(t) = 0\\) si \\(n_t = 0\\), es decir que se otorga algún peso cuando hay elementos en dicho tiempo.Considerando el clásico estadístico de prueba \\(Z(\\tau) = O(\\tau)-\\mathbb{E}(\\tau)\\) (elementos observados menos esperados)11 y considerando que \\(D\\) es el número de tiempos en la muestra, se tiene lo siguiente:\\[\nZ(\\tau) = O(\\tau)-\\mathbb{E}(\\tau) = \\sum_{= 1}^D\\omega(ti)\\frac{d_i}{n_i}-\\int_0^{\\tau}\\omega(s)h_0(s)ds\n\\]\nSólo para confirmar, \\(O(\\tau)\\) representa el número de eventos al tiempo \\(\\tau\\). Cuando \\(H_0\\) es cierta\\[\nVar(Z(\\tau)) = \\int_0^{\\tau}\\omega^2(s)\\frac{h_0(s)}{n_s}ds\n\\]Entonces, para muestras grandes el siguiente estadístico tiene una distribución \\(\\chi^2_{(1)}\\)12.\\[\nT = \\frac{[Z(\\tau)]^2}{Var(Z(\\tau))}\\sim\\chi^2_{(1)}\n\\]Cuando \\(\\tau\\) es igual al tiempo mayor en el estudio:\\[\n\\mathbb{E}[\\tau] = Var(Z(\\tau)) = \\sum_{j = 1}^n\\left(H_0(T_j)-H_0(L_j)\\right)\n\\]donde \\(H_0(t)\\) es la función de riesgo acumulado bajo la hipótesis nula, \\(L_j\\) es la edad de entrada y \\(T_j\\) la edad de salida.","code":""},{"path":"pruebas-de-hipótesis.html","id":"ejemplo-15","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"Ejemplo","text":"Se tiene una muestra de 26 pacientes con cierta enfermedad. Se desea probar que la tasa de riesgo es similar la tasa de mortalidad de la población de Iowa en 1960. Realizando los cálculos correspondientes, se tiene lo siguiente\\[\nZ(\\tau) = O(26)-\\mathbb{E}(26) = 15-4.4740\\implies T=\\frac{(15-4.4740)^2}{4.4740} = 24.76457\n\\]El \\(p-value\\) de \\(T = 24.76457\\) (6.4777279e-07) es cercano cero \\(\\implies\\) se rechaza la hipótesis nula. \\(\\therefore\\) La tasa de riesgo es similar la tasa de mortalidad de Iowa en 1960.","code":""},{"path":"pruebas-de-hipótesis.html","id":"prueba-log-rank","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"9.2 Prueba Log-Rank","text":"Mantel-Haenszel(1959) propusieron un estadístico que permite relacionar las pruebas de asociación de las tablas de contingencia con los contrastes de igualdad de funciones de supervivencia entre subgrupos poblacionales.Suponga que se quiere contrastar las funciones de supervivencia de dos grupos poblacionales, digamos Grupo 1 y Grupo 2:\\[\n\\begin{array}{lllll}\nH_{0}:S_{1}(t) = S_{2}(t) & \\forall t>0 & vs & H_{}:S_{1}(t) \\neq S_{2}(t) & \\mbox{p.} t>0\\\\\n\\end{array}\n\\]Suponga además que hay \\(k\\) tiempos diferentes de ocurrencia del evento(fallas) en el grupo combinado, digamos: \\(t_{(1)},t_{(2)}, ... ,t_{(k)}\\) y que en el momento \\(t_i\\) ocurren \\(d_{1i}\\) eventos en el primer grupo y \\(d_{2i}\\) eventos en el segundo, para todo \\(=1,2,...,k\\). En cada momento \\(t_i\\), hay \\(n_{1i}\\) individuos en riesgo en el primer grupo y \\(n_{2i}\\) individuos en el segundo.En consecuencia, en el momento \\(t_i\\) habrá \\(d_i=d_{1i}+d_{2i}\\) (fallas totales) y \\(n_i=n_{1i}+n_{2i}\\) (total de individuos en riesgo). La siguiente tabla muestra el número de ocurrencias del evento en el momento \\(t_i\\), para el Grupo 1 y Grupo 2:Si se considera que en el momento \\(\\)-ésimo se tiene una población formada por dos grupos, Grupo 1 y Grupo 2, y se define la variable aleatoria \\(d_{1i}\\) como el número de eventos que ocurren en el Grupo 1 en el momento \\(t_i\\). En ese momento se tiene una población de tamaño \\(n_i\\) definida por el total de individuos en riesgo, clasificada en dos subpoblaciones de tamaños \\(n_{1i}\\) (Grupo 1) y \\(n_{2i}\\) (Grupo 2).Si se asume que el número de fallas \\(d_i\\) para los dos grupos combinados es una muestra aleatoria(sin reemplazo) de la población anterior, entonces la v.. \\(d_{1i}\\) sigue una distribución hipergeométrica(\\(n_{},d_{},n_{1i}\\)) cuya media y varianza son:\\[\ne_{1i} = \\mathbb{E}(d_{1i}) = n_{1i} \\frac{d_{}}{n_{}}\n\\]\\[\nV_{1i}= Var(d_{1i}) = \\frac{n_{1i}n_{2i}d_{}(n_{}-d_{})}{n_{}^2(n_{}-1)}\n\\]La hipótesis nula \\(H_0\\) que se desea probar es que hay diferencia entre las funciones de supervivencia de ambos grupos, lo que se logra evaluando la diferencia entre el número de fallas observadas y el número de fallas esperadas en cada uno de los momentos de ocurrencia, bajo los supuestos de \\(H_0\\). Esto es equivalente comparar el número de fallas ocurridas en cualquiera de los grupos con respecto al número de fallas esperadas en el grupo combinado.De manera que, la prueba Log-Rank se basa en el estadístico:\\[\nU_{L} = \\sum_{= 1}^{k}(d_{1i}-e_{1i})\n\\]Entonces bajo \\(H_0\\) (las supervivencias en las dos poblaciones son iguales) tenemos que : \\(\\mathbb{E}(U_{L}) = 0\\) y \\(Var(U_{L}) = \\sum_{=1}^{k}V_{1i}\\). En consecuencia:\\[\nL = \\frac{U_L-\\mathbb{E}(U_{L}) }{\\sqrt{Var(U_{L})}}= \\frac{\\sum_{= 1}^k(d_{1i}-e_{1i})}{\\sqrt{\\sum_{=1}^{k}V_{1i}}} \\sim N(0,1)\n\\]\\[\n\\Longrightarrow L^2= \\frac{(\\sum_{= 1}^k(d_{1i}-e_{1i}))^2}{\\sum_{=1}^{k}V_{1i}} \\sim \\chi^2_{(1)}\n\\]Finalmente, la estadística que ocuparemos para la prueba Log-Rank es:\\[\nL^2= \\frac{(\\sum_{= 1}^k(d_{1i}-e_{1i}))^2}{\\sum_{=1}^{k}V_{1i}}\n\\]La Regla de Decisión es rechazar \\(H_0\\) al nivel de significancia \\(\\alpha\\) si:\\[\nL^2>J_{1-\\alpha}\n\\]Donde \\(J_{1-\\alpha}\\) es el cuantil \\(1-\\alpha\\) de una \\(\\chi^2_{(1)}\\). Recordemos que la regla de decisión puede obtenerse, también, través del \\(p-value\\).La prueba Log-Rank es muy potente para detectar diferencias cuando los logaritmos de las funciones de supervivencia son proporcionales, obstante, la potencia de la prueba disminuye cuando las funciones de supervivencia se cruzan.","code":""},{"path":"pruebas-de-hipótesis.html","id":"ejemplo-16","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"Ejemplo","text":"Se tienen los tiempos de remisión (en semanas) para dos grupos de pacientes con leucemia. Cada grupo se conforma por 21 pacientes.La forma de la función de supervivencia para cada grupo es:Las funciones de supervivencia de los dos grupos “parecen” tener diferencia, de acuerdo la gráfica anterior. obstante, debemos comprobar si es una diferencia significativa. Enseguida corroboraremos tal afirmación mediante la prueba Log-Rank.La siguiente tabla muestra los individuos que fallan y los individuos en riesgo de cada grupo para cada tiempo \\(t_i\\) (\\(=1,2,...,k\\)), donde \\(k\\)=17. Además, se muestran los cálculos de las fallas esperadas para la construcción del estadístico Log-Rank:Entonces el estadístico Log-Rank es:\\[\nL^2=\\frac{(\\sum_{= 1}^k(d_{1i}-e_{1i}))^2}{\\sum_{=1}^{k}V_{1i}}=\\frac{(-10.25)^2}{6.26}=16.78\n\\]Para \\(\\alpha=0.05\\) tenemos que \\(J_{0.95}=3.8414\\) por lo que:\\[\nL^2=16.78>J_{0.95}=3.8414\n\\]Por lo tanto, se rechaza \\(H_0\\) y se concluye que existe diferencia significativa entre las funciones de supervivencia para el Grupo 1 (Tratamiento) y el Grupo 2 (Placebo).","code":""},{"path":"pruebas-de-hipótesis.html","id":"prueba-generalizada-wilcoxon","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"9.3 Prueba Generalizada Wilcoxon","text":"Se considera la hipótesis probar:\\[\n\\begin{array}{lllll}\nH_{0}:S_{1}(t) = S_{2}(t) & \\forall t>0 & vs & H_{}:S_{1}(t) \\neq S_{2}(t) & \\mbox{p.} t>0\\\\\n\\end{array}\n\\]La prueba generalizada de Wilcoxon es una generalización de la prueba Log-Rank; Wilcoxon añade una ponderación las fallas observadas menos las fallas esperadas. El estadístico en el que se basa la prueba de Wilcoxon es:\\[\nU_{w} = \\sum_{= 1}^k n_{}(d_{1i}-e_{1i})\n\\]Bajo la hipótesis nula \\(H_0\\) tenemos que \\(\\mathbb{E}(U_{w}) = 0\\) y \\(V_{w} = Var(U_{w}) = \\sum_{=1}^{k}n_{}^2V_{1i}\\). En consecuencia:\\[\nW=\\frac{U_w-\\mathbb{E}(U_{w})}{\\sqrt{V_{w}}}=\\frac{\\sum_{= 1}^k n_{}(d_{1i}-e_{1i})}{\\sqrt{\\sum_{=1}^{k}n_{}^2V_{1i}}} \\sim N(0,1)\n\\]\\[\n\\Longrightarrow W^2= \\frac{(\\sum_{= 1}^k n_{}(d_{1i}-e_{1i}))^2}{\\sum_{=1}^{k}n_{}^2V_{1i}} \\sim \\chi^2_{(1)}\n\\]Entonces, la estadística que consideraremos para la prueba generalizada de Wilcoxon será:\\[\nW^2= \\frac{(\\sum_{= 1}^k n_{}(d_{1i}-e_{1i}))^2}{\\sum_{=1}^{k}n_{}^2V_{1i}}\n\\]La Regla de Decisión es rechazar \\(H_0\\) al nivel de significancia \\(\\alpha\\) si:\\[\nW^2>J_{1-\\alpha}\n\\]Donde \\(J_{1-\\alpha}\\) es el cuantil \\(1-\\alpha\\) de una \\(\\chi^2_{(1)}\\).","code":""},{"path":"pruebas-de-hipótesis.html","id":"ejercicio-2","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"Ejercicio","text":"Realice la prueba generalizada de Wilcoxon de acuerdo los datos del ejemplo de la sección anterior.","code":""},{"path":"pruebas-de-hipótesis.html","id":"comparación-de-m-poblaciones","chapter":"Capítulo 9 Pruebas de Hipótesis","heading":"9.4 Comparación de \\(m\\) Poblaciones","text":"Si deseamos comparar las funciones de supervivencia de \\(m\\) poblaciones planteamos la siguiente hipótesis:\\[\nH_0:S_1(t) = S_2(t) = ... = S_m(t) \\forall t \\mbox{ vs } H_a:S_r(t)\\neq S_s(t) \\mbox{ p.} r\\neq s; r,s = 1,...,m\n\\]Para realizar la prueba, denotemos \\(d_{}\\) el vector de fallas al tiempo \\(t_i\\), \\(=1,...,k\\) con vector de medias \\(\\mathbb{E}(d_i)\\) y las entradas de la matriz de varianzas13 y covarianzas de la siguiente manera:\\[\nVar(d_{ji}) = \\frac{n_{1i}\\cdot n_{2i}\\cdot d_i(n_i-d_i)}{n_i^2(n_i-1)}\n\\]\\[\nCov(d_{ji},...,d_{hi}) = \\frac{-n_{ji}\\cdot n_{hi}\\cdot d_i(n_i-d_i)}{n_i^2(n_i-1)} \\mbox{ , } j \\neq h\n\\]Donde \\(j\\) y \\(h\\) denota el Grupo e \\(\\) es el tiempo. Ahora bien, sumando sobre los tiempos de falla \\(t_i\\):\\[\n\\underline{D} = \\sum_{= 1}^k\\{\\underline{d}_i - \\mathbb{E}(d_i)\\}\n\\]\\[\n\\underline{V} = \\sum_{=1}^kVar(\\underline{d}_i)\n\\]Mantel-Haenszel propone probar la hipótesis de \\(m\\) supervivencias iguales usando la forma cuadrática \\(O = D^{t}V^{-1}D\\), donde \\(V^{-1}\\) es la inversa generalizada de \\(V\\) que bajo \\(H_0\\) se distribuye \\(\\chi^2_{(m-1)}\\).","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"modelo-de-riesgos-proporcionales","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"Capítulo 10 Modelo de Riesgos Proporcionales","text":"Cuando se desea comparar 2 o más grupos de tiempos-evento, si los grupos son “similares” entonces se les pueden aplicar los métodos paramétricos vistos. Usualmente los individuos en los grupos tienen características adicionales que pueden afectar el resultado, por ejemplo, variables como: edad, género, nivel socioeconómico, consumo del alcohol, ritmo cardiaco, nivel de colesterol, etcétera.Dichas variables pueden usarse como covariables (variables explicativas, factores de riesgo, variables independientes) en un modelo que explique la variable respuesta. Así, después de ajustar las covariables, la comparación de tiempos de supervivencia entre grupos deberá tener menos sesgo y ser más precisa que la simple comparación de tiempos de supervivencia.Otro problema resolver será predecir la distribución del tiempo de ocurrencia de cierto evento partir de un conjunto de covariables.Los datos estarán dados de la siguiente forma: \\((t_i, \\delta_i,x_i)\\) con \\(= 1,...n\\), donde:\\(\\): individuos.\\(t_i\\): tiempo de falla o censura.\\(\\delta_i\\): indicador de falla o censura.\\(x_i\\): conjunto de covariables.Nota:\\(X_i =(X_{i1}, X_{i2}, ..., X_{ip})\\); donde \\(p\\)= número de covariables.\\(X_i\\) puede depender del tiempo, es decir, \\(X_{ik}\\) es una v.que cambia en el tiempo (peso, colesterol, etc.).Sea \\(h_i(t|X_i)\\) la función de riesgo al tiempo \\(t\\) del individuo \\(\\) dadas las covariables \\(X_i\\) (vector de riesgo). El modelo propuesto por Cox (1972) es:\\[\nh_i(t) = \\varphi(X_i ;\\theta)\\cdot h_0(t)\n\\]\nDonde:\\(\\theta=(\\theta_1,..., \\theta_p)\\) es el vector de \\(p\\) parámetros asociados las covariables (coeficientes de regresión).\\(\\varphi(\\cdot,\\cdot)\\) es la función liga de las covariables con el tiempo t.\\(h_{0}(t)\\) es la función de riesgo base.La función \\(\\varphi(\\cdot,\\cdot)\\) debe satisfacer que \\(\\varphi(0,\\theta) =1\\), esto para que, en ausencia de covariables, se tenga que \\(h_i(t) = h_0(t)\\).La forma más común de \\(\\varphi(X_i, \\theta)\\) es \\(\\varphi(X_i, \\theta) = e^{X_i^{'} \\theta}\\) (Supone que \\(X_i\\) tiene intercepto), entonces:\\[\nh_i(t) = e^{X_i^{'} \\theta}\\cdot h_0(t)\n\\]Si aplicamos logaritmo tenemos que:\\[\n\\ln(h_i(t)) = X_i^{'}\\theta + \\ln(h_0(t))\n\\]\\[\\begin{equation}\n\\Longrightarrow X_i^{'}\\cdot\\theta = ln \\left({\\frac{h_i(t)}{h_0(t)}}\\right)\n\\tag{10.1}\n\\end{equation}\\]Es decir, el cociente de la función de riesgo del individuo \\(\\) con respecto al riesgo base será igual una forma lineal de las covariables.El nombre de riesgos proporcionales se deriva del cociente de las funciones de riesgo de dos individuos:\\[\n\\frac{h_i(t)}{h_j(t)} = \\frac{e^{X_i^{'} \\theta}\\cdot h_0(t)}{e^{X_j^{'} \\theta} \\cdot h_0(t)} = e^{(X_i-X_j)' \\theta}\n\\]la expresión anterior se le conoce como riesgo relativo y es constante en el tiempo, cuyo valor depende simplemente de la diferencia entre valores de las covariables de los dos individuos14.Si \\(X_{1i} = 1\\) y \\(X_{1j} = 0\\), representan tratamiento y placebo respectivamente, y si todas las demás covariables se mantienen constantes, entonces \\(e^{\\theta_1}\\) es el riesgo de que se presente la falla con el tratamiento relativo que se presente la falla con el placebo.\\[\\frac{h_i(t)}{h_j(t)} = e^{\\theta_1}\\]\nBajo el modelo de riesgos proporcionales, las funciones de supervivencia y densidad del individuo \\(\\) son:\n\\[S_i(t)=\\{S_0(t)\\}^{exp(X_i'\\theta)}\\]\n\\[f_i(t)=e^{(X_i'\\theta)}h_0(t)\\{S_0(t)\\}^{exp(X_i'\\theta)}\\]donde \\(S_0(t)=exp\\{-H_0(t)\\}\\) es la función de supervivencia base y \\(H_0(t)\\) la función de riesgo acumulado base.\nUna consecuencia del supuesto de proporcionalidad entre los riesgos de dos individuos \\(,j\\) con covariables \\(X_i,X_j\\) es que las funciones de riesgo y supervivencia se intersectan.NOTA: Si \\(S_0(t)\\) es miembro de una familia paramétrica, por lo general, \\(S_i(t)\\) es miembro de la misma familia. Véase los siguientes ejemplosRiesgo base Weibull: \\(h_0(t) = \\lambda\\alpha t^{\\alpha-1}\\)\n\\[\n\\begin{array}{cc}\n\\implies h_i(t) = \\lambda \\alpha t^{\\alpha-1}e^{X_i^{'}\\theta} = \\lambda e^{X_i^{'}\\theta}\\alpha t^{\\alpha-1}&\\therefore h_i\\sim Weibull(\\alpha, \\lambda e^{X_i^{'}\\theta})\n\\end{array}\n\\]Riesgo base Weibull: \\(h_0(t) = \\lambda\\alpha t^{\\alpha-1}\\)\n\\[\n\\begin{array}{cc}\n\\implies h_i(t) = \\lambda \\alpha t^{\\alpha-1}e^{X_i^{'}\\theta} = \\lambda e^{X_i^{'}\\theta}\\alpha t^{\\alpha-1}&\\therefore h_i\\sim Weibull(\\alpha, \\lambda e^{X_i^{'}\\theta})\n\\end{array}\n\\]Riesgo base log-logistico: \\(h_0(t) = \\frac{\\alpha \\lambda t^{\\alpha-1}}{(1+\\lambda t^{\\alpha})}\\)\n\\[\n\\implies h_i(t) = \\frac{e^{Xi^{'}\\theta}\\alpha t^{\\alpha -1}}{(1+\\lambda t^{\\alpha})}\n\\]Riesgo base log-logistico: \\(h_0(t) = \\frac{\\alpha \\lambda t^{\\alpha-1}}{(1+\\lambda t^{\\alpha})}\\)\n\\[\n\\implies h_i(t) = \\frac{e^{Xi^{'}\\theta}\\alpha t^{\\alpha -1}}{(1+\\lambda t^{\\alpha})}\n\\]Riesgo base Gamma: \\(S_0(t) = 1-lg(\\lambda t, \\beta)\\)\n\\[\nS_i(t) = \\{S_0(t)\\}^{e^{X_i^{'}\\theta}} = \\left(1-lg(\\lambda t, \\beta)\\right)^{e^{X_i^{'}\\theta}}\n\\]Riesgo base Gamma: \\(S_0(t) = 1-lg(\\lambda t, \\beta)\\)\n\\[\nS_i(t) = \\{S_0(t)\\}^{e^{X_i^{'}\\theta}} = \\left(1-lg(\\lambda t, \\beta)\\right)^{e^{X_i^{'}\\theta}}\n\\]","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"inferencia-sobre-theta","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"10.1 Inferencia sobre \\(\\theta\\)","text":"La inferencia para los modelos de riesgos proporcionales paramétricos se hacen por máxima verosimiliutd.Sea \\((t_i, \\delta_i, X_i)\\): individuos.\\(t_i\\): tiempo de fallo o censura.\\(\\delta_i\\): Indicador de fallo o censura.\\(X_i\\): Covariables.Sean \\(h_0(t|\\alpha, \\lambda)\\) y \\(S_0(t|\\alpha, \\lambda)\\) funciones de riesgo y supervivencia base.Entonces la función de verosimilitud para \\((\\theta, \\alpha, \\lambda)\\) será:\\[\n\\begin{split}\n\\mathscr{L}(\\theta, \\alpha, \\lambda) & =\\prod_{= 1}^{n}\\{f_i(t)\\}^{\\delta_{}}\\{S_i(t)\\}^{1-\\delta_{}}\\\\\n & =\\prod_{= 1}^{n}\\left\\{e^{X_i^{'}\\theta}h_0(t)S_0(t)^{e^{X_i^{'}\\theta}}\\right\\}^{\\delta_{}}\\left\\{S_0(t)^{e^{X_i^{'}\\theta}}\\right\\}^{1-\\delta_i}\\\\\n & =\\prod_{= 1}^{n}\\left\\{e^{X_i^{'}\\theta}h_0(t)\\}^{\\delta_{}}\\{S_0(t)^{e^{X_i^{'}\\theta}}\\right\\}\n\\end{split}\n\\]Los estimadores máximo verosímil se obtienen numéricamente.La forma explicita de \\(\\mathscr{L}(\\theta, \\alpha, \\lambda)\\) dependerá de la elección de \\(h_0\\).Inferencia para los parámetros más allá de la estimación puntual se basa en los resultados asintóticos.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"estimación-semiparamétrica-verosimilitud-parcial.","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"10.2 Estimación Semiparamétrica (Verosimilitud parcial).","text":"El modelo de riesgos proporcionales semiparamétrico surge cuando la función de riesgo base \\(h_0(t)\\) se considera como una parámetro desconocido, y en este caso es necesario hacer inferencia para \\(\\theta\\) y \\(h_0(t)\\). El parámetro de interés más importante del modelo es \\(\\theta\\) y entonces \\(h_0(t)\\) es considerado un parámetro de ruido.Supongamos que los datos consisten en el vector de observaciones \\(T = (T_1, ..., T_n)\\) de la densidad \\(f(t|\\theta,\\eta)\\) donde \\(\\theta\\) es el vector de parámetros de interés y \\(\\eta\\) es parámetro de ruido.Sean \\(t_{(1)}<t_{(2)}<...<t_{(D)}\\) los tiempos de fallo observados de manera exacta.Sea \\(X_{(j)}\\) la variable asociada al individuo con tiempo de fallo \\(t_{(j)}\\).Definimos \\(R(t_{(j)})\\) como el conjunto de todos los individuos en riesgo justo antes de \\(t_{(j)}\\).Entonces la verosimilitud parcial para \\(\\theta\\) es\\[\n_p\\mathscr{L}(\\theta) = \\prod_{j = 1}^{D}\\frac{h_{j}(t_{(j)})}{\\sum\\limits_{\\R(t_{(j)})}h_{}(t_{(j)})} = \\prod_{j = 1}^{D}\\frac{\\exp\\left(X_{(j)}^{'}\\theta\\right)}{\\sum\\limits_{\\R(t_{(j)})}\\exp\\left(X_{}^{'}\\theta\\right)}\n\\]OBS :\\(_p\\mathscr{L}(\\theta)\\) depende de \\(h_0(t)\\)El numerador depende sólo de la información del individuo que falla.El denominador usa información de todos los individuos que aún han experimentado fallo incluyendo censurados.La verosimilitud parcial se trata como cualquier función de verosimilitud (aplica logaritmo, derivada igual cero,…)\\(\\theta\\) es un vector de dimensión \\(p\\implies\\) se obtendrán \\(p\\) derivadas parciales. La mayoría de los paquetes usan algoritmos de Newton-Raphson para resolver el sistema de ecuaciones simultaneas.Pruebas de hipótesis e intervalos de confianza para \\(\\theta\\) se pueden obtener con distribución asintótica normal con media \\(\\theta\\) y matriz de varianzas y covarianzas.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"estimador-de-breslow-h_0t-y-s_0t","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"10.3 Estimador de Breslow (\\(H_{0}(t)\\) y \\(S_{0}(t)\\))","text":"Si la funciones base son también de interés, se puede utilizar el estimador propuesto por Berslow (1974) que es una generalización del estimador de Nelson-Aalen.\\[\\hat{H_{0}}(t) = \\sum_{:t_i\\leq t}\\left \\{\\frac{\\delta_i}{\\sum_{j = 1}^nY_j(t_i)e^{X_j^{'}\\hat{\\theta}}} \\right \\} = \\frac{\\mbox{Fallecidos}}{\\mbox{Individuos en riesgo}}\\]\ndonde \\(Y_i(t) = \\mathbb{1}_{\\{t_i\\geq t\\}}\\) indicadora si \\(\\hat{\\theta} = 0\\) y \\(\\hat{H_0}(t)\\) es el estimador de Nelson-Aalen visto previamente.\\[\\therefore \\hat{S_0(t)}  = exp\\{-\\hat{H_0}(t)\\} = e^{\\sum_{:t_i\\leq t}\\left \\{\\frac{\\delta_i}{\\sum_{j = 1}^nY_j(t_i)e^{X_j^{'}\\hat{\\theta}}} \\right \\}}\\]NotasEn el caso de que se presenten empates (múltiples individuos con el mismo tiempo de fallo) la \\(_p\\mathscr{L}(\\theta)\\) debe ajustarse para que se considere la naturaleza discreta de las observaciones.El modelo de riesgos proporcionales permite la incorporación de covariables dependientes en el tiempo.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"ejemplo-1-2","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"Ejemplo 1","text":"Un estudio sobre la supervivencia clasifica según la raza en: blanco, negro e hispano. Entonces las variable \\(X_1\\) toma los siguientes valores:\\[\n\\begin{array}{ll}\nX_1 = \\mbox{1 si es blanco } \\\\\nX_1 = \\mbox{2 si es negro } \\\\\nX_1 = \\mbox{3 si es hispano} \\\\\n\\end{array}\n\\]Sin embrago, también podría plantearse como dos variables \\(X_1\\) y \\(X_2\\)\n\\[\n\\begin{array}{ll}\nX_1 = 1 \\mbox{ si es blanco, 0 en otro caso.}\\\\\nX_2 = 1 \\mbox{ si es negro, 0 en otro caso}\\\\\n\\end{array}\n\\]Entonces, el modelo de riesgos proporcionales será: \\(h(t|X) = h_0e^{\\beta_1X_1+\\beta_2X_2}\\)Si \\(h(t|X_1=1, X_2 = 0) = h_0(t)e^{\\beta_1}\\longrightarrow\\) Riesgo de blancoSi \\(h(t|X_1=0, X_2 = 1) = h_0(t)e^{\\beta_2}\\longrightarrow\\) Riesgo de negroSi \\(h(t|X_1=0, X_2 = 0) = h_0(t)\\longrightarrow\\) Riesgo de hispano (riesgo base)Riesgos relativos:Entre negro e hispano: \\(\\frac{h(t|X_1 = 0, X_2 = 1)}{h(t|X_1 = 0, X_2 = 0)} = \\frac{h_0(t)e^{\\beta_2}}{h_{0}(t)}=e^{\\beta_2}\\)Es decir, \\(e^{\\beta_2}\\) son las veces que el riesgo que tienen los negros en comparación con los hispanos.Se busca que el riesgo relativo sea \\(\\neq1\\) para poder decir que la categoría segmenta datos.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"ejemplo-2-2","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"Ejemplo 2","text":"Un estudio con 863 pacientes con trasplante de hígado. Dos de las variable que se recabaron de los pacientes fueron, género y raza. Entonces los pacientes en el estudio se dividieron en las siguientes categorías\\[\n\\begin{array}{ll}\n432 \\mbox{ hombres blancos}\\\\\n92 \\mbox{ hombres negros}\\\\\n286 \\mbox{ mujeres blancas}\\\\\n59 \\mbox{ mujeres negras}\\\\\n\\end{array}\n\\]Para ajustar un modelo de riesgos proporcionales estos datos, una opción es definir 3 covariables:\\[\n\\begin{array}{ll}\nZ_1 = 1 \\mbox{ hombre negro, 0.e.o.c}\\\\\nZ_2 = 1 \\mbox{ hombre blanco, 0.e.o.c}\\\\\nZ_3 = 1 \\mbox{ mujer negra, 0.e.o.c}\\\\\n\\end{array}\n\\]\nY el modelo para la función de riesgo será:\n\\[h(t|Z) = h_0(t)exp \\{ \\theta_1Z_1 + \\theta_2Z_2 + \\theta_3Z_3\\}\\]Los estimadores máximo verosímil son \\(\\hat{\\theta_1} = 0.160\\), \\(\\hat{\\theta_2} = 0.298\\), \\(\\hat{\\theta_3} = 0.657\\).Riesgo relativo de hombre negro con mujer blanca :\\[h(t|Z) = \\frac{h_0(t)exp\\{0.160\\}}{h_0(t)exp\\{0\\}} = e^{0.160} = 1.17\\]\n\\(\\therefore\\) Los hombres negros son más propensos morir por trasplante de hígado que las mujeres blancas; es decir, por cada mujer blanca, un hombre negro (1.17) muere en el trasplante.En el caso de un hombre negro y un hombre blanco\\[h(t|Z) = \\frac{h_0(t)exp\\{0.160\\}}{h_0(t)exp\\{0.298\\}} = e^{-0.088} = 0.9157609\\]Otra opción de plantear el modelo es con 2 covariables y una interacción, y quedaría de la siguiente forma:\\[\n\\begin{array}{ll}\nZ_1 = 1 \\mbox{ Si es mujer, 0  e.o.c}\\\\\nZ_2 = 1 \\mbox{ Si es negro(), 0  e.o.c}\\\\\nZ_3 = Z_1\\cdot Z_2 \\mbox{ Esta variable tomará el valor 1 si es mujer negra, y 0  e.o.c}\n\\end{array}\n\\]Y el modelo para la función de riesgo será: \\(h(t|Z) = h_0exp\\{\\theta_1Z_1+\\theta_2Z_2+\\theta_3Z_1Z_2\\}\\).Los estimadores máximo verosímil son\n\\(\\hat{\\theta_1} = -.2484, \\hat{\\theta_2} =-.0888, \\hat{\\theta_3} = .7435\\).\nHay que notar que la interpretación de las \\(\\theta's\\) será diferente y en este caso el parámetro de interés será el de la interacción (\\(\\theta_3\\))Riesgos relativos :\\[\\frac{\\mbox{Hombre negro}}{\\mbox{Mujer blanca}} = \\frac{h_0(t)exp\\{-0.0888\\}}{h_0exp\\{-0.2484\\}} = e^{-(0.0888+0.2484)} = e^{-.1596} = 1.17\\]Véase que es el mismo resultado que se obtuvo en el modelo anterior, por lo que se sigue conservando el mismo riesgo independiente del modelo.EjerciciosCalcular el riesgo mujer negra relativo mujer blanca.Calcular el riesgo mujer negra relativo mujer blanca.Calcular el riesgo mujer negra relativo hombre negroCalcular el riesgo mujer negra relativo hombre negroCalcular el riesgo hombre blanco relativo mujer blanca.Calcular el riesgo hombre blanco relativo mujer blanca.RECORDATORIO: Codificación de variables categóricas.Una variable categórica con k clases se transforma en \\(k-1\\) variables binarias.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"ejemplo-1-3","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"Ejemplo 1","text":"X: Color de cabello {negro, cafe, rojo, blanco}. Tenemos una variable con 4 categorías. Por lo que la transformaremos en 3 variables binarias\\[\n\\begin{array}{l}\nX_1 = \\mbox{1 si es negro, 0 e.o.c } \\\\\nX_2 = \\mbox{1 si es café. 0 e.o.c } \\\\\nX_3 = \\mbox{1 si es rojo, 0.e.o.c} \\\\\n\\end{array}\n\\]Con estas tres variables se cubren todas las opciones de color de cabello.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"significancia-de-los-parámetros-prueba-de-wald","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"10.4 Significancia de los parámetros (Prueba de Wald)","text":"¿Son significativos \\(\\hat{\\theta_1}, \\hat{\\theta_2}, \\hat{\\theta_3}\\) en ejemplo numero 2?Similar al caso de regresión lineal, la significancia de los parámetros radica en la importancia del riesgo proporcionado por las covariables asociadas parámetros. Y en caso de ser significativos los parámetros, las covariables se podrían eliminar del modelo.Prueba de hipótesis: Nos interesa hacer pruebas sobre \\(\\theta\\), de manera general:\\[H_0:\\theta_1 = \\theta_{H_0}\\mbox{ vs }H_1:\\theta_1\\neq \\theta_{H_0}\\]\ndonde \\(\\theta = (\\theta_1^t, \\theta_2^t) = (\\theta_1, \\theta_2, ..., \\theta_p)\\)\\(\\theta_1:\\) Es el vector de \\(q*1\\) (\\(q\\) parámetros de interés)\\(\\theta_2:\\) Los parámetros restantes (\\(p-q\\))Partimos la matriz de información : \\(= \\begin{pmatrix}I_{11} & I_{12} \\\\ I_{21} & I_{22}\\end{pmatrix}\\)Donde \\(I_{11}\\), \\(I_{22}\\) segundas derivadas de la función de verosimilitud.La Prueba de Wald se define como:\\[\nX_w^2 =(\\hat{\\theta_1}-\\hat{\\theta_{H_0}})^{'}[^{*}(\\theta)]^{-1}(\\hat{\\theta_1}-\\hat{\\theta_{H_0}})\n\\]Donde \\(^{*}(\\theta)\\) es la matriz \\(q*q\\) superior de \\(\\).Para muestras grandes, la estadística de prueba: \\(X_w^2\\sim\\chi_{(q)}^2\\)Para muestras grandes, la estadística de prueba: \\(X_w^2\\sim\\chi_{(q)}^2\\)Un criterio de información es el proporcionado por el criterio de Aikaike (\\(ACI\\)):Un criterio de información es el proporcionado por el criterio de Aikaike (\\(ACI\\)):\\[AIC  = -2log{\\mathscr{L}}+kp\\]\\(\\mathscr{L}\\): Función de verosimilitud.\\(k\\): Cte.(usualmente igual 2).\\(p\\): # de parámetros en el modelo.Para la construcción del modelo usando el modelo de riesgos proporcionales de Cox, se puede usar el estadístico de Wald para seleccionar covariables significativas15 y considerando el valor del AIC para evaluar la mejora en el modelo16.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"estimación-de-st-después-de-obtener-las-estimaciones-de-los-parámetros-del-modelo-de-cox","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"10.5 Estimación de \\(S(t)\\) después de obtener las estimaciones de los parámetros del modelo de Cox","text":"Hasta el momento se han dado estimadores para \\(\\theta\\) y pruebas sobre dicho parámetro; es decir, teniendo el modelo de riesgos proporcionales \\(h(t|X) = h_0(t)e^{X^{'}\\theta}\\) y ajustando dicho modelo nuestros datos obtenemos \\(\\hat{\\theta}\\). Ahora lo que se desea es la función de supervivencia con el conjunto de covariables \\(X_i\\).Para ello sea \\(t_1<t_2, \\dots<t_D\\) todos los tiempos de falla y \\(d_i\\) el número de fallas del tiempo \\(t_i\\). Entonces\\[\n\\omega(t_i, \\hat{\\theta}) = \\sum_{j\\R(t_i)}\\exp\\left\\{\\sum_{h=1}^D\\hat{\\theta}_hX_{jh}\\right\\}\n\\]Y el estimador de la función de riesgo acumulado base será la siguiente, la cual es una función escalonada cada tiempo de falla.\\[\n\\hat{H_0}(t) = \\sum_{t_i\\leq t}\\frac{d_i}{w(t_i, \\hat{\\theta})}\n\\]Por lo que un estimador de la función de supervivencia base será el siguiente, el cual corresponde los individuos cuyas covariables \\(X\\) son ceros.\\[\n\\hat{S}_0(t) = \\exp\\{-\\hat{H}_0(t)\\}\n\\]Para estimar la función de supervivencia para un individuo con covariables \\(X^{*}\\) se utilizará el siguiente estimador\\[\n\\hat{S}(t|X^{*})=\\hat{S}_0(t)\\exp\\left\\{\\hat{\\theta^{'}}X^{*}\\right\\}\n\\]\nLa siguiente gráfica es un ejemplo comparativo de dos estimaciones de funciones de supervivencia, una con el método de Kaplan-Meier y Cox.","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"verificación-de-ajuste-de-modelo","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"10.6 Verificación de ajuste de Modelo","text":"Mediante gráficos de las funciones de supervivencia buscamos las funciones de supervivencia para los distintos valores de \\(X\\)’s donde se crucen17.En caso de que el modelo de Cox cumpla con el supuesto de proporcionalidad se puede corregir el modelo mediante:Agregar más covariablesAgregar más covariablesConsiderar interacciones entre las covariablesConsiderar interacciones entre las covariablesIntroducir términos linealesIntroducir términos linealesPermitir que las covariables dependan del tiempoPermitir que las covariables dependan del tiempo","code":""},{"path":"modelo-de-riesgos-proporcionales.html","id":"extensión-del-modelo-de-cox-a-covariables-dependientes-del-tiempo","chapter":"Capítulo 10 Modelo de Riesgos Proporcionales","heading":"10.7 Extensión del modelo de Cox a covariables dependientes del tiempo","text":"Sea \\(X(t)=[X_1(t),...,X_p(t)]\\) es el conjunto de covariables o factores de riesgo al tiempo \\(t\\) que podrían afectar la distribución de la variable de supervivencia.Entonces \\(X_k(t)\\)´s son covariables dependientes del tiempo cuyos valores cambian o permanecen constantes (como el caso anterior). Supondremos que los valores de estas covariables son predecibles (el valor es conocido).Ejemplos de este tipo de variables son presión arterial, colesterol, tamaño del tumor, etc.Sustituyendo en el modelo de Cox tenemos:\\[\n\\begin{split}\nh(t|X(t))=&h_0 (t)\\cdot exp\\{\\beta^`\\cdot Z(t )\\}\\\\\n=&h_0(t) \\cdot exp \\left\\{ \\sum_{k=1}^{p} \\beta_k \\cdot Z(t)  \\right\\}\n\\end{split}\n\\]Entonces para probar el supuesto de riesgos proporcionales se crea una variable artificial:\\[\nX_2(t)= X_1 \\cdot g(t) \n\\]donde \\(X_1\\) es una variable fija en el tiempo \\(g(t)\\) es una función que depende del tiempo usualmente\\[\ng(t)= ln (t ) \n\\]\ny se ajusta un modelo de Cox para las covariables \\(X_1\\) y \\(X_2(t)\\), tenemos\\[  \n\\begin{split}\nh(t|X(t)) &= h_0 \\cdot exp \\{ \\beta_1 X_1 +\\beta_2X_2(t) \\}\\\\\n&=h_0(t) \\cdot exp \\{ \\beta_1 X_1+\\beta_2 X_1\\cdot g(t) \\}\n\\end{split}\n\\]\ny se realiza la prueba de hipótesis para \\(\\beta_2=0\\). Si se desea evaluar riesgos proporcionales para 2 individuos con diferentes valores de \\(X_1\\)\\[\n\\frac{h(t|X_1)}{h(t|X_1^*)}= exp \\{ \\beta_1 (X_1-X_1^*)+\\beta_2\\cdot g(t)(X_1-X_1^*) \\}\n\\]la cuál dependerá del tiempo si \\(\\beta_2 \\ne 0\\).Collett, David. 2015. Modelling Survival Data Medical Research. CRC press.Hall, Wendy J, Jon Wellner. 1980. “Confidence Bands Survival Curve Censored Data.” Biometrika 67 (1): 133–43.Klein, John P, Melvin L Moeschberger. 2006. Survival Analysis: Techniques Censored Truncated Data. Second. Springer Science & Business Media.Nair, Vijayan N. 1984. “Confidence Bands Survival Functions Censored Data: Comparative Study.” Technometrics 26 (3): 265–75.","code":""}]
